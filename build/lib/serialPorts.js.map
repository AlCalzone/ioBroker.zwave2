{
  "version": 3,
  "sources": ["../../src/lib/serialPorts.ts"],
  "sourcesContent": ["import type { AdapterInstance } from \"@iobroker/adapter-core\";\nimport { distinct } from \"alcalzone-shared/arrays\";\nimport fs from \"fs-extra\";\nimport path from \"path\";\nimport { Driver } from \"zwave-js\";\n\nfunction isSerialPort(path: string): boolean {\n\t// get only serial port names\n\tif (!/(tty(S|ACM|USB|AMA|MFD)|rfcomm)/.test(path)) return false;\n\n\treturn fs.statSync(path).isCharacterDevice();\n}\n\nexport async function enumerateSerialPorts(\n\tadapter: AdapterInstance<any, any>,\n): Promise<string[]> {\n\tconst result: string[] = [];\n\n\t// On Linux, search the /dev dir for serial ports\n\tconst devDirName = \"/dev\";\n\ttry {\n\t\tresult.push(\n\t\t\t...(await fs.readdir(devDirName))\n\t\t\t\t.map((file) => path.join(devDirName, file))\n\t\t\t\t.filter(isSerialPort),\n\t\t);\n\t} catch {}\n\n\t// Also try to use the serial port library to find serial ports\n\ttry {\n\t\tresult.push(...(await Driver.enumerateSerialPorts()));\n\t} catch (e: any) {\n\t\tif (e.code === \"ENOENT\" && /udevadm/.test(e.message)) {\n\t\t\tadapter.log.warn(\n\t\t\t\t`Cannot list serial ports because \"udevadm\" was not found on PATH!`,\n\t\t\t);\n\t\t\tadapter.log.warn(\n\t\t\t\t`If it is installed, add it to the PATH env variable.`,\n\t\t\t);\n\t\t\tadapter.log.warn(`Otherwise, install it using \"apt install udev\"`);\n\t\t}\n\t}\n\treturn distinct(result).sort();\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AACA,oBAAyB;AACzB,sBAAe;AACf,kBAAiB;AACjB,sBAAuB;AAEvB,sBAAsB,OAAuB;AAE5C,MAAI,CAAC,kCAAkC,KAAK;AAAO,WAAO;AAE1D,SAAO,wBAAG,SAAS,OAAM;AAAA;AAG1B,oCACC,SACoB;AACpB,QAAM,SAAmB;AAGzB,QAAM,aAAa;AACnB,MAAI;AACH,WAAO,KACN,GAAI,OAAM,wBAAG,QAAQ,aACnB,IAAI,CAAC,SAAS,oBAAK,KAAK,YAAY,OACpC,OAAO;AAAA,UAET;AAAA;AAGF,MAAI;AACH,WAAO,KAAK,GAAI,MAAM,uBAAO;AAAA,WACrB,GAAP;AACD,QAAI,EAAE,SAAS,YAAY,UAAU,KAAK,EAAE,UAAU;AACrD,cAAQ,IAAI,KACX;AAED,cAAQ,IAAI,KACX;AAED,cAAQ,IAAI,KAAK;AAAA;AAAA;AAGnB,SAAO,4BAAS,QAAQ;AAAA;",
  "names": []
}
