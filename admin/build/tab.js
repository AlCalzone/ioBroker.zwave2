import{a as sn,b as ln,c as un}from"./chunk-VWZXTXZL.js";import{a as du,b as Pt,c as fu,d as cn}from"./chunk-QJXHC4ID.js";import{B as Wl,D as $l,E as Vl,G as Ul,H as Ur,I as Kr,J as Ke,K as rn,L as Yr,M as Ye,N as on,O as Pe,P as nn,Q as Kl,R as Yl,S as z,T as Zl,U as Ql,V as Xl,W as Zr,X as an,Y as Jl,Z as eu,_ as K,a as O,aa as Qr,b as u,c as T,ca as de,d as Gl,da as oe,e as F,ea as tu,f as G,fa as ru,g as At,ga as ou,h as zl,ha as nu,i as Ve,ia as au,j as Z,ja as iu,k as at,ka as su,l as Ll,la as lu,m as Dt,ma as uu,n as Zo,na as cu,o as Rl,p as Ue,q as qe,r as Vr,s as Qo,u as qt,v as Xo,w as Jo,x as en,y as tn,z as Hl}from"./chunk-OKLXY5TL.js";var pn=O(ne=>{"use strict";var mu=ne&&ne.__createBinding||(Object.create?function(e,t,r,o){o===void 0&&(o=r),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,o){o===void 0&&(o=r),e[o]=t[r]}),gu=ne&&ne.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),hu=ne&&ne.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&mu(t,e,r);return gu(t,e),t},vu=ne&&ne.__rest||function(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(r[o[n]]=e[o[n]]);return r},Jr=ne&&ne.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ne,"__esModule",{value:!0});ne.Dropdown=void 0;var eo=Jr($l()),yu=Jr(Vl()),bu=Jr(Ul()),it=hu(T()),xu=e=>{let{options:t,selectedOption:r,noOptionsMessage:o,placeholder:n}=e,a=vu(e,["options","selectedOption","noOptionsMessage","placeholder"]),i=!(!!t&&t.length)&&!!o,s;return(t==null?void 0:t.length)&&(s=r),it.createElement(bu.default,Object.assign({value:s??"",displayEmpty:!0,input:it.createElement(yu.default,{labelWidth:0}),margin:"dense"},a),it.createElement(eo.default,{value:"",disabled:!0},n??""),t&&t.length&&t.map(({value:l,label:d})=>it.createElement(eo.default,{key:l,value:l},d)),i&&it.createElement(eo.default,{key:"__empty",value:"__empty",disabled:!0},o))};ne.Dropdown=xu});var to=O(pe=>{"use strict";var wu=pe&&pe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(pe,"__esModule",{value:!0});pe.ModalDialog=pe.Loader=pe.Dropdown=void 0;var Su=pn();Object.defineProperty(pe,"Dropdown",{enumerable:!0,get:function(){return Su.Dropdown}});var Cu=Kl();Object.defineProperty(pe,"Loader",{enumerable:!0,get:function(){return wu(Cu).default}});var _u=Yl();Object.defineProperty(pe,"ModalDialog",{enumerable:!0,get:function(){return _u.ModalDialog}})});var Mt=O(Nt=>{"use strict";var Iu=G(),ju=F();Object.defineProperty(Nt,"__esModule",{value:!0});Nt.default=void 0;var Tu=ju(T()),ku=Iu(z()),Au=(0,ku.default)(Tu.createElement("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add");Nt.default=Au});var ro=O(Bt=>{"use strict";var Du=G(),qu=F();Object.defineProperty(Bt,"__esModule",{value:!0});Bt.default=void 0;var Pu=qu(T()),Nu=Du(z()),Mu=(0,Nu.default)(Pu.createElement("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"}),"Restore");Bt.default=Mu});var Et=O(Ot=>{"use strict";var Bu=G(),Ou=F();Object.defineProperty(Ot,"__esModule",{value:!0});Ot.default=void 0;var Eu=Ou(T()),Fu=Bu(z()),Gu=(0,Fu.default)(Eu.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}),"DeleteForever");Ot.default=Gu});var Cn=O(Lt=>{"use strict";var Lu=G(),Ru=F();Object.defineProperty(Lt,"__esModule",{value:!0});Lt.default=void 0;var Hu=Ru(T()),Wu=Lu(z()),$u=(0,Wu.default)(Hu.createElement("path",{d:"M1 9l2 2c4.97-4.97 13.03-4.97 18 0l2-2C16.93 2.93 7.08 2.93 1 9zm8 8l3 3 3-3c-1.65-1.66-4.34-1.66-6 0zm-4-4l2 2c2.76-2.76 7.24-2.76 10 0l2-2C15.14 9.14 8.87 9.14 5 13z"}),"Wifi");Lt.default=$u});var _n=O(Rt=>{"use strict";var Vu=G(),Uu=F();Object.defineProperty(Rt,"__esModule",{value:!0});Rt.default=void 0;var Ku=Uu(T()),Yu=Vu(z()),Zu=(0,Yu.default)(Ku.createElement("path",{d:"M22.99 9C19.15 5.16 13.8 3.76 8.84 4.78l2.52 2.52c3.47-.17 6.99 1.05 9.63 3.7l2-2zm-4 4c-1.29-1.29-2.84-2.13-4.49-2.56l3.53 3.53.96-.97zM2 3.05L5.07 6.1C3.6 6.82 2.22 7.78 1 9l1.99 2c1.24-1.24 2.67-2.16 4.2-2.77l2.24 2.24C7.81 10.89 6.27 11.73 5 13v.01L6.99 15c1.36-1.36 3.14-2.04 4.92-2.06L18.98 20l1.27-1.26L3.29 1.79 2 3.05zM9 17l3 3 3-3c-1.65-1.66-4.34-1.66-6 0z"}),"WifiOff");Rt.default=Zu});var In=O(Ht=>{"use strict";var Qu=G(),Xu=F();Object.defineProperty(Ht,"__esModule",{value:!0});Ht.default=void 0;var Ju=Xu(T()),ec=Qu(z()),tc=(0,ec.default)(Ju.createElement("path",{d:"M17 1H7c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-2-2-2zm0 18H7V5h10v14zM12 6.72c-1.96 0-3.5 1.52-3.5 3.47h1.75c0-.93.82-1.75 1.75-1.75s1.75.82 1.75 1.75c0 1.75-2.63 1.57-2.63 4.45h1.76c0-1.96 2.62-2.19 2.62-4.45 0-1.96-1.54-3.47-3.5-3.47zm-.88 8.8h1.76v1.76h-1.76z"}),"DeviceUnknown");Ht.default=tc});var jn=O(Wt=>{"use strict";var rc=G(),oc=F();Object.defineProperty(Wt,"__esModule",{value:!0});Wt.default=void 0;var nc=oc(T()),ac=rc(z()),ic=(0,ac.default)(nc.createElement("path",{d:"M13 3h-2v10h2V3zm4.83 2.17l-1.42 1.42C17.99 7.86 19 9.81 19 12c0 3.87-3.13 7-7 7s-7-3.13-7-7c0-2.19 1.01-4.14 2.58-5.42L6.17 5.17C4.23 6.82 3 9.26 3 12c0 4.97 4.03 9 9 9s9-4.03 9-9c0-2.74-1.23-5.18-3.17-6.83z"}),"PowerSettingsNew");Wt.default=ic});var Un=O(Ut=>{"use strict";var cc=G(),dc=F();Object.defineProperty(Ut,"__esModule",{value:!0});Ut.default=void 0;var fc=dc(T()),pc=cc(z()),mc=(0,pc.default)(fc.createElement("path",{d:"M19 13H5v-2h14v2z"}),"Remove");Ut.default=mc});var Kn=O(Kt=>{"use strict";var gc=G(),hc=F();Object.defineProperty(Kt,"__esModule",{value:!0});Kt.default=void 0;var vc=hc(T()),yc=gc(z()),bc=(0,yc.default)(vc.createElement("path",{d:"M15.9 5c-.17 0-.32.09-.41.23l-.07.15-5.18 11.65c-.16.29-.26.61-.26.96 0 1.11.9 2.01 2.01 2.01.96 0 1.77-.68 1.96-1.59l.01-.03L16.4 5.5c0-.28-.22-.5-.5-.5zM1 9l2 2c2.88-2.88 6.79-4.08 10.53-3.62l1.19-2.68C9.89 3.84 4.74 5.27 1 9zm20 2l2-2c-1.64-1.64-3.55-2.82-5.59-3.57l-.53 2.82c1.5.62 2.9 1.53 4.12 2.75zm-4 4l2-2c-.8-.8-1.7-1.42-2.66-1.89l-.55 2.92c.42.27.83.59 1.21.97zM5 13l2 2c1.13-1.13 2.56-1.79 4.03-2l1.28-2.88c-2.63-.08-5.3.87-7.31 2.88z"}),"NetworkCheck");Kt.default=bc});var ra=O(Zt=>{"use strict";var wc=G(),Sc=F();Object.defineProperty(Zt,"__esModule",{value:!0});Zt.default=void 0;var Cc=Sc(T()),_c=wc(z()),Ic=(0,_c.default)(Cc.createElement("path",{d:"M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"}),"Done");Zt.default=Ic});var oa=O(Qt=>{"use strict";var jc=G(),Tc=F();Object.defineProperty(Qt,"__esModule",{value:!0});Qt.default=void 0;var kc=Tc(T()),Ac=jc(z()),Dc=(0,Ac.default)(kc.createElement("path",{d:"M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z"}),"Redo");Qt.default=Dc});var na=O(Xt=>{"use strict";var qc=G(),Pc=F();Object.defineProperty(Xt,"__esModule",{value:!0});Xt.default=void 0;var Nc=Pc(T()),Mc=qc(z()),Bc=(0,Mc.default)(Nc.createElement("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline");Xt.default=Bc});var aa=O(Jt=>{"use strict";var Oc=G(),Ec=F();Object.defineProperty(Jt,"__esModule",{value:!0});Jt.default=void 0;var Fc=Ec(T()),Gc=Oc(z()),zc=(0,Gc.default)(Fc.createElement("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"}),"Autorenew");Jt.default=zc});var pa=O(er=>{"use strict";var Rc=G(),Hc=F();Object.defineProperty(er,"__esModule",{value:!0});er.default=void 0;var Wc=Hc(T()),$c=Rc(z()),Vc=(0,$c.default)(Wc.createElement("path",{d:"M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"}),"KeyboardArrowDown");er.default=Vc});var ma=O(tr=>{"use strict";var Uc=G(),Kc=F();Object.defineProperty(tr,"__esModule",{value:!0});tr.default=void 0;var Yc=Kc(T()),Zc=Uc(z()),Qc=(0,Zc.default)(Yc.createElement("path",{d:"M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"}),"KeyboardArrowUp");tr.default=Qc});var ga=O(rr=>{"use strict";var Xc=G(),Jc=F();Object.defineProperty(rr,"__esModule",{value:!0});rr.default=void 0;var ed=Jc(T()),td=Xc(z()),rd=(0,td.default)(ed.createElement("path",{d:"M5 4v2h14V4H5zm0 10h4v6h6v-6h4l-7-7-7 7z"}),"Publish");rr.default=rd});var lo=O(or=>{"use strict";var od=G(),nd=F();Object.defineProperty(or,"__esModule",{value:!0});or.default=void 0;var ad=nd(T()),id=od(z()),sd=(0,id.default)(ad.createElement("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm-2 16c-2.05 0-3.81-1.24-4.58-3h1.71c.63.9 1.68 1.5 2.87 1.5 1.93 0 3.5-1.57 3.5-3.5S13.93 9.5 12 9.5c-1.35 0-2.52.78-3.1 1.9l1.6 1.6h-4V9l1.3 1.3C8.69 8.92 10.23 8 12 8c2.76 0 5 2.24 5 5s-2.24 5-5 5z"}),"RestorePage");or.default=sd});var ha=O(nr=>{"use strict";var ld=G(),ud=F();Object.defineProperty(nr,"__esModule",{value:!0});nr.default=void 0;var cd=ud(T()),dd=ld(z()),fd=(0,dd.default)(cd.createElement("path",{d:"M15 9H9v6h6V9zm-2 4h-2v-2h2v2zm8-2V9h-2V7c0-1.1-.9-2-2-2h-2V3h-2v2h-2V3H9v2H7c-1.1 0-2 .9-2 2v2H3v2h2v2H3v2h2v2c0 1.1.9 2 2 2h2v2h2v-2h2v2h2v-2h2c1.1 0 2-.9 2-2v-2h2v-2h-2v-2h2zm-4 6H7V7h10v10z"}),"Memory");nr.default=fd});var va=O(ar=>{"use strict";var pd=G(),md=F();Object.defineProperty(ar,"__esModule",{value:!0});ar.default=void 0;var gd=md(T()),hd=pd(z()),vd=(0,hd.default)(gd.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9zm7.5-5l-1-1h-5l-1 1H5v2h14V4z"}),"DeleteOutline");ar.default=vd});var ya=O(ir=>{"use strict";var yd=G(),bd=F();Object.defineProperty(ir,"__esModule",{value:!0});ir.default=void 0;var xd=bd(T()),wd=yd(z()),Sd=(0,wd.default)(xd.createElement("path",{d:"M6.99 11L3 15l3.99 4v-3H14v-2H6.99v-3zM21 9l-3.99-4v3H10v2h7.01v3L21 9z"}),"SwapHoriz");ir.default=Sd});var Aa=O(ur=>{"use strict";var _d=G(),Id=F();Object.defineProperty(ur,"__esModule",{value:!0});ur.default=void 0;var jd=Id(T()),Td=_d(z()),kd=(0,Td.default)(jd.createElement("path",{d:"M21 21.78L4.22 5 3 6.22l2.04 2.04C4.42 8.6 4 9.25 4 10v10c0 1.1.9 2 2 2h12c.23 0 .45-.05.66-.12L19.78 23 21 21.78zM8.9 6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1v2H9.66L20 18.34V10c0-1.1-.9-2-2-2h-1V6c0-2.76-2.24-5-5-5-2.56 0-4.64 1.93-4.94 4.4L8.9 7.24V6z"}),"NoEncryption");ur.default=kd});var Ea=O(cr=>{"use strict";var qd=G(),Pd=F();Object.defineProperty(cr,"__esModule",{value:!0});cr.default=void 0;var Nd=Pd(T()),Md=qd(z()),Bd=(0,Md.default)(Nd.createElement("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"}),"Home");cr.default=Bd});var Fa=O(dr=>{"use strict";var Od=G(),Ed=F();Object.defineProperty(dr,"__esModule",{value:!0});dr.default=void 0;var Fd=Ed(T()),Gd=Od(z()),zd=(0,Gd.default)(Fd.createElement("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2H4.26zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56zm2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8zM12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96zM14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2zm.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56zM16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2h-3.38z"}),"Language");dr.default=zd});var sl=O(Mr=>{"use strict";var kp=G(),Ap=F();Object.defineProperty(Mr,"__esModule",{value:!0});Mr.default=void 0;var Dp=Ap(T()),qp=kp(z()),Pp=(0,qp.default)(Dp.createElement("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank");Mr.default=Pp});var ll=O(Br=>{"use strict";var Np=G(),Mp=F();Object.defineProperty(Br,"__esModule",{value:!0});Br.default=void 0;var Bp=Mp(T()),Op=Np(z()),Ep=(0,Op.default)(Bp.createElement("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox");Br.default=Ep});var ye=u(nn()),q=u(T()),Ol=u(Gl()),El=u(Jl());var dn=u(Rl()),fn=u(Z()),Xr=u(T()),pu=(0,fn.makeStyles)(e=>({tabpanel:{flex:1,position:"relative","& > *":{width:"100%",height:"100%"}}})),Ze=e=>{let{children:t,value:r,index:o,...n}=e,a=pu();return Xr.default.createElement("div",{className:a.tabpanel,role:"tabpanel",hidden:r!==o,...n},r===o&&Xr.default.createElement(dn.default,{p:3},t))};var Ne=u(T());var On=u(Zr()),E=u(T());var P=u(T()),mn=u(Zr()),gn=u(K()),st=u(to()),hn=u(Vr()),Ft=u(Pe()),Gt=u(qe()),vn=u(Mt()),yn=u(an()),bn=u(ro()),xn=u(Et()),wn=u(Ke()),Sn=u(Ye()),zt=u(Z());var zu=(0,zt.makeStyles)(e=>({dropdown:{width:"100%"}})),lt=(0,zt.styled)(wn.default)(({theme:e})=>({padding:e.spacing(1)})),oo=e=>{let{translate:t}=(0,gn.useI18n)(),[r,o]=P.default.useState(e.sourceEndpoint),[n,a]=P.default.useState(e.group),[c,i]=P.default.useState(e.nodeId),[s,l]=P.default.useState(e.endpoint),[d,f]=P.default.useState(!1),[g,h]=P.default.useState(!1),[C,x]=P.default.useState(!1),m=r!=null&&e.groups.get(r)||[];P.default.useEffect(()=>{h(r!==e.sourceEndpoint||n!==e.group||c!==e.nodeId||s!==e.endpoint);let w=!!m.find(U=>U.group===n),j=e.nodes.find(U=>U.nodeId===c),$=j?.endpointIndizes??[];f(w&&!!j&&(s==null||s===0||$.includes(s)))},[n,m,c,s]);let _=m.map(({group:w,label:j})=>({value:w,label:`${t("Group")} ${w}: ${j}`})),S=e.nodes.map(({nodeId:w})=>({value:w,label:`${t("Node")} ${(0,mn.padStart)(w.toString(),3,"0")}`})),b=P.default.useMemo(()=>{let w=[{value:0,label:t("Root device")}];for(let j of e.endpoints)j!==0&&w.push({value:j,label:`${t("Endpoint")} ${j}`});return w},[e.endpoints]),v=P.default.useMemo(()=>{let w=e.nodes.find($=>$.nodeId===c)?.endpointIndizes??[];if(w.includes(0)||w.unshift(0),!!m.find($=>$.group===n)?.multiChannel){let $=[{value:"none",label:t("Root device")}];for(let U of w)$.push({value:U,label:U===0?t("Root endpoint"):`${t("Endpoint")} ${U}`});return $}else return[]},[e.nodes,m,n,c]),A=e.sourceEndpoint==null&&e.group==null&&e.nodeId==null&&e.endpoint==null;async function B(){try{x(!0),await e.save(r,n,c,s),A&&R()}catch(w){alert(t("The association could not be saved!")),console.error(`The association could not be saved! Reason: ${de(w)}`),R()}finally{x(!1)}}function R(){o(e.sourceEndpoint),a(e.group),i(e.nodeId),l(e.endpoint)}async function Y(){if(!!e.delete)try{x(!0),await e.delete()}catch(w){alert(t("The association could not be deleted!")),console.error(`The association could not be deleted! Reason: ${de(w)}`),R()}finally{x(!1)}}let W=m.find(w=>w.group===n),y=m.some(w=>w.multiChannel),I=zu();return P.default.createElement(Sn.default,null,P.default.createElement(lt,null,P.default.createElement(st.Dropdown,{className:I.dropdown,options:b,selectedOption:r??"",placeholder:t("- select endpoint -"),onChange:w=>{o(w.target.value)}})),P.default.createElement(lt,null,P.default.createElement(st.Dropdown,{className:I.dropdown,options:_,selectedOption:n,placeholder:t("- select group -"),onChange:w=>{a(w.target.value)}})),P.default.createElement(lt,null,P.default.createElement(st.Dropdown,{className:I.dropdown,options:S,selectedOption:c,placeholder:t("- select node -"),onChange:w=>{i(w.target.value)}})),e.supportsMultiChannel&&P.default.createElement(lt,null,W?.multiChannel&&y&&P.default.createElement(st.Dropdown,{className:I.dropdown,options:v,selectedOption:s??"none",placeholder:t("- select endpoint -"),onChange:w=>{let j=w.target.value;l(j==="none"?void 0:j)}})),P.default.createElement(lt,null,P.default.createElement(hn.default,{variant:"contained",color:"primary",style:{flex:"1 0 auto"}},P.default.createElement(Ft.default,{title:t("Save association")},P.default.createElement(Gt.default,{disabled:C||!d||!g,onClick:()=>B()},A?P.default.createElement(vn.default,null):P.default.createElement(yn.default,null))),P.default.createElement(Ft.default,{title:t("Undo changes")},P.default.createElement(Gt.default,{disabled:C||!g,onClick:()=>R()},P.default.createElement(bn.default,null))),!A&&P.default.createElement(Ft.default,{title:t("Delete association")},P.default.createElement(Gt.default,{disabled:C,onClick:()=>Y()},P.default.createElement(xn.default,null))))))};var xe=u(T()),Tn=u(K()),ut=u(Pe()),Qe=u(At()),kn=u(Z()),An=u(Cn()),Dn=u(_n()),qn=u(In()),Pn=u(jn()),sc=(0,kn.makeStyles)(e=>({deviceIconAlive:{color:Qe.green[800]},deviceIconAsleep:{color:Qe.lightBlue[500]},deviceIconDead:{color:Qe.red[900]}})),$t=e=>{let{status:t}=e,{translate:r}=(0,Tn.useI18n)(),o=sc(),n=r(t??"unknown");switch(t){case"alive":case"awake":return xe.default.createElement(ut.default,{title:n},xe.default.createElement(An.default,{className:o.deviceIconAlive}));case"asleep":return xe.default.createElement(ut.default,{title:n},xe.default.createElement(Pn.default,{className:o.deviceIconAsleep}));case"dead":return xe.default.createElement(ut.default,{title:n},xe.default.createElement(Dn.default,{className:o.deviceIconDead}));default:return xe.default.createElement(ut.default,{title:n},xe.default.createElement(qn.default,null))}};var ct=u(T()),Vt=u(K()),Nn=u(Ue()),no=e=>ct.default.createElement(Nn.default,{variant:"body1",style:{textAlign:"center"}},e.children),Xe=()=>{let{translate:e}=(0,Vt.useI18n)();return ct.default.createElement(no,null,e("adapter not ready"))},Mn=()=>{let{translate:e}=(0,Vt.useI18n)();return ct.default.createElement(no,null,e("No devices present"))},Bn=()=>{let{translate:e}=(0,Vt.useI18n)();return ct.default.createElement(no,null,e("Node is not ready"))};var ao=u(K()),En=u(Kr()),Je=u(Ke()),Fn=u(Yr()),Gn=u(Ye()),zn=u(Ur()),Ln=u(Dt()),Rn=u(Z()),io=u(Ue()),so=(0,Rn.makeStyles)(e=>({headline:{backgroundColor:e.palette.background.default,margin:e.spacing(-2),marginBottom:e.spacing(2),borderBottom:`1px solid ${e.palette.divider}`,padding:e.spacing(2)},table:{marginTop:e.spacing(-2)},nodeNumber:{"& > *":{verticalAlign:"middle"}},paper:{padding:e.spacing(2),backgroundColor:e.palette.background.paper,marginTop:e.spacing(4),"&:first-child":{margin:0}}}));function lc(e){let{translate:t}=(0,ao.useI18n)(),{value:r,status:o}=e.device,n=r.native.id,a=r.common.name&&!r.common.name.startsWith("Node")?r.common.name:void 0,c=so();return E.default.createElement("div",{className:c.headline},E.default.createElement(io.default,{variant:"h5",component:"h2",className:c.nodeNumber},E.default.createElement("span",null,t("Node")," ",(0,On.padStart)(n.toString(),3,"0")),"\xA0",E.default.createElement($t,{status:o})),a&&E.default.createElement(io.default,{variant:"h6",component:"h3"},a))}function uc(e){let{translate:t}=(0,ao.useI18n)(),{endpoints:r,value:o}=e.device,n=o.native.id,{sourceEndpoints:a,groups:c,supportsMultiChannel:i,hasAssociations:s,associations:l}=E.default.useMemo(()=>{let f=[],g=!1,h=!1,C=new Map,x=[];if(r){for(let[m,_]of r)_.associationGroups?(h||=Object.values(_.associationGroups).some(S=>!!S.multiChannel),C.set(m,Object.entries(_.associationGroups).map(([S,b])=>({group:parseInt(S),...b})))):C.set(m,[]),_.associations&&(f.push(...Object.entries(_.associations).map(([S,b])=>b.map(v=>({sourceEndpoint:m,group:parseInt(S),...v}))).reduce((S,b)=>[...S,...b],[]).sort((S,b)=>S.group-b.group||S.nodeId-b.nodeId||(S.endpoint??-1)-(b.endpoint??-1))),g||=Object.keys(_.associations).length>0);h&&x.push(0),x.push(...r.keys())}return{sourceEndpoints:x,groups:C,supportsMultiChannel:h,hasAssociations:g,associations:f}},[r]),d=so();return E.default.createElement(zn.default,{className:d.table},E.default.createElement(Fn.default,null,E.default.createElement(Gn.default,null,E.default.createElement(Je.default,null,t("Source endpoint")),E.default.createElement(Je.default,null,t("Group")),E.default.createElement(Je.default,null,t("Target node")),i&&E.default.createElement(Je.default,null,t("Target endpoint")),E.default.createElement(Je.default,null,"\xA0"))),E.default.createElement(En.default,null,s?l.map(f=>E.default.createElement(oo,{key:`from${n}${f.sourceEndpoint??-1}-to${f.group}-${f.nodeId}-${f.endpoint??-1}`,endpoints:a??[],groups:c,nodes:e.nodes.filter(g=>g.nodeId!==n),sourceEndpoint:f.sourceEndpoint??0,group:f.group,nodeId:f.nodeId,endpoint:f.endpoint,supportsMultiChannel:i,save:(g,h,C,x)=>e.saveAssociation(n,f,{sourceEndpoint:g,group:h,nodeId:C,endpoint:x}),delete:()=>e.deleteAssociation(n,f)})):E.default.createElement(E.default.Fragment,null),E.default.createElement(oo,{endpoints:a??[],groups:c,nodes:e.nodes.filter(f=>f.nodeId!==n),sourceEndpoint:void 0,group:void 0,nodeId:void 0,supportsMultiChannel:i,save:(f,g,h,C)=>e.saveAssociation(n,void 0,{sourceEndpoint:f,group:g,nodeId:h,endpoint:C})})))}var Hn=e=>{let{ready:t,endpoints:r}=e.device,o=!!r&&[...r.values()].some(a=>!!a.associationGroups),n=so();return t&&!o?E.default.createElement(E.default.Fragment,null):E.default.createElement(Ln.default,{className:n.paper,elevation:2},E.default.createElement(lc,{device:e.device}),t?E.default.createElement(uc,{...e}):E.default.createElement(Bn,null))};var Wn=u(K());var $n=u(qt()),Vn=e=>{let{alive:t,connected:r}=(0,Wn.useAdapter)(),o=oe(),{devices:n,updateDevices:a}=e;async function c(f,g,h){g&&await i(f,g),await o.addAssociation(f,h),await a()}async function i(f,g){await o.removeAssociation(f,g),await a()}let s=n?Object.values(n).filter(Boolean):[],l=s.map(f=>({nodeId:f.value.native.id,endpointIndizes:f.value.native.endpointIndizes})),d=s.filter(f=>!f.value.native.isControllerNode);return!t||!r?Ne.default.createElement(Xe,null):n?d.length?Ne.default.createElement(Ne.default.Fragment,null,d.map((f,g)=>Ne.default.createElement(Hn,{key:g,device:f,nodes:l,saveAssociation:c,deleteAssociation:i}))):Ne.default.createElement(Mn,null):Ne.default.createElement($n.default,null)};var ue=u(T());var ce=u(K());var Yt=u(qe()),_e=u(T()),Yn=u(Mt()),Zn=u(Un()),Qn=u(Kn()),Xn=u(K()),Jn=u(Z()),ea=u(Ve()),V;(function(a){a[a.Idle=0]="Idle",a[a.Including=1]="Including",a[a.Excluding=2]="Excluding",a[a.Healing=3]="Healing",a[a.Busy=4]="Busy"})(V||(V={}));var xc=(0,Jn.makeStyles)(e=>({root:{display:"flex",flexDirection:"row",gap:e.spacing(1)},redButton:{background:e.palette.error.main,"&:hover":{background:e.palette.error.dark}}})),ta=e=>{let{translate:t}=(0,Xn.useI18n)(),r=xc();return _e.default.createElement("div",{className:r.root},_e.default.createElement(Yt.default,{variant:"contained",color:e.state===1?"secondary":"primary",startIcon:_e.default.createElement(Yn.default,null),disabled:e.state!==0&&e.state!==1,onClick:e.beginInclusion},e.state!==1?t("Include device"):t("Inclusion active")),_e.default.createElement(Yt.default,{variant:"contained",color:e.state===2?"secondary":"primary",startIcon:_e.default.createElement(Zn.default,null),disabled:e.state!==0&&e.state!==2,onClick:e.beginExclusion},e.state!==2?t("Exclude device"):t("Exclusion active")),_e.default.createElement(Yt.default,{variant:"contained",color:"primary",className:(0,ea.default)(e.state===3&&r.redButton),startIcon:_e.default.createElement(Qn.default,null),disabled:e.state!==0&&e.state!==3,onClick:e.state!==3?e.healNetwork:e.cancelHealing},e.state!==3?t("Heal network"):t("Cancel healing")))};var ee=u(T()),si=u(K()),li=u(Z()),ui=u(Dt()),ci=u(Ur()),di=u(Kr()),Oe=u(Ke()),fi=u(rn()),pi=u(Yr()),mo=u(Ye());var M=u(T()),Be=u(Ke()),po=u(Ye());var we=u(T()),ia=u(K()),sa=u(ra()),la=u(oa()),ua=u(na()),ca=u(aa()),dt=u(Pe()),Ie=u(At()),da=u(Z()),Lc=(0,da.makeStyles)(e=>({healIconPending:{color:Ie.blue[500],animation:"$rotation 1.5s infinite ease-in-out",animationFillMode:"forwards"},healIconFailed:{color:Ie.red[500]},healIconSkipped:{color:Ie.orange[800]},healIconDone:{color:Ie.green[900]},"@keyframes rotation":{"0%":{transform:"rotate(0deg)"},"95%":{transform:"rotate(720deg)",animationFillMode:"none"},"95.1%":{transform:"rotate(0deg)"}}})),fa=e=>{let{status:t}=e,{translate:r}=(0,ia.useI18n)(),o=Lc();switch(t){case"done":return we.default.createElement(dt.default,{title:r("done")},we.default.createElement(sa.default,{className:o.healIconDone}));case"skipped":return we.default.createElement(dt.default,{title:r("skipped")},we.default.createElement(la.default,{className:o.healIconSkipped}));case"failed":return we.default.createElement(dt.default,{title:r("failed")},we.default.createElement(ua.default,{className:o.healIconFailed}));case"pending":return we.default.createElement(dt.default,{title:r("pending")},we.default.createElement(ca.default,{className:o.healIconPending}))}throw new Error("Unknown heal status")};var Xa=u(Zo()),Ja=u(pa()),ei=u(ma()),ti=u(Ll()),ri=u(Z());var Me=u(qe()),ba=u(Z()),ft=u(Pe()),k=u(T());var sr=u(K()),xa=u(ga()),wa=u(Vr()),Sa=u(Ql()),Ca=u(lo());var uo=u(Wl()),lr=u(Ue()),_a=u(Ve()),Ia=u(ha()),ja=u(va()),Ta=u(ya()),Cd=(0,ba.makeStyles)(e=>({root:{padding:e.spacing(2,0),display:"grid",gridTemplateColumns:"minmax(auto, 300px) 1fr",alignItems:"center",columnGap:e.spacing(4),rowGap:e.spacing(2)},firmwareUpdate:{gridColumn:"1 / span 2",display:"flex",flexFlow:"row nowrap",justifyContent:"space-between",alignItems:"center",marginTop:e.spacing(4)},firmwareUpdateMessage:{gridColumn:"1 / span 2"},warning:{color:e.palette.warning.main},redButton:{background:e.palette.error.main,"&:hover":{background:e.palette.error.dark}}})),ka=e=>{let[t,r]=k.default.useState(),[o,n]=k.default.useState(!1),[a,c]=k.default.useState(),[i,s]=k.default.useState(),l=k.default.useRef(),d=oe(),{nodeId:f,isBusy:g,setBusy:h,supportsFirmwareUpdate:C}=e,{translate:x}=(0,sr.useI18n)(),{showNotification:m,showModal:_}=(0,sr.useDialogs)(),S=e.status!=="alive"&&e.status!=="awake";async function b(){if(!!await _(x("Remove node?"),x("Do you really want to remove this node from the network?"))){h(!0);try{await d.removeFailedNode(f)}catch(j){alert(j)}finally{h(!1)}}}async function v(){await _(x("Replace node?"),x("Do you really want to replace this node?"))&&e.replaceFailedNode()}async function A(){h(!0);try{await d.refreshNodeInfo(f)}catch(w){alert(w)}finally{h(!1)}}let B=()=>{l.current?.click()},R=async w=>{if(w.target.files?.length){let j=w.target.files[0],$=new Uint8Array(await j.arrayBuffer());r({name:j.name,data:$})}};async function Y(){if(C&&t?.data){h(!0);try{n(!0),c({type:"progress",sentFragments:0,totalFragments:1}),await d.beginFirmwareUpdate(f,t.name,Array.from(t.data))}catch(w){n(!1),alert(w)}finally{h(!1),s(void 0)}}}async function W(){h(!0);try{await d.abortFirmwareUpdate(f)}catch(w){alert(w)}finally{h(!1),n(!1)}}Pt(w=>{if(w.type==="firmwareUpdate"){let j=w.progress;if(c(j),j.type==="done"){let $=j.status>=253;if(!$)m(x("firmware update failed"),"error"),s(void 0);else{let U=x("firmware update successful");$&&(j.waitTime?U+=" "+x("firmware update wait time").replace("{0}",j.waitTime.toString()):U+=" "+x("firmware update no wait time"),U+=" "+x("firmware update wake up")),s(U)}r(void 0),n(!1),setTimeout(()=>{c(void 0)},1e4)}else n(!0)}});let y=a?.type==="progress"&&typeof a.totalFragments=="number"&&typeof a.sentFragments=="number"?Math.round(a.sentFragments/a.totalFragments*1e4)/100:Number.NaN;k.default.useEffect(()=>{a?.type!=="done"&&(e.status==="asleep"&&o?s(x("wake up device")):s(void 0))},[e.status,o,a]);let I=Cd();return k.default.createElement("div",{className:I.root},k.default.createElement(Me.default,{disabled:g,variant:"contained",color:"primary",startIcon:k.default.createElement(Ca.default,null),onClick:()=>A(),fullWidth:!0},x("Refresh node info")),k.default.createElement(lr.default,{variant:"body2"},x("Forget all information about all nodes and re-interview them. Battery-powered nodes might need to be woken up manually.")),k.default.createElement(ft.default,{title:S?"":x("This is not a failed node")},k.default.createElement("span",null,k.default.createElement(Me.default,{disabled:!S||g,variant:"contained",className:I.redButton,onClick:b,startIcon:k.default.createElement(ja.default,null),fullWidth:!0},x("Remove failed node")))),k.default.createElement(lr.default,{variant:"body2"},x("Remove this node from the network."),k.default.createElement("br",null),k.default.createElement("span",{className:I.warning},x("WARNING: Only do this if you no longer have physical access."))),k.default.createElement(ft.default,{title:S?"":x("This is not a failed node")},k.default.createElement("span",null,k.default.createElement(Me.default,{disabled:!S||g,variant:"contained",className:I.redButton,onClick:v,startIcon:k.default.createElement(Ta.default,null),fullWidth:!0},x("Replace failed node")))),k.default.createElement(lr.default,{variant:"body2"},x("Replace this node with a different one, keeping the node ID."),k.default.createElement("br",null),k.default.createElement("span",{className:I.warning},x("WARNING: Make sure that the node is reset before attempting this."))),C&&k.default.createElement(k.default.Fragment,null,k.default.createElement("div",{className:I.firmwareUpdate},k.default.createElement(Me.default,{disabled:o||g,variant:"contained",color:"primary",onClick:()=>B(),style:{flex:"1 0 auto"},startIcon:k.default.createElement(Ia.default,null)},x("Update Firmware")),k.default.createElement("input",{type:"file",hidden:!0,id:"firmwareFile",accept:".exe,.ex_,.ota,.otz,.hex,.hec,.gbl,.bin",ref:w=>{w&&(l.current=w)},onChange:R}),o?k.default.createElement(k.default.Fragment,null,k.default.createElement("div",{className:"progress",style:{margin:"0 1em",flex:"1 1 100%"}},Number.isNaN(y)?k.default.createElement(uo.default,null):k.default.createElement(uo.default,{variant:"determinate",value:y})),!Number.isNaN(y)&&k.default.createElement("div",{style:{whiteSpace:"nowrap",marginRight:"1em"}},y.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})," %")):k.default.createElement("span",{style:{flex:"1 1 100%",textAlign:"center",padding:"0 1em",wordBreak:"break-all"}},t?`${t.name} (${t.data.byteLength} bytes)`:x("no file selected")),k.default.createElement(wa.default,{variant:"contained",color:"primary",style:{flex:"1 0 auto"}},k.default.createElement(ft.default,{title:x("start firmware update")},k.default.createElement(Me.default,{disabled:o||g||!t?.data,onClick:()=>Y()},k.default.createElement(xa.default,null))),k.default.createElement(ft.default,{title:x("abort firmware update")},k.default.createElement(Me.default,{disabled:!o||g,onClick:()=>W()},k.default.createElement(Sa.default,null))))),i?k.default.createElement("div",{className:I.firmwareUpdateMessage},i):k.default.createElement("div",{className:(0,_a.default)(I.firmwareUpdateMessage,I.warning)},x("firmware update warning"))))};var oi=u(K());var et=u(T()),Da=u(Pe()),me=u(At()),qa=u(Z()),Pa=u(fu()),Na=u(Aa()),Ma=u(Ve()),Ba=(0,qa.makeStyles)(e=>({root:{display:"grid",gridTemplateColumns:"repeat(4, 16px)",gridTemplateRows:"16px"},securityIcon:{fontSize:"16px",color:me.grey[200]},S2_AccessControl:{color:me.green[800]},S2_Authenticated:{color:me.blue[900]},S2_Unauthenticated:{color:me.deepPurple[500]},S0_Legacy:{color:me.amber[800]}})),Ad=e=>{let t=Ba(),r=e.granted?Pa.default:Na.default;return e.supported?et.default.createElement(Da.default,{title:`${e.title}: ${e.granted?"\u2714":"\u2718"}`},et.default.createElement(r,{className:(0,Ma.default)(t.securityIcon,e.granted&&t[e.className])})):et.default.createElement("span",null)},Dd=[["S2_AccessControl","S2 Access Control"],["S2_Authenticated","S2 Authenticated"],["S2_Unauthenticated","S2 Unauthenticated"],["S0_Legacy","S0 Legacy"]],Oa=e=>{let t=Ba(),{securityClasses:r}=e;return et.default.createElement("div",{className:t.root},Dd.map(([o,n])=>et.default.createElement(Ad,{key:o,title:n,className:o,supported:o in r,granted:r[o]===!0})))};var ni=u(Ea()),ai=u(Pe());var fr=u(qe()),Ua=u(Z()),J=u(T());var ge=u(K()),pr=u(nn()),Ka=u(Et()),Ya=u(lo()),Za=u(Fa());var le=u(T()),Ga=u(K()),za=u(en()),La=u(tn()),Ra=u(Xo()),Ha=u(Jo()),co=u(qe()),Wa=u(to()),fo=u(Ue()),$a=u(Z()),Ld=(0,$a.makeStyles)(e=>({root:{display:"flex",flexFlow:"column",maxWidth:400,gap:e.spacing(2)}})),Va=e=>{let{translate:t}=(0,Ga.useI18n)(),r=Ld(),[o,n]=le.default.useState(e.region),a=le.default.useMemo(()=>Object.entries(e.regions).map(([c,i])=>({value:c,label:i})),[e.regions]);return le.default.createElement(Ra.default,{open:e.open,onClose:e.onCancel,maxWidth:!1},le.default.createElement(La.default,{id:"alert-dialog-title"},t("Set RF Region")),le.default.createElement(za.default,{className:r.root},le.default.createElement(fo.default,{variant:"body1"},t("Select the correct region for where you are. Using a different region may be illegal.")),le.default.createElement(Wa.Dropdown,{selectedOption:o,options:a,onChange:c=>n(parseInt(c.target.value))}),le.default.createElement(fo.default,{variant:"body2"},t("Note: Applying a different region might take a few seconds."))),le.default.createElement(Ha.default,null,le.default.createElement(co.default,{disabled:e.region===o,onClick:()=>e.onConfirm(o),color:"primary"},t("OK")),le.default.createElement(co.default,{onClick:e.onCancel,color:"primary"},t("Cancel"))))};var Rd=(0,Ua.makeStyles)(e=>({root:{padding:e.spacing(2,0),display:"grid",gridTemplateColumns:"minmax(auto, 300px) 1fr",alignItems:"center",columnGap:e.spacing(4),rowGap:e.spacing(2)},redButton:{background:e.palette.error.main,"&:hover":{background:e.palette.error.dark}}})),Qa=e=>{let{isBusy:t,setBusy:r}=e,{namespace:o}=(0,ge.useGlobals)(),n=oe(),{translate:a}=(0,ge.useI18n)(),{showModal:c,showNotification:i}=(0,ge.useDialogs)(),[s,l]=J.default.useState(!1),[d]=(0,ge.useIoBrokerObject)(`${o}.info.rfRegion`,{subscribe:!1}),[f]=(0,ge.useIoBrokerState)({id:`${o}.info.rfRegion`}),g=J.default.useCallback(m=>{t||(r(!0),n.setRFRegion(m).finally(()=>r(!1)))},[n,t,r]),h=J.default.useCallback(async()=>{if(!t)try{if(!await c(a("Re-interview all?"),a("clear cache procedure")))return;r(!0),await n.clearCache(),setTimeout(()=>{r(!1)},1e3)}catch(m){i(de(m),"error");return}},[n,t,c,i]),C=J.default.useCallback(async()=>{if(!t)try{if(!await c(a("Factory reset?"),a("factory reset procedure")))return;r(!0),await n.hardReset(),r(!1),await c(a("Factory reset successful"),a("The adapter will now restart."))}catch(m){i(de(m),"error");return}},[n,t,c,i]),x=Rd();return J.default.createElement("div",{className:x.root},J.default.createElement(fr.default,{disabled:t,variant:"contained",color:"primary",onClick:h,startIcon:J.default.createElement(Ya.default,null)},a("Re-interview all")),J.default.createElement(pr.Typography,{variant:"body2"},a("Forget all information about all nodes and re-interview them. Battery-powered nodes might need to be woken up manually.")),J.default.createElement(fr.default,{disabled:t||f==null,variant:"contained",color:"primary",onClick:()=>l(!0),startIcon:J.default.createElement(Za.default,null)},a("Set RF Region")),J.default.createElement(pr.Typography,{variant:"body2"},a("Configure the region and radio frequencies of the controller.")),J.default.createElement(fr.default,{className:x.redButton,disabled:t,variant:"contained",onClick:C,startIcon:J.default.createElement(Ka.default,null)},a("Factory reset")),J.default.createElement(pr.Typography,{variant:"body2"},a("Wipes all configuration of the controller. All connected nodes will be orphaned and have to be reset and included into the new network before they can be used again.")),d&&f!=null&&J.default.createElement(Va,{open:s,onCancel:()=>l(!1),onConfirm:m=>{g(m),l(!1)},region:f,regions:d.common.states??{}}))};var Hd=(0,ri.makeStyles)(e=>({mainRow:{"& > *":{border:0}},controllerIcon:{fontSize:"16px",margin:"7px",color:e.palette.text.secondary},idCell:{display:"flex",flexFlow:"row nowrap",alignItems:"center"},expanderCell:{paddingBottom:0,paddingTop:0,background:e.palette.background.default}})),ii=e=>{let{healStatus:t,device:r}=e,{value:o,status:n}=r,a=o.native.id,c=!!o.native.supportsFirmwareUpdate,{secure:i,securityClasses:s,isControllerNode:l}=o.native,[d,f]=M.default.useState(l),g=Hd(),{translate:h}=(0,oi.useI18n)();return M.default.createElement(M.default.Fragment,null,M.default.createElement(po.default,{hover:!0,className:g.mainRow},M.default.createElement(Be.default,{className:g.idCell},M.default.createElement(Xa.default,{"aria-label":"expand row",size:"small",onClick:()=>f(!d)},d?M.default.createElement(ei.default,null):M.default.createElement(Ja.default,null)),M.default.createElement("span",{style:{marginLeft:"auto"}},a)),M.default.createElement(Be.default,null,o.common.name),M.default.createElement(Be.default,null,o.native.type.specific??o.native.type.generic??h("unknown")),M.default.createElement(Be.default,null,i&&s&&M.default.createElement(Oa,{securityClasses:s})),M.default.createElement(Be.default,null,l?M.default.createElement(ai.default,{title:h("Controller node")},M.default.createElement(ni.default,null)):M.default.createElement(M.default.Fragment,null,M.default.createElement($t,{status:n}),!!t&&M.default.createElement(M.default.Fragment,null," ",M.default.createElement(fa,{status:e.healStatus}))))),M.default.createElement(po.default,null,M.default.createElement(Be.default,{colSpan:5,className:g.expanderCell},M.default.createElement(ti.default,{in:d,timeout:"auto",unmountOnExit:!0},l?M.default.createElement(Qa,{isBusy:e.isBusy,setBusy:e.setBusy}):M.default.createElement(ka,{nodeId:a,status:n,isBusy:e.isBusy,setBusy:e.setBusy,supportsFirmwareUpdate:c,replaceFailedNode:e.replaceFailedNode})))))};var Wd=(0,li.makeStyles)(e=>({root:{width:"100%",marginTop:e.spacing(2)},container:{overflowY:"auto"},empty:{textAlign:"center",fontStyle:"italic"}})),mi=e=>{let{translate:t}=(0,si.useI18n)(),r=Wd(),{devices:o,healingNetwork:n,networkHealProgress:a}=e;return ee.default.createElement(ui.default,{className:r.root,elevation:2},ee.default.createElement(fi.default,{className:r.container},ee.default.createElement(ci.default,null,ee.default.createElement(pi.default,null,ee.default.createElement(mo.default,null,ee.default.createElement(Oe.default,{align:"right"},"#"),ee.default.createElement(Oe.default,null,t("Name")),ee.default.createElement(Oe.default,null,t("Type")),ee.default.createElement(Oe.default,null,t("Security")),ee.default.createElement(Oe.default,null,t("Status")))),ee.default.createElement(di.default,null,o.length?o.map(c=>{let i=c.value.native.id;return ee.default.createElement(ii,{key:`device-${i}`,isBusy:e.isBusy,setBusy:e.setBusy,device:c,healStatus:n?a[i]:void 0,replaceFailedNode:()=>e.replaceFailedNode(i)})}):ee.default.createElement(mo.default,null,ee.default.createElement(Oe.default,{colSpan:5,className:r.empty},t("No devices present")))))))};var Q=u(qe()),Pi=u(Xo()),Te=u(Jo()),ke=u(en()),Ni=u(tn()),Mi=u(qt()),Bi=u(Z()),L=u(Ue()),ie=u(K()),p=u(T()),ho=u(Zl()),Oi=u(Xl()),mr=u(At()),vo=u(Ve()),Ei=u(on()),Ee=u(Hl()),Fe=u(Qo());var ae=u(T()),og=u(zl()),Ti=u(Ve()),je=u(Z()),ki=u(Dt());var gi=u(T()),hi=u(at()),vi=(0,hi.createSvgIcon)(gi.createElement("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined");var yi=u(T()),bi=u(at()),xi=(0,bi.createSvgIcon)(yi.createElement("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined");var wi=u(T()),Si=u(at()),Ci=(0,Si.createSvgIcon)(wi.createElement("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline");var _i=u(T()),Ii=u(at()),ji=(0,Ii.createSvgIcon)(_i.createElement("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined");var Ai=u(Zo()),Di=u(at()),$d=function(t){var r=t.palette.type==="light"?je.darken:je.lighten,o=t.palette.type==="light"?je.lighten:je.darken;return{root:Qr({},t.typography.body2,{borderRadius:t.shape.borderRadius,backgroundColor:"transparent",display:"flex",padding:"6px 16px"}),standardSuccess:{color:r(t.palette.success.main,.6),backgroundColor:o(t.palette.success.main,.9),"& $icon":{color:t.palette.success.main}},standardInfo:{color:r(t.palette.info.main,.6),backgroundColor:o(t.palette.info.main,.9),"& $icon":{color:t.palette.info.main}},standardWarning:{color:r(t.palette.warning.main,.6),backgroundColor:o(t.palette.warning.main,.9),"& $icon":{color:t.palette.warning.main}},standardError:{color:r(t.palette.error.main,.6),backgroundColor:o(t.palette.error.main,.9),"& $icon":{color:t.palette.error.main}},outlinedSuccess:{color:r(t.palette.success.main,.6),border:"1px solid ".concat(t.palette.success.main),"& $icon":{color:t.palette.success.main}},outlinedInfo:{color:r(t.palette.info.main,.6),border:"1px solid ".concat(t.palette.info.main),"& $icon":{color:t.palette.info.main}},outlinedWarning:{color:r(t.palette.warning.main,.6),border:"1px solid ".concat(t.palette.warning.main),"& $icon":{color:t.palette.warning.main}},outlinedError:{color:r(t.palette.error.main,.6),border:"1px solid ".concat(t.palette.error.main),"& $icon":{color:t.palette.error.main}},filledSuccess:{color:"#fff",fontWeight:t.typography.fontWeightMedium,backgroundColor:t.palette.success.main},filledInfo:{color:"#fff",fontWeight:t.typography.fontWeightMedium,backgroundColor:t.palette.info.main},filledWarning:{color:"#fff",fontWeight:t.typography.fontWeightMedium,backgroundColor:t.palette.warning.main},filledError:{color:"#fff",fontWeight:t.typography.fontWeightMedium,backgroundColor:t.palette.error.main},icon:{marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9},message:{padding:"8px 0"},action:{display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}}},qi={success:ae.createElement(vi,{fontSize:"inherit"}),warning:ae.createElement(xi,{fontSize:"inherit"}),error:ae.createElement(Ci,{fontSize:"inherit"}),info:ae.createElement(ji,{fontSize:"inherit"})},Vd=ae.createElement(ln,{fontSize:"small"}),Ud=ae.forwardRef(function(t,r){var o=t.action,n=t.children,a=t.classes,c=t.className,i=t.closeText,s=i===void 0?"Close":i,l=t.color,d=t.icon,f=t.iconMapping,g=f===void 0?qi:f,h=t.onClose,C=t.role,x=C===void 0?"alert":C,m=t.severity,_=m===void 0?"success":m,S=t.variant,b=S===void 0?"standard":S,v=sn(t,["action","children","classes","className","closeText","color","icon","iconMapping","onClose","role","severity","variant"]);return ae.createElement(ki.default,Qr({role:x,square:!0,elevation:0,className:(0,Ti.default)(a.root,a["".concat(b).concat((0,Di.capitalize)(l||_))],c),ref:r},v),d!==!1?ae.createElement("div",{className:a.icon},d||g[_]||qi[_]):null,ae.createElement("div",{className:a.message},n),o!=null?ae.createElement("div",{className:a.action},o):null,o==null&&h?ae.createElement("div",{className:a.action},ae.createElement(Ai.default,{size:"small","aria-label":s,title:s,color:"inherit",onClick:h},Vd)):null)}),go=(0,je.withStyles)($d,{name:"MuiAlert"})(Ud);var Ge=(0,Bi.makeStyles)(e=>({strategyRoot:{},strategyGridHeadline:{marginTop:e.spacing(4)},strategyGrid:{marginTop:e.spacing(1),display:"grid",gridTemplateColumns:"auto 400px",gridGap:e.spacing(2),alignItems:"center"},strategyList:{...e.typography.body2},waitMessageRoot:{display:"grid",gridTemplateColumns:"minmax(auto, 10ch) 1fr",gridGap:e.spacing(4),alignItems:"center",overflow:"hidden"},grantRoot:{display:"flex",flexFlow:"column nowrap",gap:e.spacing(1),maxWidth:"600px"},grantHeadline:{marginTop:e.spacing(-1),marginBottom:e.spacing(1)},grantCSA:{marginTop:e.spacing(2)},validateDSKRoot:{maxWidth:"600px"},validateDSKGrid:{marginTop:e.spacing(1),display:"grid",width:"100%",gridTemplateColumns:"minmax(auto, 10ch) 1fr",gridGap:e.spacing(1),alignItems:"center",textAlign:"center"},resultRoot:{display:"grid",gridTemplateColumns:"auto 1fr",gridTemplateRows:"auto auto auto",alignItems:"center"},resultIcon:{marginRight:e.spacing(4),fontSize:"64px",gridRow:"1 / span 3",gridColumn:1},resultIconOK:{color:mr.green[500]},resultIconLowSecurity:{color:mr.yellow[700]}})),N;(function(l){l[l.SelectInclusionStrategy=0]="SelectInclusionStrategy",l[l.SelectReplacementStrategy=1]="SelectReplacementStrategy",l[l.IncludeDevice=2]="IncludeDevice",l[l.ExcludeDevice=3]="ExcludeDevice",l[l.GrantSecurityClasses=4]="GrantSecurityClasses",l[l.ValidateDSK=5]="ValidateDSK",l[l.Busy=6]="Busy",l[l.Result=7]="Result",l[l.ExclusionResult=8]="ExclusionResult"})(N||(N={}));var Se;(function(a){a[a.Default=0]="Default",a[a.SmartStart=1]="SmartStart",a[a.Insecure=2]="Insecure",a[a.Security_S0=3]="Security_S0",a[a.Security_S2=4]="Security_S2"})(Se||(Se={}));var Kd=e=>{let{translate:t}=(0,ie.useI18n)(),r=Ge(),[o,n]=p.default.useState(!1),a=t(o?"Security S2 when supported, Security S0 as a fallback, no encryption otherwise.":"Security S2 when supported, Security S0 only when necessary, no encryption otherwise."),{namespace:c}=(0,ie.useGlobals)(),[i]=(0,ie.useIoBrokerObject)(`system.adapter.${c}`,{subscribe:!1}),s=i?.native,l=s&&(!s.networkKey_S0||!s.networkKey_S2_AccessControl||!s.networkKey_S2_Authenticated||!s.networkKey_S2_Unauthenticated);return p.default.createElement(p.default.Fragment,null,p.default.createElement(ke.default,{className:r.strategyRoot},p.default.createElement(L.default,{variant:"body2"},t("Z-Wave supports the following security mechanisms:")),p.default.createElement("ul",{className:r.strategyList,style:{marginTop:"0.5em"}},p.default.createElement("li",null,p.default.createElement("b",null,"Security S2")," \u2013 ",t("fast and secure")," ",p.default.createElement("b",null,t("(recommended)"))),p.default.createElement("li",null,p.default.createElement("b",null,"Security S0")," \u2013"," ",t("secure, but slow due to a lot of overhead")," ",p.default.createElement("b",null,t("(use only when necessary)"))),p.default.createElement("li",null,t("No encryption"))),l&&p.default.createElement(go,{severity:"warning"},t("At least one network key is not yet configured. This can cause problems during secure inclusion.")),p.default.createElement(L.default,{variant:"body1",className:r.strategyGridHeadline},t("Please choose an inclusion strategy"),":"),p.default.createElement("div",{className:r.strategyGrid},p.default.createElement("div",{style:{gridRow:1,display:"flex",flexFlow:"column"}},p.default.createElement(Q.default,{variant:"contained",color:"primary",onClick:()=>e.selectStrategy(0,o)},t("Default (secure)")),p.default.createElement(Ee.default,{label:t("Prefer S0 over no encryption"),control:p.default.createElement(Fe.default,{checked:o,onChange:(d,f)=>n(f)})})),p.default.createElement(L.default,{variant:"caption",style:{alignSelf:"flex-start"}},a,p.default.createElement("br",null),t("Requires user interaction during the inclusion.")),p.default.createElement(Q.default,{variant:"contained",color:"secondary",style:{gridRow:2},disabled:!0,onClick:()=>e.selectStrategy(1)},"SmartStart"),p.default.createElement(L.default,{variant:"caption"},"coming soon..."),p.default.createElement(Q.default,{variant:"contained",color:"secondary",style:{gridRow:3},onClick:()=>e.selectStrategy(3)},t("Security S0")),p.default.createElement(L.default,{variant:"caption"},t("Only use S0, even if S2 is available. Allows including devices that require security but don't behave correctly during S2 inclusion.")),p.default.createElement(Q.default,{variant:"contained",color:"default",style:{gridRow:4},onClick:()=>e.selectStrategy(2)},t("No encryption")))),p.default.createElement(Te.default,null,p.default.createElement(Q.default,{variant:"contained",onClick:e.onCancel,color:"primary"},t("Cancel"))))},Yd=e=>{let{translate:t}=(0,ie.useI18n)(),r=Ge();return p.default.createElement(p.default.Fragment,null,p.default.createElement(ke.default,{className:r.strategyRoot},p.default.createElement(L.default,{variant:"body1",className:r.strategyGridHeadline},t("Please choose a replacement strategy"),":"),p.default.createElement("div",{className:r.strategyGrid},p.default.createElement(Q.default,{variant:"contained",color:"primary",style:{gridRow:1},onClick:()=>e.selectStrategy(4)},t("Security S2")),p.default.createElement(L.default,{variant:"caption",style:{alignSelf:"flex-start"}},t("fast and secure"),p.default.createElement("br",null),t("(recommended)")),p.default.createElement(Q.default,{variant:"contained",color:"secondary",style:{gridRow:2},disabled:!0,onClick:()=>e.selectStrategy(3)},t("Security S0")),p.default.createElement(L.default,{variant:"caption"},t("secure, but slow due to a lot of overhead"),p.default.createElement("br",null),t("(use only when necessary)")),p.default.createElement(Q.default,{variant:"contained",color:"default",style:{gridRow:3},onClick:()=>e.selectStrategy(2)},t("No encryption")))),p.default.createElement(Te.default,null,p.default.createElement(Q.default,{variant:"contained",onClick:e.onCancel,color:"primary"},t("Cancel"))))},yo=e=>{let t=Ge(),{translate:r}=(0,ie.useI18n)();return p.default.createElement(p.default.Fragment,null,p.default.createElement(ke.default,{className:t.waitMessageRoot},p.default.createElement(Mi.default,{size:48}),p.default.createElement(L.default,{variant:"body1"},e.message)),p.default.createElement(Te.default,null,e.onCancel&&p.default.createElement(Q.default,{variant:"contained",onClick:e.onCancel,color:"primary"},r("Cancel"))))},Zd=e=>{let{translate:t}=(0,ie.useI18n)(),r=Ge(),o=e.request,n=o.securityClasses.includes(2),a=o.securityClasses.includes(1),c=o.securityClasses.includes(0),i=o.securityClasses.includes(7),s=o.clientSideAuth,[l,d]=p.default.useState(n),[f,g]=p.default.useState(a),[h,C]=p.default.useState(c),[x,m]=p.default.useState(i),[_,S]=p.default.useState(s),b=()=>{let v=[];l&&v.push(2),f&&v.push(1),h&&v.push(0),x&&v.push(7);let A={securityClasses:v,clientSideAuth:_};e.grantSecurityClasses(A)};return p.default.createElement(p.default.Fragment,null,p.default.createElement(ke.default,{className:r.grantRoot},p.default.createElement(L.default,{variant:"body1"},t("Please choose which of the following security classes to grant to the new node.")),p.default.createElement(L.default,{variant:"caption",className:r.grantHeadline},t("At least one must be granted or the key exchange will be canceled.")),p.default.createElement(Ee.default,{label:p.default.createElement(p.default.Fragment,null,p.default.createElement("b",null,"S2 Access Control",!n&&p.default.createElement(p.default.Fragment,null," (",t("not requested"),")")),p.default.createElement("br",null),p.default.createElement(L.default,{variant:"caption"},t("Example:")," ",t("Door locks, garage doors"),", ...")),disabled:!n,control:p.default.createElement(Fe.default,{checked:l,onChange:(v,A)=>d(A)})}),p.default.createElement(Ee.default,{label:p.default.createElement(p.default.Fragment,null,p.default.createElement("b",null,"S2 Authenticated",!a&&p.default.createElement(p.default.Fragment,null," (",t("not requested"),")")),p.default.createElement("br",null),p.default.createElement(L.default,{variant:"caption"},t("Example:")," ",t("Lighting, sensors, security systems"),", ...")),disabled:!a,control:p.default.createElement(Fe.default,{checked:f,onChange:(v,A)=>g(A)})}),p.default.createElement(Ee.default,{label:p.default.createElement(p.default.Fragment,null,p.default.createElement("b",null,"S2 Unauthenticated",!c&&p.default.createElement(p.default.Fragment,null," (",t("not requested"),")")),p.default.createElement("br",null),p.default.createElement(L.default,{variant:"caption"},t("Like S2 Authenticated, but without verification that the correct device is included"))),disabled:!c,control:p.default.createElement(Fe.default,{checked:h,onChange:(v,A)=>C(A)})}),p.default.createElement(Ee.default,{label:p.default.createElement(p.default.Fragment,null,p.default.createElement("b",null,"S0 Legacy",!i&&p.default.createElement(p.default.Fragment,null," (",t("not requested"),")")),p.default.createElement("br",null),p.default.createElement(L.default,{variant:"caption"},t("Example:")," ",t("Legacy door locks without S2 support"))),disabled:!i,control:p.default.createElement(Fe.default,{checked:x,onChange:(v,A)=>m(A)})}),p.default.createElement(Ee.default,{className:r.grantCSA,label:p.default.createElement(p.default.Fragment,null,p.default.createElement("b",null,"Client Side Authentication",!s&&p.default.createElement(p.default.Fragment,null," (",t("not requested"),")")),p.default.createElement("br",null),p.default.createElement(L.default,{variant:"caption"},t("For devices without a DSK. Authentication of the inclusion happens on the device instead of in ioBroker."))),disabled:!s,control:p.default.createElement(Fe.default,{checked:_,onChange:(v,A)=>S(A)})})),p.default.createElement(Te.default,null,p.default.createElement(Q.default,{variant:"contained",onClick:b,color:"primary"},t("OK")),p.default.createElement(Q.default,{variant:"contained",onClick:e.onCancel,color:"primary"},t("Cancel"))))},Qd=e=>{let{translate:t}=(0,ie.useI18n)(),[r,o]=p.default.useState(""),[n,a]=p.default.useState(!1),c=d=>{let f=d.target.value.replace(/[^0-9]/g,"");o(f),a(!1)},i=()=>{r.length!==5&&a(!0)},s=()=>{r.length===5&&e.setPIN(r)},l=Ge();return p.default.createElement(p.default.Fragment,null,p.default.createElement(ke.default,{className:l.validateDSKRoot},p.default.createElement(L.default,{variant:"body1",className:l.strategyGridHeadline},t("Please enter the 5-digit PIN for your device and verify that the rest of the device-specific key (DSK) matches the one on your device or the manual.")),p.default.createElement("div",{className:l.validateDSKGrid},p.default.createElement(Ei.default,{autoFocus:!0,variant:"outlined",margin:"dense",inputProps:{maxLength:5,style:{textAlign:"center"}},value:r,error:!!n,onChange:c,onBlur:i,onKeyDown:d=>{d.key==="Enter"&&s(),d.key==="Escape"&&e.onCancel()}}),p.default.createElement(L.default,{variant:"body1"},e.dsk),p.default.createElement(L.default,{variant:"caption"},"PIN"),p.default.createElement(L.default,{variant:"caption"},"DSK"))),p.default.createElement(Te.default,null,p.default.createElement(Q.default,{disabled:r.length!==5,onClick:s,color:"primary"},t("OK")),p.default.createElement(Q.default,{variant:"contained",onClick:e.onCancel,color:"primary"},t("Cancel"))))},Xd=e=>{let{translate:t}=(0,ie.useI18n)(),r=Ge(),o=e.lowSecurity?Oi.default:ho.default,n=e.lowSecurity?t("Node %s was added insecurely!",e.nodeId.toString()):t("Node %s was added successfully!",e.nodeId.toString()),a=e.lowSecurity?t("There was an error during secure inclusion. To try again, exclude the node first."):t("Security class: %s",e.securityClass??t("None")),c=t("The device is now being interviewed. It might take a while to show up.");return p.default.createElement(p.default.Fragment,null,p.default.createElement(ke.default,{className:r.resultRoot},p.default.createElement(o,{className:(0,vo.default)(r.resultIcon,e.lowSecurity?r.resultIconLowSecurity:r.resultIconOK)}),p.default.createElement(L.default,{variant:"body1",style:{fontWeight:"bold",fontSize:"125%"}},n),p.default.createElement(L.default,{variant:"body2"},a),p.default.createElement(L.default,{variant:"body2"},c)),p.default.createElement(Te.default,null,p.default.createElement(Q.default,{variant:"contained",onClick:e.onDone,color:"primary"},t("OK"))))},Jd=e=>{let{translate:t}=(0,ie.useI18n)(),r=Ge();return p.default.createElement(p.default.Fragment,null,p.default.createElement(ke.default,{className:r.resultRoot},p.default.createElement(ho.default,{className:(0,vo.default)(r.resultIcon,r.resultIconOK)}),p.default.createElement(L.default,{variant:"body2"},t("Node %s was removed from the network!",e.nodeId.toString()))),p.default.createElement(Te.default,null,p.default.createElement(Q.default,{variant:"contained",onClick:e.onDone,color:"primary"},t("OK"))))},Fi=e=>{let{translate:t}=(0,ie.useI18n)(),r=p.default.useMemo(()=>{switch(e.step){case 0:return p.default.createElement(Kd,{selectStrategy:e.selectStrategy,onCancel:e.onCancel});case 1:return p.default.createElement(Yd,{selectStrategy:e.selectStrategy,onCancel:e.onCancel});case 2:return p.default.createElement(yo,{message:t("Put your device into inclusion mode"),onCancel:e.onCancel});case 3:return p.default.createElement(yo,{message:t("Put your device into exclusion mode"),onCancel:e.onCancel});case 4:return p.default.createElement(Zd,{grantSecurityClasses:e.grantSecurityClasses,request:e.request,onCancel:e.onCancel});case 5:return p.default.createElement(Qd,{dsk:e.dsk,onCancel:e.onCancel,setPIN:e.setPIN});case 7:return p.default.createElement(Xd,{nodeId:e.nodeId,lowSecurity:e.lowSecurity,securityClass:e.securityClass,onDone:e.onDone});case 8:return p.default.createElement(Jd,{nodeId:e.nodeId,onDone:e.onDone});case 6:return p.default.createElement(yo,{message:t("Communicating with the device, please be patient...")})}},[e.step]),o=p.default.useMemo(()=>{switch(e.step){case 0:case 2:case 4:case 5:case 7:case 6:return t("Include device");case 1:return t("Replace device");case 3:case 8:return t("Exclude device")}},[e.step]);return p.default.createElement(Pi.default,{open:e.isOpen,onClose:e.onCancel,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",maxWidth:!1},p.default.createElement(Ni.default,{id:"alert-dialog-title"},o),r)};var Gi=u(qt()),zi=e=>{let{devices:t}=e,{alive:r,connected:o}=(0,ce.useAdapter)(),{namespace:n}=(0,ce.useGlobals)(),{translate:a}=(0,ce.useI18n)(),c=oe(),{showNotification:i}=(0,ce.useDialogs)(),[s,l]=ue.default.useState(!1),[d]=(0,ce.useIoBrokerState)({id:`${n}.info.inclusion`,defaultValue:!1}),[f,,g]=(0,ce.useIoBrokerState)({id:`${n}.info.exclusion`,defaultValue:!1}),[h]=(0,ce.useIoBrokerState)({id:`${n}.info.healingNetwork`,defaultValue:!1}),[C,x]=ue.default.useState({}),[m,_]=ue.default.useState();Pt(y=>{y.type==="inclusion"?_(y.status):y.type==="healing"&&(x(y.status.progress??{}),y.status.type==="done"&&i(a("Healing the network was successful!"),"success"))});async function S(){if(!h)try{x({}),await c.beginHealingNetwork()}catch(y){i(de(y),"error");return}}let[b,v]=ue.default.useState(!1),A=[];if(t)for(let y of Object.keys(t)){let I=t[y];I&&A.push(I)}async function B(y){_({type:"chooseReplacementStrategy",nodeId:y}),v(!0)}let R=(()=>{if(f)return{step:N.ExcludeDevice,onCancel:()=>{v(!1),setTimeout(()=>{g(!1)},250)}};if(!m&&!d)return{step:N.SelectInclusionStrategy,onCancel:()=>v(!1),selectStrategy:async(y,I)=>{try{await c.beginInclusion(y,I),_({type:"waitingForDevice"})}catch{i(a("Failed to start inclusion"),"error")}}};if(m?.type==="chooseReplacementStrategy")return{step:N.SelectReplacementStrategy,onCancel:()=>{v(!1),setTimeout(()=>{_(void 0)},250)},selectStrategy:async y=>{try{await c.replaceFailedNode(m.nodeId,y),_({type:"waitingForDevice"})}catch{i(a("Failed to start replacing the node"),"error")}}};if(!m||m.type==="waitingForDevice")return{step:N.IncludeDevice,onCancel:()=>{v(!1),c.stopInclusion()}};if(m.type==="busy")return{step:N.Busy,onCancel:()=>{}};if(m.type==="validateDSK")return{step:N.ValidateDSK,dsk:m.dsk,setPIN:y=>{c.validateDSK(y)},onCancel:()=>{c.validateDSK(!1)}};if(m.type==="grantSecurityClasses")return{step:N.GrantSecurityClasses,request:m.request,grantSecurityClasses:y=>{c.grantSecurityClasses(y)},onCancel:()=>{c.grantSecurityClasses(!1)}};if(m.type==="done")return{step:N.Result,nodeId:m.nodeId,lowSecurity:m.lowSecurity,securityClass:m.securityClass,onDone:()=>{v(!1),setTimeout(()=>{_(void 0)},250)},onCancel:()=>{v(!1),setTimeout(()=>{_(void 0)},250)}};if(m.type==="exclusionDone")return{step:N.ExclusionResult,nodeId:m.nodeId,onDone:()=>{v(!1),setTimeout(()=>{_(void 0)},250)},onCancel:()=>{v(!1),setTimeout(()=>{_(void 0)},250)}}})(),Y=d||!!m&&!f&&m.type!=="exclusionDone",W=f||!!m&&!d&&m.type!=="done"&&m.type!=="exclusionDone";return!r||!o?ue.default.createElement(Xe,null):t?ue.default.createElement(ue.default.Fragment,null,ue.default.createElement(ta,{state:s?V.Busy:Y?V.Including:W?V.Excluding:h?V.Healing:V.Idle,beginInclusion:()=>v(!0),beginExclusion:async()=>{await g(!0),v(!0)},healNetwork:S,cancelHealing:()=>c.stopHealingNetwork()}),ue.default.createElement(mi,{isBusy:s||h,setBusy:l,devices:A,healingNetwork:h,networkHealProgress:C,replaceFailedNode:B}),R&&ue.default.createElement(Fi,{isOpen:b,...R})):ue.default.createElement(Gi.default,null)};var qr=u(T());function bo(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function xo(e,t,r){e=+e,t=+t,r=(n=arguments.length)<2?(t=e,e=0,1):n<3?1:+r;for(var o=-1,n=Math.max(0,Math.ceil((t-e)/r))|0,a=new Array(n);++o<n;)a[o]=e+o*r;return a}var wo=Math.abs,ze=Math.cos,Le=Math.sin,Li=Math.PI,pt=Li/2,So=Li*2,Co=Math.max,gr=1e-12;function _o(e,t){return Array.from({length:t-e},(r,o)=>e+o)}function ef(e){return function(t,r){return e(t.source.value+t.target.value,r.source.value+r.target.value)}}function Io(){return tf(!1,!1)}function tf(e,t){var r=0,o=null,n=null,a=null;function c(i){var s=i.length,l=new Array(s),d=_o(0,s),f=new Array(s*s),g=new Array(s),h=0,C;i=Float64Array.from({length:s*s},t?(x,m)=>i[m%s][m/s|0]:(x,m)=>i[m/s|0][m%s]);for(let x=0;x<s;++x){let m=0;for(let _=0;_<s;++_)m+=i[x*s+_]+e*i[_*s+x];h+=l[x]=m}h=Co(0,So-r*s)/h,C=h?r:So/s;{let x=0;o&&d.sort((m,_)=>o(l[m],l[_]));for(let m of d){let _=x;if(e){let S=_o(~s+1,s).filter(b=>b<0?i[~b*s+m]:i[m*s+b]);n&&S.sort((b,v)=>n(b<0?-i[~b*s+m]:i[m*s+b],v<0?-i[~v*s+m]:i[m*s+v]));for(let b of S)if(b<0){let v=f[~b*s+m]||(f[~b*s+m]={source:null,target:null});v.target={index:m,startAngle:x,endAngle:x+=i[~b*s+m]*h,value:i[~b*s+m]}}else{let v=f[m*s+b]||(f[m*s+b]={source:null,target:null});v.source={index:m,startAngle:x,endAngle:x+=i[m*s+b]*h,value:i[m*s+b]}}g[m]={index:m,startAngle:_,endAngle:x,value:l[m]}}else{let S=_o(0,s).filter(b=>i[m*s+b]||i[b*s+m]);n&&S.sort((b,v)=>n(i[m*s+b],i[m*s+v]));for(let b of S){let v;if(m<b?(v=f[m*s+b]||(f[m*s+b]={source:null,target:null}),v.source={index:m,startAngle:x,endAngle:x+=i[m*s+b]*h,value:i[m*s+b]}):(v=f[b*s+m]||(f[b*s+m]={source:null,target:null}),v.target={index:m,startAngle:x,endAngle:x+=i[m*s+b]*h,value:i[m*s+b]},m===b&&(v.source=v.target)),v.source&&v.target&&v.source.value<v.target.value){let A=v.source;v.source=v.target,v.target=A}}g[m]={index:m,startAngle:_,endAngle:x,value:l[m]}}x+=C}}return f=Object.values(f),f.groups=g,a?f.sort(a):f}return c.padAngle=function(i){return arguments.length?(r=Co(0,i),c):r},c.sortGroups=function(i){return arguments.length?(o=i,c):o},c.sortSubgroups=function(i){return arguments.length?(n=i,c):n},c.sortChords=function(i){return arguments.length?(i==null?a=null:(a=ef(i))._=i,c):a&&a._},c}var jo=Math.PI,To=2*jo,Re=1e-6,rf=To-Re;function ko(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Ri(){return new ko}ko.prototype=Ri.prototype={constructor:ko,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,r,o){this._+="Q"+ +e+","+ +t+","+(this._x1=+r)+","+(this._y1=+o)},bezierCurveTo:function(e,t,r,o,n,a){this._+="C"+ +e+","+ +t+","+ +r+","+ +o+","+(this._x1=+n)+","+(this._y1=+a)},arcTo:function(e,t,r,o,n){e=+e,t=+t,r=+r,o=+o,n=+n;var a=this._x1,c=this._y1,i=r-e,s=o-t,l=a-e,d=c-t,f=l*l+d*d;if(n<0)throw new Error("negative radius: "+n);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>Re)if(!(Math.abs(d*i-s*l)>Re)||!n)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var g=r-a,h=o-c,C=i*i+s*s,x=g*g+h*h,m=Math.sqrt(C),_=Math.sqrt(f),S=n*Math.tan((jo-Math.acos((C+f-x)/(2*m*_)))/2),b=S/_,v=S/m;Math.abs(b-1)>Re&&(this._+="L"+(e+b*l)+","+(t+b*d)),this._+="A"+n+","+n+",0,0,"+ +(d*g>l*h)+","+(this._x1=e+v*i)+","+(this._y1=t+v*s)}},arc:function(e,t,r,o,n,a){e=+e,t=+t,r=+r,a=!!a;var c=r*Math.cos(o),i=r*Math.sin(o),s=e+c,l=t+i,d=1^a,f=a?o-n:n-o;if(r<0)throw new Error("negative radius: "+r);this._x1===null?this._+="M"+s+","+l:(Math.abs(this._x1-s)>Re||Math.abs(this._y1-l)>Re)&&(this._+="L"+s+","+l),!!r&&(f<0&&(f=f%To+To),f>rf?this._+="A"+r+","+r+",0,1,"+d+","+(e-c)+","+(t-i)+"A"+r+","+r+",0,1,"+d+","+(this._x1=s)+","+(this._y1=l):f>Re&&(this._+="A"+r+","+r+",0,"+ +(f>=jo)+","+d+","+(this._x1=e+r*Math.cos(n))+","+(this._y1=t+r*Math.sin(n))))},rect:function(e,t,r,o){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +r+"v"+ +o+"h"+-r+"Z"},toString:function(){return this._}};var mt=Ri;var Hi=Array.prototype.slice;function Ae(e){return function(){return e}}function of(e){return e.source}function nf(e){return e.target}function Wi(e){return e.radius}function af(e){return e.startAngle}function sf(e){return e.endAngle}function lf(){return 0}function uf(e){var t=of,r=nf,o=Wi,n=Wi,a=af,c=sf,i=lf,s=null;function l(){var d,f=t.apply(this,arguments),g=r.apply(this,arguments),h=i.apply(this,arguments)/2,C=Hi.call(arguments),x=+o.apply(this,(C[0]=f,C)),m=a.apply(this,C)-pt,_=c.apply(this,C)-pt,S=+n.apply(this,(C[0]=g,C)),b=a.apply(this,C)-pt,v=c.apply(this,C)-pt;if(s||(s=d=mt()),h>gr&&(wo(_-m)>h*2+gr?_>m?(m+=h,_-=h):(m-=h,_+=h):m=_=(m+_)/2,wo(v-b)>h*2+gr?v>b?(b+=h,v-=h):(b-=h,v+=h):b=v=(b+v)/2),s.moveTo(x*ze(m),x*Le(m)),s.arc(0,0,x,m,_),m!==b||_!==v)if(e){var A=+e.apply(this,arguments),B=S-A,R=(b+v)/2;s.quadraticCurveTo(0,0,B*ze(b),B*Le(b)),s.lineTo(S*ze(R),S*Le(R)),s.lineTo(B*ze(v),B*Le(v))}else s.quadraticCurveTo(0,0,S*ze(b),S*Le(b)),s.arc(0,0,S,b,v);if(s.quadraticCurveTo(0,0,x*ze(m),x*Le(m)),s.closePath(),d)return s=null,d+""||null}return e&&(l.headRadius=function(d){return arguments.length?(e=typeof d=="function"?d:Ae(+d),l):e}),l.radius=function(d){return arguments.length?(o=n=typeof d=="function"?d:Ae(+d),l):o},l.sourceRadius=function(d){return arguments.length?(o=typeof d=="function"?d:Ae(+d),l):o},l.targetRadius=function(d){return arguments.length?(n=typeof d=="function"?d:Ae(+d),l):n},l.startAngle=function(d){return arguments.length?(a=typeof d=="function"?d:Ae(+d),l):a},l.endAngle=function(d){return arguments.length?(c=typeof d=="function"?d:Ae(+d),l):c},l.padAngle=function(d){return arguments.length?(i=typeof d=="function"?d:Ae(+d),l):i},l.source=function(d){return arguments.length?(t=d,l):t},l.target=function(d){return arguments.length?(r=d,l):r},l.context=function(d){return arguments.length?(s=d??null,l):s},l}function Ao(){return uf()}function $i(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}var Do=Symbol("implicit");function gt(){var e=new Map,t=[],r=[],o=Do;function n(a){var c=a+"",i=e.get(c);if(!i){if(o!==Do)return o;e.set(c,i=t.push(a))}return r[(i-1)%r.length]}return n.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new Map;for(let c of a){let i=c+"";e.has(i)||e.set(i,t.push(c))}return n},n.range=function(a){return arguments.length?(r=Array.from(a),n):r.slice()},n.unknown=function(a){return arguments.length?(o=a,n):o},n.copy=function(){return gt(t,r).unknown(o)},$i.apply(n,arguments),n}function hr(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function qo(e,t){var r=Object.create(e.prototype);for(var o in t)r[o]=t[o];return r}function ht(){}var vt=.7,vr=1/vt,tt="\\s*([+-]?\\d+)\\s*",yt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",he="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",cf=/^#([0-9a-f]{3,8})$/,df=new RegExp("^rgb\\("+[tt,tt,tt]+"\\)$"),ff=new RegExp("^rgb\\("+[he,he,he]+"\\)$"),pf=new RegExp("^rgba\\("+[tt,tt,tt,yt]+"\\)$"),mf=new RegExp("^rgba\\("+[he,he,he,yt]+"\\)$"),gf=new RegExp("^hsl\\("+[yt,he,he]+"\\)$"),hf=new RegExp("^hsla\\("+[yt,he,he,yt]+"\\)$"),Vi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};hr(ht,bt,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:Ui,formatHex:Ui,formatHsl:vf,formatRgb:Ki,toString:Ki});function Ui(){return this.rgb().formatHex()}function vf(){return Ji(this).formatHsl()}function Ki(){return this.rgb().formatRgb()}function bt(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=cf.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?Yi(t):r===3?new se(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?yr(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?yr(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=df.exec(e))?new se(t[1],t[2],t[3],1):(t=ff.exec(e))?new se(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=pf.exec(e))?yr(t[1],t[2],t[3],t[4]):(t=mf.exec(e))?yr(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=gf.exec(e))?Xi(t[1],t[2]/100,t[3]/100,1):(t=hf.exec(e))?Xi(t[1],t[2]/100,t[3]/100,t[4]):Vi.hasOwnProperty(e)?Yi(Vi[e]):e==="transparent"?new se(NaN,NaN,NaN,0):null}function Yi(e){return new se(e>>16&255,e>>8&255,e&255,1)}function yr(e,t,r,o){return o<=0&&(e=t=r=NaN),new se(e,t,r,o)}function yf(e){return e instanceof ht||(e=bt(e)),e?(e=e.rgb(),new se(e.r,e.g,e.b,e.opacity)):new se}function rt(e,t,r,o){return arguments.length===1?yf(e):new se(e,t,r,o??1)}function se(e,t,r,o){this.r=+e,this.g=+t,this.b=+r,this.opacity=+o}hr(se,rt,qo(ht,{brighter:function(e){return e=e==null?vr:Math.pow(vr,e),new se(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?vt:Math.pow(vt,e),new se(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Zi,formatHex:Zi,formatRgb:Qi,toString:Qi}));function Zi(){return"#"+Po(this.r)+Po(this.g)+Po(this.b)}function Qi(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function Po(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function Xi(e,t,r,o){return o<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new ve(e,t,r,o)}function Ji(e){if(e instanceof ve)return new ve(e.h,e.s,e.l,e.opacity);if(e instanceof ht||(e=bt(e)),!e)return new ve;if(e instanceof ve)return e;e=e.rgb();var t=e.r/255,r=e.g/255,o=e.b/255,n=Math.min(t,r,o),a=Math.max(t,r,o),c=NaN,i=a-n,s=(a+n)/2;return i?(t===a?c=(r-o)/i+(r<o)*6:r===a?c=(o-t)/i+2:c=(t-r)/i+4,i/=s<.5?a+n:2-a-n,c*=60):i=s>0&&s<1?0:c,new ve(c,i,s,e.opacity)}function es(e,t,r,o){return arguments.length===1?Ji(e):new ve(e,t,r,o??1)}function ve(e,t,r,o){this.h=+e,this.s=+t,this.l=+r,this.opacity=+o}hr(ve,es,qo(ht,{brighter:function(e){return e=e==null?vr:Math.pow(vr,e),new ve(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?vt:Math.pow(vt,e),new ve(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,o=r+(r<.5?r:1-r)*t,n=2*r-o;return new se(No(e>=240?e-240:e+120,n,o),No(e,n,o),No(e<120?e+240:e-120,n,o),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function No(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}function Mo(e,t,r,o,n){var a=e*e,c=a*e;return((1-3*e+3*a-c)*t+(4-6*a+3*c)*r+(1+3*e+3*a-3*c)*o+c*n)/6}function ts(e){var t=e.length-1;return function(r){var o=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),n=e[o],a=e[o+1],c=o>0?e[o-1]:2*n-a,i=o<t-1?e[o+2]:2*a-n;return Mo((r-o/t)*t,c,n,a,i)}}function rs(e){var t=e.length;return function(r){var o=Math.floor(((r%=1)<0?++r:r)*t),n=e[(o+t-1)%t],a=e[o%t],c=e[(o+1)%t],i=e[(o+2)%t];return Mo((r-o/t)*t,n,a,c,i)}}var Bo=e=>()=>e;function bf(e,t){return function(r){return e+r*t}}function xf(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(o){return Math.pow(e+o*t,r)}}function os(e){return(e=+e)==1?br:function(t,r){return r-t?xf(t,r,e):Bo(isNaN(t)?r:t)}}function br(e,t){var r=t-e;return r?bf(e,r):Bo(isNaN(e)?t:e)}var wf=function e(t){var r=os(t);function o(n,a){var c=r((n=rt(n)).r,(a=rt(a)).r),i=r(n.g,a.g),s=r(n.b,a.b),l=br(n.opacity,a.opacity);return function(d){return n.r=c(d),n.g=i(d),n.b=s(d),n.opacity=l(d),n+""}}return o.gamma=e,o}(1);function ns(e){return function(t){var r=t.length,o=new Array(r),n=new Array(r),a=new Array(r),c,i;for(c=0;c<r;++c)i=rt(t[c]),o[c]=i.r||0,n[c]=i.g||0,a[c]=i.b||0;return o=e(o),n=e(n),a=e(a),i.opacity=1,function(s){return i.r=o(s),i.g=n(s),i.b=a(s),i+""}}}var Oo=ns(ts),Sf=ns(rs);function as(e){for(var t=e.length/6|0,r=new Array(t),o=0;o<t;)r[o]="#"+e.slice(o*6,++o*6);return r}var is=e=>Oo(e[e.length-1]);var xr=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(as),Cf=is(xr);var wr="http://www.w3.org/1999/xhtml",Eo={svg:"http://www.w3.org/2000/svg",xhtml:wr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Sr(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),Eo.hasOwnProperty(t)?{space:Eo[t],local:e}:e}function _f(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===wr&&t.documentElement.namespaceURI===wr?t.createElement(e):t.createElementNS(r,e)}}function If(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Cr(e){var t=Sr(e);return(t.local?If:_f)(t)}function jf(){}function _r(e){return e==null?jf:function(){return this.querySelector(e)}}function ss(e){typeof e!="function"&&(e=_r(e));for(var t=this._groups,r=t.length,o=new Array(r),n=0;n<r;++n)for(var a=t[n],c=a.length,i=o[n]=new Array(c),s,l,d=0;d<c;++d)(s=a[d])&&(l=e.call(s,s.__data__,d,a))&&("__data__"in s&&(l.__data__=s.__data__),i[d]=l);return new H(o,this._parents)}function Ir(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Tf(){return[]}function ls(e){return e==null?Tf:function(){return this.querySelectorAll(e)}}function kf(e){return function(){var t=e.apply(this,arguments);return t==null?[]:Ir(t)}}function us(e){typeof e=="function"?e=kf(e):e=ls(e);for(var t=this._groups,r=t.length,o=[],n=[],a=0;a<r;++a)for(var c=t[a],i=c.length,s,l=0;l<i;++l)(s=c[l])&&(o.push(e.call(s,s.__data__,l,c)),n.push(s));return new H(o,n)}function cs(e){return function(){return this.matches(e)}}function jr(e){return function(t){return t.matches(e)}}var Af=Array.prototype.find;function Df(e){return function(){return Af.call(this.children,e)}}function qf(){return this.firstElementChild}function ds(e){return this.select(e==null?qf:Df(typeof e=="function"?e:jr(e)))}var Pf=Array.prototype.filter;function Nf(){return this.children}function Mf(e){return function(){return Pf.call(this.children,e)}}function fs(e){return this.selectAll(e==null?Nf:Mf(typeof e=="function"?e:jr(e)))}function ps(e){typeof e!="function"&&(e=cs(e));for(var t=this._groups,r=t.length,o=new Array(r),n=0;n<r;++n)for(var a=t[n],c=a.length,i=o[n]=[],s,l=0;l<c;++l)(s=a[l])&&e.call(s,s.__data__,l,a)&&i.push(s);return new H(o,this._parents)}function Tr(e){return new Array(e.length)}function ms(){return new H(this._enter||this._groups.map(Tr),this._parents)}function xt(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}xt.prototype={constructor:xt,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function gs(e){return function(){return e}}function Bf(e,t,r,o,n,a){for(var c=0,i,s=t.length,l=a.length;c<l;++c)(i=t[c])?(i.__data__=a[c],o[c]=i):r[c]=new xt(e,a[c]);for(;c<s;++c)(i=t[c])&&(n[c]=i)}function Of(e,t,r,o,n,a,c){var i,s,l=new Map,d=t.length,f=a.length,g=new Array(d),h;for(i=0;i<d;++i)(s=t[i])&&(g[i]=h=c.call(s,s.__data__,i,t)+"",l.has(h)?n[i]=s:l.set(h,s));for(i=0;i<f;++i)h=c.call(e,a[i],i,a)+"",(s=l.get(h))?(o[i]=s,s.__data__=a[i],l.delete(h)):r[i]=new xt(e,a[i]);for(i=0;i<d;++i)(s=t[i])&&l.get(g[i])===s&&(n[i]=s)}function Ef(e){return e.__data__}function hs(e,t){if(!arguments.length)return Array.from(this,Ef);var r=t?Of:Bf,o=this._parents,n=this._groups;typeof e!="function"&&(e=gs(e));for(var a=n.length,c=new Array(a),i=new Array(a),s=new Array(a),l=0;l<a;++l){var d=o[l],f=n[l],g=f.length,h=Ir(e.call(d,d&&d.__data__,l,o)),C=h.length,x=i[l]=new Array(C),m=c[l]=new Array(C),_=s[l]=new Array(g);r(d,f,x,m,_,h,t);for(var S=0,b=0,v,A;S<C;++S)if(v=x[S]){for(S>=b&&(b=S+1);!(A=m[b])&&++b<C;);v._next=A||null}}return c=new H(c,o),c._enter=i,c._exit=s,c}function vs(){return new H(this._exit||this._groups.map(Tr),this._parents)}function ys(e,t,r){var o=this.enter(),n=this,a=this.exit();return o=typeof e=="function"?e(o):o.append(e+""),t!=null&&(n=t(n)),r==null?a.remove():r(a),o&&n?o.merge(n).order():n}function bs(e){if(!(e instanceof H))throw new Error("invalid merge");for(var t=this._groups,r=e._groups,o=t.length,n=r.length,a=Math.min(o,n),c=new Array(o),i=0;i<a;++i)for(var s=t[i],l=r[i],d=s.length,f=c[i]=new Array(d),g,h=0;h<d;++h)(g=s[h]||l[h])&&(f[h]=g);for(;i<o;++i)c[i]=t[i];return new H(c,this._parents)}function xs(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var o=e[t],n=o.length-1,a=o[n],c;--n>=0;)(c=o[n])&&(a&&c.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(c,a),a=c);return this}function ws(e){e||(e=Ff);function t(f,g){return f&&g?e(f.__data__,g.__data__):!f-!g}for(var r=this._groups,o=r.length,n=new Array(o),a=0;a<o;++a){for(var c=r[a],i=c.length,s=n[a]=new Array(i),l,d=0;d<i;++d)(l=c[d])&&(s[d]=l);s.sort(t)}return new H(n,this._parents).order()}function Ff(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Ss(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Cs(){return Array.from(this)}function _s(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var o=e[t],n=0,a=o.length;n<a;++n){var c=o[n];if(c)return c}return null}function Is(){let e=0;for(let t of this)++e;return e}function js(){return!this.node()}function Ts(e){for(var t=this._groups,r=0,o=t.length;r<o;++r)for(var n=t[r],a=0,c=n.length,i;a<c;++a)(i=n[a])&&e.call(i,i.__data__,a,n);return this}function Gf(e){return function(){this.removeAttribute(e)}}function zf(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Lf(e,t){return function(){this.setAttribute(e,t)}}function Rf(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Hf(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function Wf(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function ks(e,t){var r=Sr(e);if(arguments.length<2){var o=this.node();return r.local?o.getAttributeNS(r.space,r.local):o.getAttribute(r)}return this.each((t==null?r.local?zf:Gf:typeof t=="function"?r.local?Wf:Hf:r.local?Rf:Lf)(r,t))}function kr(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function $f(e){return function(){this.style.removeProperty(e)}}function Vf(e,t,r){return function(){this.style.setProperty(e,t,r)}}function Uf(e,t,r){return function(){var o=t.apply(this,arguments);o==null?this.style.removeProperty(e):this.style.setProperty(e,o,r)}}function As(e,t,r){return arguments.length>1?this.each((t==null?$f:typeof t=="function"?Uf:Vf)(e,t,r??"")):Kf(this.node(),e)}function Kf(e,t){return e.style.getPropertyValue(t)||kr(e).getComputedStyle(e,null).getPropertyValue(t)}function Yf(e){return function(){delete this[e]}}function Zf(e,t){return function(){this[e]=t}}function Qf(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function Ds(e,t){return arguments.length>1?this.each((t==null?Yf:typeof t=="function"?Qf:Zf)(e,t)):this.node()[e]}function qs(e){return e.trim().split(/^|\s+/)}function Fo(e){return e.classList||new Ps(e)}function Ps(e){this._node=e,this._names=qs(e.getAttribute("class")||"")}Ps.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Ns(e,t){for(var r=Fo(e),o=-1,n=t.length;++o<n;)r.add(t[o])}function Ms(e,t){for(var r=Fo(e),o=-1,n=t.length;++o<n;)r.remove(t[o])}function Xf(e){return function(){Ns(this,e)}}function Jf(e){return function(){Ms(this,e)}}function ep(e,t){return function(){(t.apply(this,arguments)?Ns:Ms)(this,e)}}function Bs(e,t){var r=qs(e+"");if(arguments.length<2){for(var o=Fo(this.node()),n=-1,a=r.length;++n<a;)if(!o.contains(r[n]))return!1;return!0}return this.each((typeof t=="function"?ep:t?Xf:Jf)(r,t))}function tp(){this.textContent=""}function rp(e){return function(){this.textContent=e}}function op(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Os(e){return arguments.length?this.each(e==null?tp:(typeof e=="function"?op:rp)(e)):this.node().textContent}function np(){this.innerHTML=""}function ap(e){return function(){this.innerHTML=e}}function ip(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Es(e){return arguments.length?this.each(e==null?np:(typeof e=="function"?ip:ap)(e)):this.node().innerHTML}function sp(){this.nextSibling&&this.parentNode.appendChild(this)}function Fs(){return this.each(sp)}function lp(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Gs(){return this.each(lp)}function zs(e){var t=typeof e=="function"?e:Cr(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function up(){return null}function Ls(e,t){var r=typeof e=="function"?e:Cr(e),o=t==null?up:typeof t=="function"?t:_r(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),o.apply(this,arguments)||null)})}function cp(){var e=this.parentNode;e&&e.removeChild(this)}function Rs(){return this.each(cp)}function dp(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function fp(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Hs(e){return this.select(e?fp:dp)}function Ws(e){return arguments.length?this.property("__data__",e):this.node().__data__}function pp(e){return function(t){e.call(this,t,this.__data__)}}function mp(e){return e.trim().split(/^|\s+/).map(function(t){var r="",o=t.indexOf(".");return o>=0&&(r=t.slice(o+1),t=t.slice(0,o)),{type:t,name:r}})}function gp(e){return function(){var t=this.__on;if(!!t){for(var r=0,o=-1,n=t.length,a;r<n;++r)a=t[r],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.options):t[++o]=a;++o?t.length=o:delete this.__on}}}function hp(e,t,r){return function(){var o=this.__on,n,a=pp(t);if(o){for(var c=0,i=o.length;c<i;++c)if((n=o[c]).type===e.type&&n.name===e.name){this.removeEventListener(n.type,n.listener,n.options),this.addEventListener(n.type,n.listener=a,n.options=r),n.value=t;return}}this.addEventListener(e.type,a,r),n={type:e.type,name:e.name,value:t,listener:a,options:r},o?o.push(n):this.__on=[n]}}function $s(e,t,r){var o=mp(e+""),n,a=o.length,c;if(arguments.length<2){var i=this.node().__on;if(i){for(var s=0,l=i.length,d;s<l;++s)for(n=0,d=i[s];n<a;++n)if((c=o[n]).type===d.type&&c.name===d.name)return d.value}return}for(i=t?hp:gp,n=0;n<a;++n)this.each(i(o[n],t,r));return this}function Vs(e,t,r){var o=kr(e),n=o.CustomEvent;typeof n=="function"?n=new n(t,r):(n=o.document.createEvent("Event"),r?(n.initEvent(t,r.bubbles,r.cancelable),n.detail=r.detail):n.initEvent(t,!1,!1)),e.dispatchEvent(n)}function vp(e,t){return function(){return Vs(this,e,t)}}function yp(e,t){return function(){return Vs(this,e,t.apply(this,arguments))}}function Us(e,t){return this.each((typeof t=="function"?yp:vp)(e,t))}function*Ks(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var o=e[t],n=0,a=o.length,c;n<a;++n)(c=o[n])&&(yield c)}var Go=[null];function H(e,t){this._groups=e,this._parents=t}function bp(){return new H([[document.documentElement]],Go)}function xp(){return this}H.prototype=bp.prototype={constructor:H,select:ss,selectAll:us,selectChild:ds,selectChildren:fs,filter:ps,data:hs,enter:ms,exit:vs,join:ys,merge:bs,selection:xp,order:xs,sort:ws,call:Ss,nodes:Cs,node:_s,size:Is,empty:js,each:Ts,attr:ks,style:As,property:Ds,classed:Bs,text:Os,html:Es,raise:Fs,lower:Gs,append:zs,insert:Ls,remove:Rs,clone:Hs,datum:Ws,on:$s,dispatch:Us,[Symbol.iterator]:Ks};function zo(e){return typeof e=="string"?new H([[document.querySelector(e)]],[document.documentElement]):new H([[e]],Go)}function Ce(e){return function(){return e}}var Lo=Math.abs,X=Math.atan2,De=Math.cos,Ys=Math.max,Ar=Math.min,fe=Math.sin,He=Math.sqrt,te=1e-12,ot=Math.PI,wt=ot/2,Zs=2*ot;function Qs(e){return e>1?0:e<-1?ot:Math.acos(e)}function Ro(e){return e>=1?wt:e<=-1?-wt:Math.asin(e)}function wp(e){return e.innerRadius}function Sp(e){return e.outerRadius}function Cp(e){return e.startAngle}function _p(e){return e.endAngle}function Ip(e){return e&&e.padAngle}function jp(e,t,r,o,n,a,c,i){var s=r-e,l=o-t,d=c-n,f=i-a,g=f*s-d*l;if(!(g*g<te))return g=(d*(t-a)-f*(e-n))/g,[e+g*s,t+g*l]}function Dr(e,t,r,o,n,a,c){var i=e-r,s=t-o,l=(c?a:-a)/He(i*i+s*s),d=l*s,f=-l*i,g=e+d,h=t+f,C=r+d,x=o+f,m=(g+C)/2,_=(h+x)/2,S=C-g,b=x-h,v=S*S+b*b,A=n-a,B=g*x-C*h,R=(b<0?-1:1)*He(Ys(0,A*A*v-B*B)),Y=(B*b-S*R)/v,W=(-B*S-b*R)/v,y=(B*b+S*R)/v,I=(-B*S+b*R)/v,w=Y-m,j=W-_,$=y-m,U=I-_;return w*w+j*j>$*$+U*U&&(Y=y,W=I),{cx:Y,cy:W,x01:-d,y01:-f,x11:Y*(n/A-1),y11:W*(n/A-1)}}function Ho(){var e=wp,t=Sp,r=Ce(0),o=null,n=Cp,a=_p,c=Ip,i=null;function s(){var l,d,f=+e.apply(this,arguments),g=+t.apply(this,arguments),h=n.apply(this,arguments)-wt,C=a.apply(this,arguments)-wt,x=Lo(C-h),m=C>h;if(i||(i=l=mt()),g<f&&(d=g,g=f,f=d),!(g>te))i.moveTo(0,0);else if(x>Zs-te)i.moveTo(g*De(h),g*fe(h)),i.arc(0,0,g,h,C,!m),f>te&&(i.moveTo(f*De(C),f*fe(C)),i.arc(0,0,f,C,h,m));else{var _=h,S=C,b=h,v=C,A=x,B=x,R=c.apply(this,arguments)/2,Y=R>te&&(o?+o.apply(this,arguments):He(f*f+g*g)),W=Ar(Lo(g-f)/2,+r.apply(this,arguments)),y=W,I=W,w,j;if(Y>te){var $=Ro(Y/f*fe(R)),U=Ro(Y/g*fe(R));(A-=$*2)>te?($*=m?1:-1,b+=$,v-=$):(A=0,b=v=(h+C)/2),(B-=U*2)>te?(U*=m?1:-1,_+=U,S-=U):(B=0,_=S=(h+C)/2)}var We=g*De(_),$e=g*fe(_),It=f*De(v),jt=f*fe(v);if(W>te){var Tt=g*De(S),kt=g*fe(S),zr=f*De(b),Lr=f*fe(b),be;if(x<ot&&(be=jp(We,$e,zr,Lr,Tt,kt,It,jt))){var Rr=We-be[0],Hr=$e-be[1],Wr=Tt-be[0],$r=kt-be[1],Ko=1/fe(Qs((Rr*Wr+Hr*$r)/(He(Rr*Rr+Hr*Hr)*He(Wr*Wr+$r*$r)))/2),Yo=He(be[0]*be[0]+be[1]*be[1]);y=Ar(W,(f-Yo)/(Ko-1)),I=Ar(W,(g-Yo)/(Ko+1))}}B>te?I>te?(w=Dr(zr,Lr,We,$e,g,I,m),j=Dr(Tt,kt,It,jt,g,I,m),i.moveTo(w.cx+w.x01,w.cy+w.y01),I<W?i.arc(w.cx,w.cy,I,X(w.y01,w.x01),X(j.y01,j.x01),!m):(i.arc(w.cx,w.cy,I,X(w.y01,w.x01),X(w.y11,w.x11),!m),i.arc(0,0,g,X(w.cy+w.y11,w.cx+w.x11),X(j.cy+j.y11,j.cx+j.x11),!m),i.arc(j.cx,j.cy,I,X(j.y11,j.x11),X(j.y01,j.x01),!m))):(i.moveTo(We,$e),i.arc(0,0,g,_,S,!m)):i.moveTo(We,$e),!(f>te)||!(A>te)?i.lineTo(It,jt):y>te?(w=Dr(It,jt,Tt,kt,f,-y,m),j=Dr(We,$e,zr,Lr,f,-y,m),i.lineTo(w.cx+w.x01,w.cy+w.y01),y<W?i.arc(w.cx,w.cy,y,X(w.y01,w.x01),X(j.y01,j.x01),!m):(i.arc(w.cx,w.cy,y,X(w.y01,w.x01),X(w.y11,w.x11),!m),i.arc(0,0,f,X(w.cy+w.y11,w.cx+w.x11),X(j.cy+j.y11,j.cx+j.x11),m),i.arc(j.cx,j.cy,y,X(j.y11,j.x11),X(j.y01,j.x01),!m))):i.arc(0,0,f,v,b,m)}if(i.closePath(),l)return i=null,l+""||null}return s.centroid=function(){var l=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,d=(+n.apply(this,arguments)+ +a.apply(this,arguments))/2-ot/2;return[De(d)*l,fe(d)*l]},s.innerRadius=function(l){return arguments.length?(e=typeof l=="function"?l:Ce(+l),s):e},s.outerRadius=function(l){return arguments.length?(t=typeof l=="function"?l:Ce(+l),s):t},s.cornerRadius=function(l){return arguments.length?(r=typeof l=="function"?l:Ce(+l),s):r},s.padRadius=function(l){return arguments.length?(o=l==null?null:typeof l=="function"?l:Ce(+l),s):o},s.startAngle=function(l){return arguments.length?(n=typeof l=="function"?l:Ce(+l),s):n},s.endAngle=function(l){return arguments.length?(a=typeof l=="function"?l:Ce(+l),s):a},s.padAngle=function(l){return arguments.length?(c=typeof l=="function"?l:Ce(+l),s):c},s.context=function(l){return arguments.length?(i=l??null,s):i},s}function Xs(e,t){let r=new Array(t.length).fill(0).map(()=>new Array(t.length).fill(0));function o(y,I){y==null||I==null||(r[y][I]=r[I][y]=1)}let n=new Map;for(let y=0;y<t.length;y++)n.set(t[y].id,y);for(let y of t)for(let I of y.neighbors)o(n.get(y.id),n.get(I));let a=y=>y.reduce((I,w)=>I+w,0),c=Math.max(...r.map(a));c===0&&(c=1);let i=new Set;for(let y=0;y<r.length;y++){let I=r[y];a(I)===0?(I[y]=1/c,i.add(t[y].id)):r[y]=I.map(j=>j/c)}let s=1.5,l=a(r[0]);r[0]=r[0].map(y=>y*s/l);let d=a(r.map(a)),f=600,g=600,h=Math.min(f,g)*.5-150,C=h-20,x=Math.min(.15,Math.PI/2/t.length),m=2*Math.PI-t.length*x,_=.5*m*(s/d),S=zo(e).append("svg").attr("preserveAspectRatio","xMidYMid meet").attr("viewBox",`${-f/2} ${-g/2} ${f} ${g}`).append("g").attr("transform",`rotate(-${(_*(180/Math.PI)).toFixed(2)})`),b=Io().padAngle(x).sortChords(bo).sortSubgroups(()=>1)(r),v=Ho().innerRadius(C).outerRadius(h),A=Ao().radius(C),B=gt().domain(xo(t.length-1)).range(xr[Math.max(3,Math.min(11,t.length))]);function R(y){return"linkGrad-"+y.source.index+"-"+y.target.index}let Y=S.append("defs").selectAll("linearGradient").data(b).enter().append("linearGradient").attr("id",R).attr("gradientUnits","userSpaceOnUse").attr("x1",function(y,I){return C*Math.cos((y.source.endAngle-y.source.startAngle)/2+y.source.startAngle-Math.PI/2)}).attr("y1",function(y,I){return C*Math.sin((y.source.endAngle-y.source.startAngle)/2+y.source.startAngle-Math.PI/2)}).attr("x2",function(y,I){return C*Math.cos((y.target.endAngle-y.target.startAngle)/2+y.target.startAngle-Math.PI/2)}).attr("y2",function(y,I){return C*Math.sin((y.target.endAngle-y.target.startAngle)/2+y.target.startAngle-Math.PI/2)});Y.append("stop").attr("offset","0%").attr("stop-color",y=>B(y.source.index)),Y.append("stop").attr("offset","100%").attr("stop-color",y=>B(y.target.index));let W=S.selectAll("g").data(b.groups).enter().append("g").attr("class","node");W.append("path").style("fill",y=>B(y.index)).attr("d",v),W.append("text").each(y=>y.angle=(y.startAngle+y.endAngle)/2).attr("class",(y,I)=>`node-id${i.has(t[I].id)?" disconnected":""}`).attr("text-anchor",y=>y.angle-_>Math.PI?"end":null).attr("dominant-baseline","middle").attr("transform",y=>"rotate("+(y.angle*180/Math.PI-90)+")translate("+(h+10)+")"+(y.angle-_>Math.PI?"rotate(180)":"")).text((y,I)=>`Node ${t[I].id}`),S.datum(b).append("g").selectAll("path").data(y=>y.filter(I=>I.source.index!==I.target.index&&I.source.value>0&&I.target.value>0)).enter().append("path").attr("class",y=>`chord chord-${y.source.index} chord-${y.target.index}`).style("fill",y=>`url(#${R(y)})`).attr("d",A)}var Js=u(K());var el=u(Z()),Tp=(0,el.makeStyles)(e=>({map:{"& text":{fill:e.palette.text.primary}}})),tl=()=>{let{alive:e,connected:t}=(0,Js.useAdapter)(),r=oe(),o=Tp();return qr.default.useEffect(()=>{e&&t&&r.getNetworkMap().then(n=>{Xs("#map",n)}).catch(n=>{console.error(n)})},[e,t,r]),e&&t?qr.default.createElement("div",{id:"map",className:o.map}):qr.default.createElement(Xe,null)};var Fl=u(K()),nt=u(du());var Pr=u(K()),Nr=u(T());var Xy=Nr.default.createContext({devices:{},async updateDevices(){}}),rl=/Node_(\d+)$/,ol=/Node_(\d+)\.ready$/,nl=/Node_(\d+)\.status$/;function al(){let e=(0,Pr.useConnection)(),[t,r]=Nr.default.useState(),{namespace:o}=(0,Pr.useGlobals)(),n=oe(),a=async(l,d)=>{if(!(!l.startsWith(o)||!rl.test(l)))if(d){if(d.type==="device"&&typeof d.native.id=="number"){let f=d.native.id,g={id:l,value:d,status:await n.getNodeStatus(f),ready:await n.getNodeReady(f)};g.ready&&await n.updateEndpointsAndAssociations(f,g),r(h=>({...h,[f]:g}))}}else{let f=parseInt(rl.exec(l)[1],10);r(g=>{let h={...g};return delete h[f],h})}},c=async l=>{let d={};await n.updateEndpointsAndAssociations(l,d),r(f=>{let g=f?.[l];return g?(g.endpoints=d.endpoints,{...f,[l]:g}):f})},i=async(l,d)=>{if(!!l.startsWith(o)&&!(!d||!d.ack)){if(l.match(nl)){let f=parseInt(nl.exec(l)[1],10);r(g=>{let h=g?.[f];return h?(h.status=d.val,{...g,[f]:h}):g})}else if(l.match(ol)){let f=parseInt(ol.exec(l)[1],10);r(g=>{let h=g?.[f];return h?(h.ready=d.val,h.ready&&setTimeout(()=>void c(f),0),{...g,[f]:h}):g})}}};async function s(){r(await n.loadDevices({status:!0,associations:!0,ready:!0}))}return Nr.default.useEffect(()=>((async()=>{await s(),e.subscribeObject(`${o}.Node_*`,a),e.subscribeState(`${o}.Node_*`,i)})(),()=>{e.unsubscribeObject(`${o}.Node_*`,a),e.unsubscribeState(`${o}.Node_*`,i)}),[]),[t,s]}var re=u(T()),jl=u(K());var Tl=u(Z()),kl=u(Dt()),Al=u(rn()),Dl=u(Ur()),ql=u(Ye()),Pl=u(Yr()),Gr=u(Ke()),Nl=u(Kr());var D=u(T()),ul=u(Qo()),cl=u(Zr()),dl=u(K()),fl=u(Vr()),Or=u(Pe()),Er=u(qe()),pl=u(Mt()),ml=u(an()),gl=u(ro()),hl=u(Et()),St=u(Ke()),Wo=u(Ye()),vl=u(Z());function il(e,t){return e.length!==t.length?!1:e.every((r,o)=>r===t[o])}var $o=u(on());var yl=u(sl()),bl=u(ll()),xl=u(Ue()),wl=u(Ve()),Fp=D.default.createElement(yl.default,{fontSize:"small"}),Gp=D.default.createElement(bl.default,{fontSize:"small"}),zp=(0,vl.makeStyles)(e=>({input:{width:"100%",margin:0},cell:{padding:e.spacing(1,2)},cellWithId:{paddingTop:0},idCell:{color:e.palette.text.hint,padding:e.spacing(1,2,0,2),border:0}})),Vo=e=>{let{translate:t}=(0,dl.useI18n)(),[r,o]=D.default.useState(e.name??""),[n,a]=D.default.useState(e.nodeIds??[]),[c,i]=D.default.useState(!1),[s,l]=D.default.useState(!1),[d,f]=D.default.useState(!1);D.default.useEffect(()=>{l(r!==""&&r!==e.name||!il(n,e.nodeIds??[])),i(!!r&&n.length>1)},[r,e.name,n,e.nodeIds]);let g=e.selectableNodes.map(v=>({value:v.value.native.id,label:`${t("Node")} ${(0,cl.padStart)(v.value.native.id.toString(),3,"0")}`})),h=g.filter(v=>n.includes(v.value)),C=e.name==null&&e.nodeIds==null;async function x(){try{f(!0),await e.save(r,n.sort(),e.objectId),C&&m()}catch(v){alert(t("The group could not be saved!")),console.error(`The group could not be saved! Reason: ${de(v)}`),m()}finally{f(!1)}}function m(){o(e.name??""),a(e.nodeIds??[])}async function _(){if(!!e.delete)try{f(!0),await e.delete()}catch(v){alert(t("The group could not be deleted!")),console.error(`The group could not be deleted! Reason: ${de(v)}`),m()}finally{f(!1)}}let S=zp(),b=(0,wl.default)(S.cell,e.objectId?S.cellWithId:void 0);return D.default.createElement(D.default.Fragment,null,!!e.objectId&&D.default.createElement(Wo.default,null,D.default.createElement(St.default,{className:S.idCell,colSpan:3},D.default.createElement(xl.default,{variant:"caption"},"ID: ",e.objectId))),D.default.createElement(Wo.default,null,D.default.createElement(St.default,{className:b},D.default.createElement($o.default,{variant:"outlined",margin:"dense",className:S.input,value:r,placeholder:t("Enter group name"),onChange:v=>o(v.target.value)})),D.default.createElement(St.default,{className:b},D.default.createElement(un,{className:S.input,multiple:!0,size:"small",options:g,disableCloseOnSelect:!0,getOptionLabel:v=>v.label,value:h,onChange:(v,A)=>a(A.map(B=>B.value)),renderOption:(v,{selected:A})=>D.default.createElement(D.default.Fragment,null,D.default.createElement(ul.default,{icon:Fp,checkedIcon:Gp,style:{marginRight:8},checked:A}),v.label),renderInput:v=>D.default.createElement($o.default,{...v,className:S.input,variant:"outlined",placeholder:h.length===0?t("Select nodes"):void 0})})),D.default.createElement(St.default,{className:b},D.default.createElement(fl.default,{variant:"contained",color:"primary",style:{flex:"1 0 auto"}},D.default.createElement(Or.default,{title:t("Save group")},D.default.createElement(Er.default,{disabled:d||!c||!s,onClick:()=>x()},C?D.default.createElement(pl.default,null):D.default.createElement(ml.default,null))),D.default.createElement(Or.default,{title:t("Undo changes")},D.default.createElement(Er.default,{disabled:d||!s,onClick:()=>m()},D.default.createElement(gl.default,null))),!C&&D.default.createElement(Or.default,{title:t("Delete group")},D.default.createElement(Er.default,{disabled:d,onClick:()=>_()},D.default.createElement(hl.default,null)))))))};var Ml=u(qt());var Sl=u(eu()),Fr=u(K()),Ct=u(T()),Uo=/\.Group_([^\.]+)$/;function Cl(e){return e.type!=="device"||!(0,Sl.isArray)(e.native.nodeIds)?!1:e.native.nodeIds.every(t=>typeof t=="number")}function Lp(e){return e.replace(/[ .:,;<>|!"$%&\\/()=?#+'~*]+/gi,"_")}function _l(e){return typeof e.common.name=="string"&&!!e.common.name?e.common.name:e._id.match(Uo)[1]}function Il(){let e=(0,Fr.useConnection)(),[t,r]=Ct.default.useState(),{namespace:o}=(0,Fr.useGlobals)(),n=async(s,l)=>{!s.startsWith(o)||!Uo.test(s)||(l?Cl(l)&&r(d=>({...d,[s]:l})):r(d=>{let f={...d};return delete f[s],f}))};async function a(){let s=await e.getObjectView(`${o}.Group_`,`${o}.Group_\u9999`,"device"),l={};for(let[d,f]of Object.entries(s))!d.startsWith(o)||!Uo.test(d)||!Cl(f)||(l[d]=f);r(l)}let c=Ct.default.useCallback(async(s,l,d)=>{let f=d??`${o}.Group_${Lp(s)}`;await e.setObject(f,{type:"device",common:{name:s},native:{multicast:!0,nodeIds:l}})},[o,e]),i=Ct.default.useCallback(async s=>{await e.delObject(s._id)},[e]);return Ct.default.useEffect(()=>((async()=>{await a(),e.subscribeObject(`${o}.Group_*`,n)})(),()=>{e.unsubscribeObject(`${o}.Group_*`,n)}),[]),{groups:t,saveGroup:c,deleteGroup:i}}var Rp=(0,Tl.makeStyles)(e=>({root:{width:"100%",marginTop:e.spacing(2)},container:{overflowY:"auto"},empty:{textAlign:"center",fontStyle:"italic"}})),Bl=e=>{let t=oe(),r=Rp(),{translate:o}=(0,jl.useI18n)(),{groups:n,saveGroup:a,deleteGroup:c}=Il();if(!e.devices||!n)return re.default.createElement(Ml.default,null);let i=Object.values(e.devices).filter(s=>{let{isControllerNode:l,secure:d}=s.value.native;return!l});return re.default.createElement(re.default.Fragment,null,re.default.createElement(kl.default,{className:r.root,elevation:2},re.default.createElement(Al.default,{className:r.container},re.default.createElement(Dl.default,{style:{tableLayout:"auto"}},re.default.createElement(Pl.default,null,re.default.createElement(ql.default,null,re.default.createElement(Gr.default,{style:{width:"50%"}},o("Group name")),re.default.createElement(Gr.default,{style:{width:"50%"}},o("Nodes")),re.default.createElement(Gr.default,{style:{minWidth:"200px"}}))),re.default.createElement(Nl.default,null,Object.entries(n).map(([s,l])=>re.default.createElement(Vo,{objectId:l._id,key:`group-${s}`,name:_l(l),nodeIds:l.native.nodeIds,selectableNodes:i,save:a,delete:()=>c(l)})),re.default.createElement(Vo,{name:void 0,nodeIds:void 0,selectableNodes:i,save:a}))))))};function _t({error:e,resetErrorBoundary:t}){return q.default.createElement("div",{role:"alert"},q.default.createElement("p",null,"Something went wrong:"),q.default.createElement("pre",null,e.stack),q.default.createElement("button",{onClick:t},"Try again"))}var Hp={en:tu(),de:ru(),ru:ou(),pt:nu(),nl:au(),fr:iu(),it:su(),es:lu(),pl:uu(),"zh-cn":cu()},Wp=q.default.memo(()=>{let[e,t]=q.default.useState(1),{translate:r}=(0,Fl.useI18n)(),o=(c,i)=>{t(i)},[n,a]=al();return q.default.createElement(q.default.Fragment,null,q.default.createElement(ye.AppBar,{position:"static"},q.default.createElement(ye.Tabs,{value:e,onChange:o},q.default.createElement(ye.Tab,{label:r("Devices")}),q.default.createElement(ye.Tab,{label:r("Groups")}),q.default.createElement(ye.Tab,{label:r("Associations")}),q.default.createElement(ye.Tab,{label:r("Z-Wave Logs")}),q.default.createElement(ye.Tab,{label:r("Network map")}))),q.default.createElement(Ze,{value:e,index:0},q.default.createElement(nt.ErrorBoundary,{FallbackComponent:_t},q.default.createElement(zi,{devices:n}))),q.default.createElement(Ze,{value:e,index:1},q.default.createElement(nt.ErrorBoundary,{FallbackComponent:_t},q.default.createElement(Bl,{devices:n}))),q.default.createElement(Ze,{value:e,index:2},q.default.createElement(nt.ErrorBoundary,{FallbackComponent:_t},q.default.createElement(Vn,{devices:n,updateDevices:a}))),q.default.createElement(Ze,{value:e,index:3},q.default.createElement(nt.ErrorBoundary,{FallbackComponent:_t},q.default.createElement(cn,null))),q.default.createElement(Ze,{value:e,index:4},q.default.createElement(nt.ErrorBoundary,{FallbackComponent:_t},q.default.createElement(tl,null))))});Ol.default.render(q.default.createElement(El.IoBrokerApp,{name:"zwave2",translations:Hp},q.default.createElement(Wp,null)),document.getElementById("root"));
//# sourceMappingURL=tab.js.map
