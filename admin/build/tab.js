import{a as zo,b as Ho}from"./chunk-UQDZ46IZ.js";import{a as bl,b as It,c as xl,d as Go}from"./chunk-ML7PQ6ZG.js";import{$ as Mr,B as Zs,D as Qs,E as Xs,G as Js,H as Eo,I as Oo,J as _t,K as el,L as Fo,M as Ct,N as tl,O as Ge,P as Ro,Q as rl,R as ol,S as z,T as nl,U as al,V as il,W as Lo,X as sl,Y as ll,Z as K,a as E,b as c,ba as we,c as j,ca as ae,d as Ws,da as ul,e as R,ea as cl,f as L,fa as dl,g as St,ga as fl,h as $s,ha as pl,i as Qe,ia as ml,j as X,ja as gl,k as Xe,ka as hl,l as Vs,la as vl,m as Pr,ma as yl,n as ko,o as Us,p as Je,q as He,r as To,s as Ks,u as Nr,v as Po,w as No,x as Mo,y as Bo,z as Ys}from"./chunk-6AV6CKKA.js";var Vo=E(te=>{"use strict";var Sl=te&&te.__createBinding||(Object.create?function(e,t,r,o){o===void 0&&(o=r),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,o){o===void 0&&(o=r),e[o]=t[r]}),_l=te&&te.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Cl=te&&te.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Sl(t,e,r);return _l(t,e),t},Il=te&&te.__rest||function(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(r[o[n]]=e[o[n]]);return r},Er=te&&te.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(te,"__esModule",{value:!0});te.Dropdown=void 0;var Or=Er(Qs()),Al=Er(Xs()),jl=Er(Js()),tt=Cl(j()),Dl=e=>{let{options:t,selectedOption:r,noOptionsMessage:o,placeholder:n}=e,a=Il(e,["options","selectedOption","noOptionsMessage","placeholder"]),i=!(!!t&&t.length)&&!!o,s;return(t==null?void 0:t.length)&&(s=r),tt.createElement(jl.default,Object.assign({value:s??"",displayEmpty:!0,input:tt.createElement(Al.default,{labelWidth:0}),margin:"dense"},a),tt.createElement(Or.default,{value:"",disabled:!0},n??""),t&&t.length&&t.map(({value:l,label:f})=>tt.createElement(Or.default,{key:l,value:l},f)),i&&tt.createElement(Or.default,{key:"__empty",value:"__empty",disabled:!0},o))};te.Dropdown=Dl});var Fr=E(ce=>{"use strict";var ql=ce&&ce.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ce,"__esModule",{value:!0});ce.ModalDialog=ce.Loader=ce.Dropdown=void 0;var kl=Vo();Object.defineProperty(ce,"Dropdown",{enumerable:!0,get:function(){return kl.Dropdown}});var Tl=rl();Object.defineProperty(ce,"Loader",{enumerable:!0,get:function(){return ql(Tl).default}});var Pl=ol();Object.defineProperty(ce,"ModalDialog",{enumerable:!0,get:function(){return Pl.ModalDialog}})});var Rr=E(At=>{"use strict";var Nl=L(),Ml=R();Object.defineProperty(At,"__esModule",{value:!0});At.default=void 0;var Bl=Ml(j()),El=Nl(z()),Ol=(0,El.default)(Bl.createElement("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add");At.default=Ol});var Uo=E(jt=>{"use strict";var Fl=L(),Rl=R();Object.defineProperty(jt,"__esModule",{value:!0});jt.default=void 0;var Ll=Rl(j()),zl=Fl(z()),Hl=(0,zl.default)(Ll.createElement("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"}),"Restore");jt.default=Hl});var Lr=E(Dt=>{"use strict";var Gl=L(),Wl=R();Object.defineProperty(Dt,"__esModule",{value:!0});Dt.default=void 0;var $l=Wl(j()),Vl=Gl(z()),Ul=(0,Vl.default)($l.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}),"DeleteForever");Dt.default=Ul});var on=E(Pt=>{"use strict";var Yl=L(),Zl=R();Object.defineProperty(Pt,"__esModule",{value:!0});Pt.default=void 0;var Ql=Zl(j()),Xl=Yl(z()),Jl=(0,Xl.default)(Ql.createElement("path",{d:"M1 9l2 2c4.97-4.97 13.03-4.97 18 0l2-2C16.93 2.93 7.08 2.93 1 9zm8 8l3 3 3-3c-1.65-1.66-4.34-1.66-6 0zm-4-4l2 2c2.76-2.76 7.24-2.76 10 0l2-2C15.14 9.14 8.87 9.14 5 13z"}),"Wifi");Pt.default=Jl});var nn=E(Nt=>{"use strict";var eu=L(),tu=R();Object.defineProperty(Nt,"__esModule",{value:!0});Nt.default=void 0;var ru=tu(j()),ou=eu(z()),nu=(0,ou.default)(ru.createElement("path",{d:"M22.99 9C19.15 5.16 13.8 3.76 8.84 4.78l2.52 2.52c3.47-.17 6.99 1.05 9.63 3.7l2-2zm-4 4c-1.29-1.29-2.84-2.13-4.49-2.56l3.53 3.53.96-.97zM2 3.05L5.07 6.1C3.6 6.82 2.22 7.78 1 9l1.99 2c1.24-1.24 2.67-2.16 4.2-2.77l2.24 2.24C7.81 10.89 6.27 11.73 5 13v.01L6.99 15c1.36-1.36 3.14-2.04 4.92-2.06L18.98 20l1.27-1.26L3.29 1.79 2 3.05zM9 17l3 3 3-3c-1.65-1.66-4.34-1.66-6 0z"}),"WifiOff");Nt.default=nu});var an=E(Mt=>{"use strict";var au=L(),iu=R();Object.defineProperty(Mt,"__esModule",{value:!0});Mt.default=void 0;var su=iu(j()),lu=au(z()),uu=(0,lu.default)(su.createElement("path",{d:"M17 1H7c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-2-2-2zm0 18H7V5h10v14zM12 6.72c-1.96 0-3.5 1.52-3.5 3.47h1.75c0-.93.82-1.75 1.75-1.75s1.75.82 1.75 1.75c0 1.75-2.63 1.57-2.63 4.45h1.76c0-1.96 2.62-2.19 2.62-4.45 0-1.96-1.54-3.47-3.5-3.47zm-.88 8.8h1.76v1.76h-1.76z"}),"DeviceUnknown");Mt.default=uu});var sn=E(Bt=>{"use strict";var cu=L(),du=R();Object.defineProperty(Bt,"__esModule",{value:!0});Bt.default=void 0;var fu=du(j()),pu=cu(z()),mu=(0,pu.default)(fu.createElement("path",{d:"M13 3h-2v10h2V3zm4.83 2.17l-1.42 1.42C17.99 7.86 19 9.81 19 12c0 3.87-3.13 7-7 7s-7-3.13-7-7c0-2.19 1.01-4.14 2.58-5.42L6.17 5.17C4.23 6.82 3 9.26 3 12c0 4.97 4.03 9 9 9s9-4.03 9-9c0-2.74-1.23-5.18-3.17-6.83z"}),"PowerSettingsNew");Bt.default=mu});var Dn=E(Ft=>{"use strict";var yu=L(),bu=R();Object.defineProperty(Ft,"__esModule",{value:!0});Ft.default=void 0;var xu=bu(j()),wu=yu(z()),Su=(0,wu.default)(xu.createElement("path",{d:"M19 13H5v-2h14v2z"}),"Remove");Ft.default=Su});var qn=E(Rt=>{"use strict";var _u=L(),Cu=R();Object.defineProperty(Rt,"__esModule",{value:!0});Rt.default=void 0;var Iu=Cu(j()),Au=_u(z()),ju=(0,Au.default)(Iu.createElement("path",{d:"M15.9 5c-.17 0-.32.09-.41.23l-.07.15-5.18 11.65c-.16.29-.26.61-.26.96 0 1.11.9 2.01 2.01 2.01.96 0 1.77-.68 1.96-1.59l.01-.03L16.4 5.5c0-.28-.22-.5-.5-.5zM1 9l2 2c2.88-2.88 6.79-4.08 10.53-3.62l1.19-2.68C9.89 3.84 4.74 5.27 1 9zm20 2l2-2c-1.64-1.64-3.55-2.82-5.59-3.57l-.53 2.82c1.5.62 2.9 1.53 4.12 2.75zm-4 4l2-2c-.8-.8-1.7-1.42-2.66-1.89l-.55 2.92c.42.27.83.59 1.21.97zM5 13l2 2c1.13-1.13 2.56-1.79 4.03-2l1.28-2.88c-2.63-.08-5.3.87-7.31 2.88z"}),"NetworkCheck");Rt.default=ju});var On=E(zt=>{"use strict";var qu=L(),ku=R();Object.defineProperty(zt,"__esModule",{value:!0});zt.default=void 0;var Tu=ku(j()),Pu=qu(z()),Nu=(0,Pu.default)(Tu.createElement("path",{d:"M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"}),"Done");zt.default=Nu});var Fn=E(Ht=>{"use strict";var Mu=L(),Bu=R();Object.defineProperty(Ht,"__esModule",{value:!0});Ht.default=void 0;var Eu=Bu(j()),Ou=Mu(z()),Fu=(0,Ou.default)(Eu.createElement("path",{d:"M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z"}),"Redo");Ht.default=Fu});var Rn=E(Gt=>{"use strict";var Ru=L(),Lu=R();Object.defineProperty(Gt,"__esModule",{value:!0});Gt.default=void 0;var zu=Lu(j()),Hu=Ru(z()),Gu=(0,Hu.default)(zu.createElement("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline");Gt.default=Gu});var Ln=E(Wt=>{"use strict";var Wu=L(),$u=R();Object.defineProperty(Wt,"__esModule",{value:!0});Wt.default=void 0;var Vu=$u(j()),Uu=Wu(z()),Ku=(0,Uu.default)(Vu.createElement("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"}),"Autorenew");Wt.default=Ku});var Kn=E($t=>{"use strict";var Zu=L(),Qu=R();Object.defineProperty($t,"__esModule",{value:!0});$t.default=void 0;var Xu=Qu(j()),Ju=Zu(z()),ec=(0,Ju.default)(Xu.createElement("path",{d:"M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"}),"KeyboardArrowDown");$t.default=ec});var Yn=E(Vt=>{"use strict";var tc=L(),rc=R();Object.defineProperty(Vt,"__esModule",{value:!0});Vt.default=void 0;var oc=rc(j()),nc=tc(z()),ac=(0,nc.default)(oc.createElement("path",{d:"M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"}),"KeyboardArrowUp");Vt.default=ac});var Zn=E(Ut=>{"use strict";var ic=L(),sc=R();Object.defineProperty(Ut,"__esModule",{value:!0});Ut.default=void 0;var lc=sc(j()),uc=ic(z()),cc=(0,uc.default)(lc.createElement("path",{d:"M5 4v2h14V4H5zm0 10h4v6h6v-6h4l-7-7-7 7z"}),"Publish");Ut.default=cc});var Vr=E(Kt=>{"use strict";var dc=L(),fc=R();Object.defineProperty(Kt,"__esModule",{value:!0});Kt.default=void 0;var pc=fc(j()),mc=dc(z()),gc=(0,mc.default)(pc.createElement("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm-2 16c-2.05 0-3.81-1.24-4.58-3h1.71c.63.9 1.68 1.5 2.87 1.5 1.93 0 3.5-1.57 3.5-3.5S13.93 9.5 12 9.5c-1.35 0-2.52.78-3.1 1.9l1.6 1.6h-4V9l1.3 1.3C8.69 8.92 10.23 8 12 8c2.76 0 5 2.24 5 5s-2.24 5-5 5z"}),"RestorePage");Kt.default=gc});var Qn=E(Yt=>{"use strict";var hc=L(),vc=R();Object.defineProperty(Yt,"__esModule",{value:!0});Yt.default=void 0;var yc=vc(j()),bc=hc(z()),xc=(0,bc.default)(yc.createElement("path",{d:"M15 9H9v6h6V9zm-2 4h-2v-2h2v2zm8-2V9h-2V7c0-1.1-.9-2-2-2h-2V3h-2v2h-2V3H9v2H7c-1.1 0-2 .9-2 2v2H3v2h2v2H3v2h2v2c0 1.1.9 2 2 2h2v2h2v-2h2v2h2v-2h2c1.1 0 2-.9 2-2v-2h2v-2h-2v-2h2zm-4 6H7V7h10v10z"}),"Memory");Yt.default=xc});var Xn=E(Zt=>{"use strict";var wc=L(),Sc=R();Object.defineProperty(Zt,"__esModule",{value:!0});Zt.default=void 0;var _c=Sc(j()),Cc=wc(z()),Ic=(0,Cc.default)(_c.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9zm7.5-5l-1-1h-5l-1 1H5v2h14V4z"}),"DeleteOutline");Zt.default=Ic});var Jn=E(Qt=>{"use strict";var Ac=L(),jc=R();Object.defineProperty(Qt,"__esModule",{value:!0});Qt.default=void 0;var Dc=jc(j()),qc=Ac(z()),kc=(0,qc.default)(Dc.createElement("path",{d:"M6.99 11L3 15l3.99 4v-3H14v-2H6.99v-3zM21 9l-3.99-4v3H10v2h7.01v3L21 9z"}),"SwapHoriz");Qt.default=kc});var ca=E(er=>{"use strict";var Pc=L(),Nc=R();Object.defineProperty(er,"__esModule",{value:!0});er.default=void 0;var Mc=Nc(j()),Bc=Pc(z()),Ec=(0,Bc.default)(Mc.createElement("path",{d:"M21 21.78L4.22 5 3 6.22l2.04 2.04C4.42 8.6 4 9.25 4 10v10c0 1.1.9 2 2 2h12c.23 0 .45-.05.66-.12L19.78 23 21 21.78zM8.9 6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1v2H9.66L20 18.34V10c0-1.1-.9-2-2-2h-1V6c0-2.76-2.24-5-5-5-2.56 0-4.64 1.93-4.94 4.4L8.9 7.24V6z"}),"NoEncryption");er.default=Ec});var ya=E(tr=>{"use strict";var Rc=L(),Lc=R();Object.defineProperty(tr,"__esModule",{value:!0});tr.default=void 0;var zc=Lc(j()),Hc=Rc(z()),Gc=(0,Hc.default)(zc.createElement("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"}),"Home");tr.default=Gc});var ba=E(rr=>{"use strict";var Wc=L(),$c=R();Object.defineProperty(rr,"__esModule",{value:!0});rr.default=void 0;var Vc=$c(j()),Uc=Wc(z()),Kc=(0,Uc.default)(Vc.createElement("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2H4.26zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56zm2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8zM12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96zM14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2zm.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56zM16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2h-3.38z"}),"Language");rr.default=Kc});var xe=c(Ro()),P=c(j()),zs=c(Ws()),Hs=c(ll());var Wo=c(Us()),$o=c(X()),Br=c(j()),wl=(0,$o.makeStyles)(e=>({tabpanel:{flex:1,position:"relative","& > *":{width:"100%",height:"100%"}}})),et=e=>{let{children:t,value:r,index:o,...n}=e,a=wl();return Br.default.createElement("div",{className:a.tabpanel,role:"tabpanel",hidden:r!==o,...n},r===o&&Br.default.createElement(Wo.default,{p:3},t))};var qe=c(j());var vn=c(Lo()),M=c(j());var k=c(j()),Ko=c(Lo()),Yo=c(K()),rt=c(Fr()),Zo=c(To()),qt=c(Ge()),kt=c(He()),Qo=c(Rr()),Xo=c(sl()),Jo=c(Uo()),en=c(Lr()),tn=c(_t()),rn=c(Ct()),Tt=c(X());var Kl=(0,Tt.makeStyles)(e=>({dropdown:{width:"100%"}})),ot=(0,Tt.styled)(tn.default)(({theme:e})=>({padding:e.spacing(1)})),zr=e=>{let{translate:t}=(0,Yo.useI18n)(),[r,o]=k.default.useState(e.sourceEndpoint),[n,a]=k.default.useState(e.group),[u,i]=k.default.useState(e.nodeId),[s,l]=k.default.useState(e.endpoint),[f,p]=k.default.useState(!1),[g,h]=k.default.useState(!1),[S,x]=k.default.useState(!1),m=r!=null&&e.groups.get(r)||[];k.default.useEffect(()=>{h(r!==e.sourceEndpoint||n!==e.group||u!==e.nodeId||s!==e.endpoint);let b=!!m.find(V=>V.group===n),A=e.nodes.find(V=>V.nodeId===u),W=A?.endpointIndizes??[];p(b&&!!A&&(s==null||s===0||W.includes(s)))},[n,m,u,s]);let _=m.map(({group:b,label:A})=>({value:b,label:`${t("Group")} ${b}: ${A}`})),C=e.nodes.map(({nodeId:b})=>({value:b,label:`${t("Node")} ${(0,Ko.padStart)(b.toString(),3,"0")}`})),y=k.default.useMemo(()=>{let b=[{value:0,label:t("Root device")}];for(let A of e.endpoints)A!==0&&b.push({value:A,label:`${t("Endpoint")} ${A}`});return b},[e.endpoints]),w=k.default.useMemo(()=>{let b=e.nodes.find(W=>W.nodeId===u)?.endpointIndizes??[];if(b.includes(0)||b.unshift(0),!!m.find(W=>W.group===n)?.multiChannel){let W=[{value:"none",label:t("Root device")}];for(let V of b)W.push({value:V,label:V===0?t("Root endpoint"):`${t("Endpoint")} ${V}`});return W}else return[]},[e.nodes,m,n,u]),q=e.sourceEndpoint==null&&e.group==null&&e.nodeId==null&&e.endpoint==null;async function B(){try{x(!0),await e.save(r,n,u,s),q&&F()}catch(b){alert(t("The association could not be saved!")),console.error(`The association could not be saved! Reason: ${we(b)}`),F()}finally{x(!1)}}function F(){o(e.sourceEndpoint),a(e.group),i(e.nodeId),l(e.endpoint)}async function U(){if(!!e.delete)try{x(!0),await e.delete()}catch(b){alert(t("The association could not be deleted!")),console.error(`The association could not be deleted! Reason: ${we(b)}`),F()}finally{x(!1)}}let G=m.find(b=>b.group===n),v=m.some(b=>b.multiChannel),I=Kl();return k.default.createElement(rn.default,null,k.default.createElement(ot,null,k.default.createElement(rt.Dropdown,{className:I.dropdown,options:y,selectedOption:r??"",placeholder:t("- select endpoint -"),onChange:b=>{o(b.target.value)}})),k.default.createElement(ot,null,k.default.createElement(rt.Dropdown,{className:I.dropdown,options:_,selectedOption:n,placeholder:t("- select group -"),onChange:b=>{a(b.target.value)}})),k.default.createElement(ot,null,k.default.createElement(rt.Dropdown,{className:I.dropdown,options:C,selectedOption:u,placeholder:t("- select node -"),onChange:b=>{i(b.target.value)}})),e.supportsMultiChannel&&k.default.createElement(ot,null,G?.multiChannel&&v&&k.default.createElement(rt.Dropdown,{className:I.dropdown,options:w,selectedOption:s??"none",placeholder:t("- select endpoint -"),onChange:b=>{let A=b.target.value;l(A==="none"?void 0:A)}})),k.default.createElement(ot,null,k.default.createElement(Zo.default,{variant:"contained",color:"primary",style:{flex:"1 0 auto"}},k.default.createElement(qt.default,{title:t("Save association")},k.default.createElement(kt.default,{disabled:S||!f||!g,onClick:()=>B()},q?k.default.createElement(Qo.default,null):k.default.createElement(Xo.default,null))),k.default.createElement(qt.default,{title:t("Undo changes")},k.default.createElement(kt.default,{disabled:S||!g,onClick:()=>F()},k.default.createElement(Jo.default,null))),!q&&k.default.createElement(qt.default,{title:t("Delete association")},k.default.createElement(kt.default,{disabled:S,onClick:()=>U()},k.default.createElement(en.default,null))))))};var he=c(j()),ln=c(K()),nt=c(Ge()),We=c(St()),un=c(X()),cn=c(on()),dn=c(nn()),fn=c(an()),pn=c(sn()),gu=(0,un.makeStyles)(e=>({deviceIconAlive:{color:We.green[800]},deviceIconAsleep:{color:We.lightBlue[500]},deviceIconDead:{color:We.red[900]}})),Et=e=>{let{status:t}=e,{translate:r}=(0,ln.useI18n)(),o=gu(),n=r(t??"unknown");switch(t){case"alive":case"awake":return he.default.createElement(nt.default,{title:n},he.default.createElement(cn.default,{className:o.deviceIconAlive}));case"asleep":return he.default.createElement(nt.default,{title:n},he.default.createElement(pn.default,{className:o.deviceIconAsleep}));case"dead":return he.default.createElement(nt.default,{title:n},he.default.createElement(dn.default,{className:o.deviceIconDead}));default:return he.default.createElement(nt.default,{title:n},he.default.createElement(fn.default,null))}};var at=c(j()),Ot=c(K()),mn=c(Je()),Hr=e=>at.default.createElement(mn.default,{variant:"body1",style:{textAlign:"center"}},e.children),$e=()=>{let{translate:e}=(0,Ot.useI18n)();return at.default.createElement(Hr,null,e("adapter not ready"))},gn=()=>{let{translate:e}=(0,Ot.useI18n)();return at.default.createElement(Hr,null,e("No devices present"))},hn=()=>{let{translate:e}=(0,Ot.useI18n)();return at.default.createElement(Hr,null,e("Node is not ready"))};var Gr=c(K()),yn=c(Oo()),Ve=c(_t()),bn=c(Fo()),xn=c(Ct()),wn=c(Eo()),Sn=c(Pr()),_n=c(X()),Wr=c(Je()),$r=(0,_n.makeStyles)(e=>({headline:{backgroundColor:e.palette.background.default,margin:e.spacing(-2),marginBottom:e.spacing(2),borderBottom:`1px solid ${e.palette.divider}`,padding:e.spacing(2)},table:{marginTop:e.spacing(-2)},nodeNumber:{"& > *":{verticalAlign:"middle"}},paper:{padding:e.spacing(2),backgroundColor:e.palette.background.paper,marginTop:e.spacing(4),"&:first-child":{margin:0}}}));function hu(e){let{translate:t}=(0,Gr.useI18n)(),{value:r,status:o}=e.device,n=r.native.id,a=r.common.name&&!r.common.name.startsWith("Node")?r.common.name:void 0,u=$r();return M.default.createElement("div",{className:u.headline},M.default.createElement(Wr.default,{variant:"h5",component:"h2",className:u.nodeNumber},M.default.createElement("span",null,t("Node")," ",(0,vn.padStart)(n.toString(),3,"0")),"\xA0",M.default.createElement(Et,{status:o})),a&&M.default.createElement(Wr.default,{variant:"h6",component:"h3"},a))}function vu(e){let{translate:t}=(0,Gr.useI18n)(),{endpoints:r,value:o}=e.device,n=o.native.id,{sourceEndpoints:a,groups:u,supportsMultiChannel:i,hasAssociations:s,associations:l}=M.default.useMemo(()=>{let p=[],g=!1,h=!1,S=new Map,x=[];if(r){for(let[m,_]of r)_.associationGroups?(h||=Object.values(_.associationGroups).some(C=>!!C.multiChannel),S.set(m,Object.entries(_.associationGroups).map(([C,y])=>({group:parseInt(C),...y})))):S.set(m,[]),_.associations&&(p.push(...Object.entries(_.associations).map(([C,y])=>y.map(w=>({sourceEndpoint:m,group:parseInt(C),...w}))).reduce((C,y)=>[...C,...y],[]).sort((C,y)=>C.group-y.group||C.nodeId-y.nodeId||(C.endpoint??-1)-(y.endpoint??-1))),g||=Object.keys(_.associations).length>0);h&&x.push(0),x.push(...r.keys())}return{sourceEndpoints:x,groups:S,supportsMultiChannel:h,hasAssociations:g,associations:p}},[r]),f=$r();return M.default.createElement(wn.default,{className:f.table},M.default.createElement(bn.default,null,M.default.createElement(xn.default,null,M.default.createElement(Ve.default,null,t("Source endpoint")),M.default.createElement(Ve.default,null,t("Group")),M.default.createElement(Ve.default,null,t("Target node")),i&&M.default.createElement(Ve.default,null,t("Target endpoint")),M.default.createElement(Ve.default,null,"\xA0"))),M.default.createElement(yn.default,null,s?l.map(p=>M.default.createElement(zr,{key:`from${n}${p.sourceEndpoint??-1}-to${p.group}-${p.nodeId}-${p.endpoint??-1}`,endpoints:a??[],groups:u,nodes:e.nodes.filter(g=>g.nodeId!==n),sourceEndpoint:p.sourceEndpoint??0,group:p.group,nodeId:p.nodeId,endpoint:p.endpoint,supportsMultiChannel:i,save:(g,h,S,x)=>e.saveAssociation(n,p,{sourceEndpoint:g,group:h,nodeId:S,endpoint:x}),delete:()=>e.deleteAssociation(n,p)})):M.default.createElement(M.default.Fragment,null),M.default.createElement(zr,{endpoints:a??[],groups:u,nodes:e.nodes.filter(p=>p.nodeId!==n),sourceEndpoint:void 0,group:void 0,nodeId:void 0,supportsMultiChannel:i,save:(p,g,h,S)=>e.saveAssociation(n,void 0,{sourceEndpoint:p,group:g,nodeId:h,endpoint:S})})))}var Cn=e=>{let{ready:t,endpoints:r}=e.device,o=!!r&&[...r.values()].some(a=>!!a.associationGroups),n=$r();return t&&!o?M.default.createElement(M.default.Fragment,null):M.default.createElement(Sn.default,{className:n.paper,elevation:2},M.default.createElement(hu,{device:e.device}),t?M.default.createElement(vu,{...e}):M.default.createElement(hn,null))};var In=c(K());var An=c(Nr()),jn=e=>{let{alive:t,connected:r}=(0,In.useAdapter)(),o=ae(),{devices:n,updateDevices:a}=e;async function u(p,g,h){g&&await i(p,g),await o.addAssociation(p,h),await a()}async function i(p,g){await o.removeAssociation(p,g),await a()}let s=n?Object.values(n).filter(Boolean):[],l=s.map(p=>({nodeId:p.value.native.id,endpointIndizes:p.value.native.endpointIndizes})),f=s.filter(p=>!p.value.native.isControllerNode);return!t||!r?qe.default.createElement($e,null):n?f.length?qe.default.createElement(qe.default.Fragment,null,f.map((p,g)=>qe.default.createElement(Cn,{key:g,device:p,nodes:l,saveAssociation:u,deleteAssociation:i}))):qe.default.createElement(gn,null):qe.default.createElement(An.default,null)};var se=c(j());var le=c(K());var Lt=c(He()),Se=c(j()),kn=c(Rr()),Tn=c(Dn()),Pn=c(qn()),Nn=c(K()),Mn=c(X()),Bn=c(Qe()),$;(function(a){a[a.Idle=0]="Idle",a[a.Including=1]="Including",a[a.Excluding=2]="Excluding",a[a.Healing=3]="Healing",a[a.Busy=4]="Busy"})($||($={}));var Du=(0,Mn.makeStyles)(e=>({root:{display:"flex",flexDirection:"row",gap:e.spacing(1)},redButton:{background:e.palette.error.main,"&:hover":{background:e.palette.error.dark}}})),En=e=>{let{translate:t}=(0,Nn.useI18n)(),r=Du();return Se.default.createElement("div",{className:r.root},Se.default.createElement(Lt.default,{variant:"contained",color:e.state===1?"secondary":"primary",startIcon:Se.default.createElement(kn.default,null),disabled:e.state!==0&&e.state!==1,onClick:e.beginInclusion},e.state!==1?t("Include device"):t("Inclusion active")),Se.default.createElement(Lt.default,{variant:"contained",color:e.state===2?"secondary":"primary",startIcon:Se.default.createElement(Tn.default,null),disabled:e.state!==0&&e.state!==2,onClick:e.beginExclusion},e.state!==2?t("Exclude device"):t("Exclusion active")),Se.default.createElement(Lt.default,{variant:"contained",color:"primary",className:(0,Bn.default)(e.state===3&&r.redButton),startIcon:Se.default.createElement(Pn.default,null),disabled:e.state!==0&&e.state!==3,onClick:e.state!==3?e.healNetwork:e.cancelHealing},e.state!==3?t("Heal network"):t("Cancel healing")))};var J=c(j()),Ha=c(K()),Ga=c(X()),Wa=c(Pr()),$a=c(Eo()),Va=c(Oo()),Pe=c(_t()),Ua=c(el()),Ka=c(Fo()),Qr=c(Ct());var N=c(j()),Te=c(_t()),Zr=c(Ct());var ve=c(j()),zn=c(K()),Hn=c(On()),Gn=c(Fn()),Wn=c(Rn()),$n=c(Ln()),it=c(Ge()),_e=c(St()),Vn=c(X()),Yu=(0,Vn.makeStyles)(e=>({healIconPending:{color:_e.blue[500],animation:"$rotation 1.5s infinite ease-in-out",animationFillMode:"forwards"},healIconFailed:{color:_e.red[500]},healIconSkipped:{color:_e.orange[800]},healIconDone:{color:_e.green[900]},"@keyframes rotation":{"0%":{transform:"rotate(0deg)"},"95%":{transform:"rotate(720deg)",animationFillMode:"none"},"95.1%":{transform:"rotate(0deg)"}}})),Un=e=>{let{status:t}=e,{translate:r}=(0,zn.useI18n)(),o=Yu();switch(t){case"done":return ve.default.createElement(it.default,{title:r("done")},ve.default.createElement(Hn.default,{className:o.healIconDone}));case"skipped":return ve.default.createElement(it.default,{title:r("skipped")},ve.default.createElement(Gn.default,{className:o.healIconSkipped}));case"failed":return ve.default.createElement(it.default,{title:r("failed")},ve.default.createElement(Wn.default,{className:o.healIconFailed}));case"pending":return ve.default.createElement(it.default,{title:r("pending")},ve.default.createElement($n.default,{className:o.healIconPending}))}throw new Error("Unknown heal status")};var Na=c(ko()),Ma=c(Kn()),Ba=c(Yn()),Ea=c(Vs()),Oa=c(X());var ke=c(He()),ea=c(X()),st=c(Ge()),D=c(j());var Xt=c(K()),ta=c(Zn()),ra=c(To()),oa=c(al()),na=c(Vr());var Ur=c(Zs()),Jt=c(Je()),aa=c(Qe()),ia=c(Qn()),sa=c(Xn()),la=c(Jn()),Tc=(0,ea.makeStyles)(e=>({root:{padding:e.spacing(2,0),display:"grid",gridTemplateColumns:"minmax(auto, 300px) 1fr",alignItems:"center",columnGap:e.spacing(4),rowGap:e.spacing(2)},firmwareUpdate:{gridColumn:"1 / span 2",display:"flex",flexFlow:"row nowrap",justifyContent:"space-between",alignItems:"center",marginTop:e.spacing(4)},firmwareUpdateMessage:{gridColumn:"1 / span 2"},warning:{color:e.palette.warning.main},redButton:{background:e.palette.error.main,"&:hover":{background:e.palette.error.dark}}})),ua=e=>{let[t,r]=D.default.useState(),[o,n]=D.default.useState(!1),[a,u]=D.default.useState(),[i,s]=D.default.useState(),l=D.default.useRef(),f=ae(),{nodeId:p,isBusy:g,setBusy:h,supportsFirmwareUpdate:S}=e,{translate:x}=(0,Xt.useI18n)(),{showNotification:m,showModal:_}=(0,Xt.useDialogs)(),C=e.status!=="alive"&&e.status!=="awake";async function y(){if(!!await _(x("Remove node?"),x("Do you really want to remove this node from the network?"))){h(!0);try{await f.removeFailedNode(p)}catch(A){alert(A)}finally{h(!1)}}}async function w(){await _(x("Replace node?"),x("Do you really want to replace this node?"))&&e.replaceFailedNode()}async function q(){h(!0);try{await f.refreshNodeInfo(p)}catch(b){alert(b)}finally{h(!1)}}let B=()=>{l.current?.click()},F=async b=>{if(b.target.files?.length){let A=b.target.files[0],W=new Uint8Array(await A.arrayBuffer());r({name:A.name,data:W})}};async function U(){if(S&&t?.data){h(!0);try{n(!0),u({type:"progress",sentFragments:0,totalFragments:1}),await f.beginFirmwareUpdate(p,t.name,Array.from(t.data))}catch(b){n(!1),alert(b)}finally{h(!1),s(void 0)}}}async function G(){h(!0);try{await f.abortFirmwareUpdate(p)}catch(b){alert(b)}finally{h(!1),n(!1)}}It(b=>{if(b.type==="firmwareUpdate"){let A=b.progress;if(u(A),A.type==="done"){let W=A.status>=253;if(!W)m(x("firmware update failed"),"error"),s(void 0);else{let V=x("firmware update successful");W&&(A.waitTime?V+=" "+x("firmware update wait time").replace("{0}",A.waitTime.toString()):V+=" "+x("firmware update no wait time"),V+=" "+x("firmware update wake up")),s(V)}r(void 0),n(!1),setTimeout(()=>{u(void 0)},1e4)}else n(!0)}});let v=a?.type==="progress"&&typeof a.totalFragments=="number"&&typeof a.sentFragments=="number"?Math.round(a.sentFragments/a.totalFragments*1e4)/100:Number.NaN;D.default.useEffect(()=>{a?.type!=="done"&&(e.status==="asleep"&&o?s(x("wake up device")):s(void 0))},[e.status,o,a]);let I=Tc();return D.default.createElement("div",{className:I.root},D.default.createElement(ke.default,{disabled:g,variant:"contained",color:"primary",startIcon:D.default.createElement(na.default,null),onClick:()=>q(),fullWidth:!0},x("Refresh node info")),D.default.createElement(Jt.default,{variant:"body2"},x("Forget all information about all nodes and re-interview them. Battery-powered nodes might need to be woken up manually.")),D.default.createElement(st.default,{title:C?"":x("This is not a failed node")},D.default.createElement("span",null,D.default.createElement(ke.default,{disabled:!C||g,variant:"contained",className:I.redButton,onClick:y,startIcon:D.default.createElement(sa.default,null),fullWidth:!0},x("Remove failed node")))),D.default.createElement(Jt.default,{variant:"body2"},x("Remove this node from the network."),D.default.createElement("br",null),D.default.createElement("span",{className:I.warning},x("WARNING: Only do this if you no longer have physical access."))),D.default.createElement(st.default,{title:C?"":x("This is not a failed node")},D.default.createElement("span",null,D.default.createElement(ke.default,{disabled:!C||g,variant:"contained",className:I.redButton,onClick:w,startIcon:D.default.createElement(la.default,null),fullWidth:!0},x("Replace failed node")))),D.default.createElement(Jt.default,{variant:"body2"},x("Replace this node with a different one, keeping the node ID."),D.default.createElement("br",null),D.default.createElement("span",{className:I.warning},x("WARNING: Make sure that the node is reset before attempting this."))),S&&D.default.createElement(D.default.Fragment,null,D.default.createElement("div",{className:I.firmwareUpdate},D.default.createElement(ke.default,{disabled:o||g,variant:"contained",color:"primary",onClick:()=>B(),style:{flex:"1 0 auto"},startIcon:D.default.createElement(ia.default,null)},x("Update Firmware")),D.default.createElement("input",{type:"file",hidden:!0,id:"firmwareFile",accept:".exe,.ex_,.ota,.otz,.hex,.hec,.gbl,.bin",ref:b=>{b&&(l.current=b)},onChange:F}),o?D.default.createElement(D.default.Fragment,null,D.default.createElement("div",{className:"progress",style:{margin:"0 1em",flex:"1 1 100%"}},Number.isNaN(v)?D.default.createElement(Ur.default,null):D.default.createElement(Ur.default,{variant:"determinate",value:v})),!Number.isNaN(v)&&D.default.createElement("div",{style:{whiteSpace:"nowrap",marginRight:"1em"}},v.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})," %")):D.default.createElement("span",{style:{flex:"1 1 100%",textAlign:"center",padding:"0 1em",wordBreak:"break-all"}},t?`${t.name} (${t.data.byteLength} bytes)`:x("no file selected")),D.default.createElement(ra.default,{variant:"contained",color:"primary",style:{flex:"1 0 auto"}},D.default.createElement(st.default,{title:x("start firmware update")},D.default.createElement(ke.default,{disabled:o||g||!t?.data,onClick:()=>U()},D.default.createElement(ta.default,null))),D.default.createElement(st.default,{title:x("abort firmware update")},D.default.createElement(ke.default,{disabled:!o||g,onClick:()=>G()},D.default.createElement(oa.default,null))))),i?D.default.createElement("div",{className:I.firmwareUpdateMessage},i):D.default.createElement("div",{className:(0,aa.default)(I.firmwareUpdateMessage,I.warning)},x("firmware update warning"))))};var Fa=c(K());var Ue=c(j()),da=c(Ge()),de=c(St()),fa=c(X()),pa=c(xl()),ma=c(ca()),ga=c(Qe()),ha=(0,fa.makeStyles)(e=>({root:{display:"grid",gridTemplateColumns:"repeat(4, 16px)",gridTemplateRows:"16px"},securityIcon:{fontSize:"16px",color:de.grey[200]},S2_AccessControl:{color:de.green[800]},S2_Authenticated:{color:de.blue[900]},S2_Unauthenticated:{color:de.deepPurple[500]},S0_Legacy:{color:de.amber[800]}})),Oc=e=>{let t=ha(),r=e.granted?pa.default:ma.default;return e.supported?Ue.default.createElement(da.default,{title:`${e.title}: ${e.granted?"\u2714":"\u2718"}`},Ue.default.createElement(r,{className:(0,ga.default)(t.securityIcon,e.granted&&t[e.className])})):Ue.default.createElement("span",null)},Fc=[["S2_AccessControl","S2 Access Control"],["S2_Authenticated","S2 Authenticated"],["S2_Unauthenticated","S2 Unauthenticated"],["S0_Legacy","S0 Legacy"]],va=e=>{let t=ha(),{securityClasses:r}=e;return Ue.default.createElement("div",{className:t.root},Fc.map(([o,n])=>Ue.default.createElement(Oc,{key:o,title:n,className:o,supported:o in r,granted:r[o]===!0})))};var Ra=c(ya()),La=c(Ge());var or=c(He()),Da=c(X()),Q=c(j());var fe=c(K()),nr=c(Ro()),qa=c(Lr()),ka=c(Vr()),Ta=c(ba());var ie=c(j()),xa=c(K()),wa=c(Mo()),Sa=c(Bo()),_a=c(Po()),Ca=c(No()),Kr=c(He()),Ia=c(Fr()),Yr=c(Je()),Aa=c(X()),Yc=(0,Aa.makeStyles)(e=>({root:{display:"flex",flexFlow:"column",maxWidth:400,gap:e.spacing(2)}})),ja=e=>{let{translate:t}=(0,xa.useI18n)(),r=Yc(),[o,n]=ie.default.useState(e.region),a=ie.default.useMemo(()=>Object.entries(e.regions).map(([u,i])=>({value:u,label:i})),[e.regions]);return ie.default.createElement(_a.default,{open:e.open,onClose:e.onCancel,maxWidth:!1},ie.default.createElement(Sa.default,{id:"alert-dialog-title"},t("Set RF Region")),ie.default.createElement(wa.default,{className:r.root},ie.default.createElement(Yr.default,{variant:"body1"},t("Select the correct region for where you are. Using a different region may be illegal.")),ie.default.createElement(Ia.Dropdown,{selectedOption:o,options:a,onChange:u=>n(parseInt(u.target.value))}),ie.default.createElement(Yr.default,{variant:"body2"},t("Note: Applying a different region might take a few seconds."))),ie.default.createElement(Ca.default,null,ie.default.createElement(Kr.default,{disabled:e.region===o,onClick:()=>e.onConfirm(o),color:"primary"},t("OK")),ie.default.createElement(Kr.default,{onClick:e.onCancel,color:"primary"},t("Cancel"))))};var Zc=(0,Da.makeStyles)(e=>({root:{padding:e.spacing(2,0),display:"grid",gridTemplateColumns:"minmax(auto, 300px) 1fr",alignItems:"center",columnGap:e.spacing(4),rowGap:e.spacing(2)},redButton:{background:e.palette.error.main,"&:hover":{background:e.palette.error.dark}}})),Pa=e=>{let{isBusy:t,setBusy:r}=e,{namespace:o}=(0,fe.useGlobals)(),n=ae(),{translate:a}=(0,fe.useI18n)(),{showModal:u,showNotification:i}=(0,fe.useDialogs)(),[s,l]=Q.default.useState(!1),[f]=(0,fe.useIoBrokerObject)(`${o}.info.rfRegion`,{subscribe:!1}),[p]=(0,fe.useIoBrokerState)({id:`${o}.info.rfRegion`}),g=Q.default.useCallback(m=>{t||(r(!0),n.setRFRegion(m).finally(()=>r(!1)))},[n,t,r]),h=Q.default.useCallback(async()=>{if(!t)try{if(!await u(a("Re-interview all?"),a("clear cache procedure")))return;r(!0),await n.clearCache(),setTimeout(()=>{r(!1)},1e3)}catch(m){i(we(m),"error");return}},[n,t,u,i]),S=Q.default.useCallback(async()=>{if(!t)try{if(!await u(a("Factory reset?"),a("factory reset procedure")))return;r(!0),await n.hardReset(),r(!1),await u(a("Factory reset successful"),a("The adapter will now restart."))}catch(m){i(we(m),"error");return}},[n,t,u,i]),x=Zc();return Q.default.createElement("div",{className:x.root},Q.default.createElement(or.default,{disabled:t,variant:"contained",color:"primary",onClick:h,startIcon:Q.default.createElement(ka.default,null)},a("Re-interview all")),Q.default.createElement(nr.Typography,{variant:"body2"},a("Forget all information about all nodes and re-interview them. Battery-powered nodes might need to be woken up manually.")),Q.default.createElement(or.default,{disabled:t||p==null,variant:"contained",color:"primary",onClick:()=>l(!0),startIcon:Q.default.createElement(Ta.default,null)},a("Set RF Region")),Q.default.createElement(nr.Typography,{variant:"body2"},a("Configure the region and radio frequencies of the controller.")),Q.default.createElement(or.default,{className:x.redButton,disabled:t,variant:"contained",onClick:S,startIcon:Q.default.createElement(qa.default,null)},a("Factory reset")),Q.default.createElement(nr.Typography,{variant:"body2"},a("Wipes all configuration of the controller. All connected nodes will be orphaned and have to be reset and included into the new network before they can be used again.")),f&&p!=null&&Q.default.createElement(ja,{open:s,onCancel:()=>l(!1),onConfirm:m=>{g(m),l(!1)},region:p,regions:f.common.states??{}}))};var Qc=(0,Oa.makeStyles)(e=>({mainRow:{"& > *":{border:0}},controllerIcon:{fontSize:"16px",margin:"7px",color:e.palette.text.secondary},idCell:{display:"flex",flexFlow:"row nowrap",alignItems:"center"},expanderCell:{paddingBottom:0,paddingTop:0,background:e.palette.background.default}})),za=e=>{let{healStatus:t,device:r}=e,{value:o,status:n}=r,a=o.native.id,u=!!o.native.supportsFirmwareUpdate,{secure:i,securityClasses:s,isControllerNode:l}=o.native,[f,p]=N.default.useState(l),g=Qc(),{translate:h}=(0,Fa.useI18n)();return N.default.createElement(N.default.Fragment,null,N.default.createElement(Zr.default,{hover:!0,className:g.mainRow},N.default.createElement(Te.default,{className:g.idCell},N.default.createElement(Na.default,{"aria-label":"expand row",size:"small",onClick:()=>p(!f)},f?N.default.createElement(Ba.default,null):N.default.createElement(Ma.default,null)),N.default.createElement("span",{style:{marginLeft:"auto"}},a)),N.default.createElement(Te.default,null,o.common.name),N.default.createElement(Te.default,null,o.native.type.specific??o.native.type.generic??h("unknown")),N.default.createElement(Te.default,null,i&&s&&N.default.createElement(va,{securityClasses:s})),N.default.createElement(Te.default,null,l?N.default.createElement(La.default,{title:h("Controller node")},N.default.createElement(Ra.default,null)):N.default.createElement(N.default.Fragment,null,N.default.createElement(Et,{status:n}),!!t&&N.default.createElement(N.default.Fragment,null," ",N.default.createElement(Un,{status:e.healStatus}))))),N.default.createElement(Zr.default,null,N.default.createElement(Te.default,{colSpan:5,className:g.expanderCell},N.default.createElement(Ea.default,{in:f,timeout:"auto",unmountOnExit:!0},l?N.default.createElement(Pa,{isBusy:e.isBusy,setBusy:e.setBusy}):N.default.createElement(ua,{nodeId:a,status:n,isBusy:e.isBusy,setBusy:e.setBusy,supportsFirmwareUpdate:u,replaceFailedNode:e.replaceFailedNode})))))};var Xc=(0,Ga.makeStyles)(e=>({root:{width:"100%",marginTop:e.spacing(2)},container:{overflowY:"auto"},empty:{textAlign:"center",fontStyle:"italic"}})),Ya=e=>{let{translate:t}=(0,Ha.useI18n)(),r=Xc(),{devices:o,healingNetwork:n,networkHealProgress:a}=e;return J.default.createElement(Wa.default,{className:r.root,elevation:2},J.default.createElement(Ua.default,{className:r.container},J.default.createElement($a.default,null,J.default.createElement(Ka.default,null,J.default.createElement(Qr.default,null,J.default.createElement(Pe.default,{align:"right"},"#"),J.default.createElement(Pe.default,null,t("Name")),J.default.createElement(Pe.default,null,t("Type")),J.default.createElement(Pe.default,null,t("Security")),J.default.createElement(Pe.default,null,t("Status")))),J.default.createElement(Va.default,null,o.length?o.map(u=>{let i=u.value.native.id;return J.default.createElement(za,{key:`device-${i}`,isBusy:e.isBusy,setBusy:e.setBusy,device:u,healStatus:n?a[i]:void 0,replaceFailedNode:()=>e.replaceFailedNode(i)})}):J.default.createElement(Qr.default,null,J.default.createElement(Pe.default,{colSpan:5,className:r.empty},t("No devices present")))))))};var Y=c(He()),pi=c(Po()),Ie=c(No()),Ae=c(Mo()),mi=c(Bo()),gi=c(Nr()),hi=c(X()),O=c(Je()),oe=c(K()),d=c(j()),Jr=c(nl()),vi=c(il()),ar=c(St()),eo=c(Qe()),yi=c(tl()),Ne=c(Ys()),Me=c(Ks());var re=c(j()),Zp=c($s()),li=c(Qe()),Ce=c(X()),ui=c(Pr());var Za=c(j()),Qa=c(Xe()),Xa=(0,Qa.createSvgIcon)(Za.createElement("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined");var Ja=c(j()),ei=c(Xe()),ti=(0,ei.createSvgIcon)(Ja.createElement("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined");var ri=c(j()),oi=c(Xe()),ni=(0,oi.createSvgIcon)(ri.createElement("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline");var ai=c(j()),ii=c(Xe()),si=(0,ii.createSvgIcon)(ai.createElement("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined");var ci=c(ko()),di=c(Xe()),Jc=function(t){var r=t.palette.type==="light"?Ce.darken:Ce.lighten,o=t.palette.type==="light"?Ce.lighten:Ce.darken;return{root:Mr({},t.typography.body2,{borderRadius:t.shape.borderRadius,backgroundColor:"transparent",display:"flex",padding:"6px 16px"}),standardSuccess:{color:r(t.palette.success.main,.6),backgroundColor:o(t.palette.success.main,.9),"& $icon":{color:t.palette.success.main}},standardInfo:{color:r(t.palette.info.main,.6),backgroundColor:o(t.palette.info.main,.9),"& $icon":{color:t.palette.info.main}},standardWarning:{color:r(t.palette.warning.main,.6),backgroundColor:o(t.palette.warning.main,.9),"& $icon":{color:t.palette.warning.main}},standardError:{color:r(t.palette.error.main,.6),backgroundColor:o(t.palette.error.main,.9),"& $icon":{color:t.palette.error.main}},outlinedSuccess:{color:r(t.palette.success.main,.6),border:"1px solid ".concat(t.palette.success.main),"& $icon":{color:t.palette.success.main}},outlinedInfo:{color:r(t.palette.info.main,.6),border:"1px solid ".concat(t.palette.info.main),"& $icon":{color:t.palette.info.main}},outlinedWarning:{color:r(t.palette.warning.main,.6),border:"1px solid ".concat(t.palette.warning.main),"& $icon":{color:t.palette.warning.main}},outlinedError:{color:r(t.palette.error.main,.6),border:"1px solid ".concat(t.palette.error.main),"& $icon":{color:t.palette.error.main}},filledSuccess:{color:"#fff",fontWeight:t.typography.fontWeightMedium,backgroundColor:t.palette.success.main},filledInfo:{color:"#fff",fontWeight:t.typography.fontWeightMedium,backgroundColor:t.palette.info.main},filledWarning:{color:"#fff",fontWeight:t.typography.fontWeightMedium,backgroundColor:t.palette.warning.main},filledError:{color:"#fff",fontWeight:t.typography.fontWeightMedium,backgroundColor:t.palette.error.main},icon:{marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9},message:{padding:"8px 0"},action:{display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}}},fi={success:re.createElement(Xa,{fontSize:"inherit"}),warning:re.createElement(ti,{fontSize:"inherit"}),error:re.createElement(ni,{fontSize:"inherit"}),info:re.createElement(si,{fontSize:"inherit"})},ed=re.createElement(Ho,{fontSize:"small"}),td=re.forwardRef(function(t,r){var o=t.action,n=t.children,a=t.classes,u=t.className,i=t.closeText,s=i===void 0?"Close":i,l=t.color,f=t.icon,p=t.iconMapping,g=p===void 0?fi:p,h=t.onClose,S=t.role,x=S===void 0?"alert":S,m=t.severity,_=m===void 0?"success":m,C=t.variant,y=C===void 0?"standard":C,w=zo(t,["action","children","classes","className","closeText","color","icon","iconMapping","onClose","role","severity","variant"]);return re.createElement(ui.default,Mr({role:x,square:!0,elevation:0,className:(0,li.default)(a.root,a["".concat(y).concat((0,di.capitalize)(l||_))],u),ref:r},w),f!==!1?re.createElement("div",{className:a.icon},f||g[_]||fi[_]):null,re.createElement("div",{className:a.message},n),o!=null?re.createElement("div",{className:a.action},o):null,o==null&&h?re.createElement("div",{className:a.action},re.createElement(ci.default,{size:"small","aria-label":s,title:s,color:"inherit",onClick:h},ed)):null)}),Xr=(0,Ce.withStyles)(Jc,{name:"MuiAlert"})(td);var Be=(0,hi.makeStyles)(e=>({strategyRoot:{},strategyGridHeadline:{marginTop:e.spacing(4)},strategyGrid:{marginTop:e.spacing(1),display:"grid",gridTemplateColumns:"auto 400px",gridGap:e.spacing(2),alignItems:"center"},strategyList:{...e.typography.body2},waitMessageRoot:{display:"grid",gridTemplateColumns:"minmax(auto, 10ch) 1fr",gridGap:e.spacing(4),alignItems:"center",overflow:"hidden"},grantRoot:{display:"flex",flexFlow:"column nowrap",gap:e.spacing(1),maxWidth:"600px"},grantHeadline:{marginTop:e.spacing(-1),marginBottom:e.spacing(1)},grantCSA:{marginTop:e.spacing(2)},validateDSKRoot:{maxWidth:"600px"},validateDSKGrid:{marginTop:e.spacing(1),display:"grid",width:"100%",gridTemplateColumns:"minmax(auto, 10ch) 1fr",gridGap:e.spacing(1),alignItems:"center",textAlign:"center"},resultRoot:{display:"grid",gridTemplateColumns:"auto 1fr",gridTemplateRows:"auto auto auto",alignItems:"center"},resultIcon:{marginRight:e.spacing(4),fontSize:"64px",gridRow:"1 / span 3",gridColumn:1},resultIconOK:{color:ar.green[500]},resultIconLowSecurity:{color:ar.yellow[700]}})),T;(function(l){l[l.SelectInclusionStrategy=0]="SelectInclusionStrategy",l[l.SelectReplacementStrategy=1]="SelectReplacementStrategy",l[l.IncludeDevice=2]="IncludeDevice",l[l.ExcludeDevice=3]="ExcludeDevice",l[l.GrantSecurityClasses=4]="GrantSecurityClasses",l[l.ValidateDSK=5]="ValidateDSK",l[l.Busy=6]="Busy",l[l.Result=7]="Result",l[l.ExclusionResult=8]="ExclusionResult"})(T||(T={}));var ye;(function(a){a[a.Default=0]="Default",a[a.SmartStart=1]="SmartStart",a[a.Insecure=2]="Insecure",a[a.Security_S0=3]="Security_S0",a[a.Security_S2=4]="Security_S2"})(ye||(ye={}));var rd=e=>{let{translate:t}=(0,oe.useI18n)(),r=Be(),[o,n]=d.default.useState(!1),a=t(o?"Security S2 when supported, Security S0 as a fallback, no encryption otherwise.":"Security S2 when supported, Security S0 only when necessary, no encryption otherwise."),{namespace:u}=(0,oe.useGlobals)(),[i]=(0,oe.useIoBrokerObject)(`system.adapter.${u}`,{subscribe:!1}),s=i?.native,l=s&&(!s.networkKey_S0||!s.networkKey_S2_AccessControl||!s.networkKey_S2_Authenticated||!s.networkKey_S2_Unauthenticated);return d.default.createElement(d.default.Fragment,null,d.default.createElement(Ae.default,{className:r.strategyRoot},d.default.createElement(O.default,{variant:"body2"},t("Z-Wave supports the following security mechanisms:")),d.default.createElement("ul",{className:r.strategyList,style:{marginTop:"0.5em"}},d.default.createElement("li",null,d.default.createElement("b",null,"Security S2")," \u2013 ",t("fast and secure")," ",d.default.createElement("b",null,t("(recommended)"))),d.default.createElement("li",null,d.default.createElement("b",null,"Security S0")," \u2013"," ",t("secure, but slow due to a lot of overhead")," ",d.default.createElement("b",null,t("(use only when necessary)"))),d.default.createElement("li",null,t("No encryption"))),l&&d.default.createElement(Xr,{severity:"warning"},t("At least one network key is not yet configured. This can cause problems during secure inclusion.")),d.default.createElement(O.default,{variant:"body1",className:r.strategyGridHeadline},t("Please choose an inclusion strategy"),":"),d.default.createElement("div",{className:r.strategyGrid},d.default.createElement("div",{style:{gridRow:1,display:"flex",flexFlow:"column"}},d.default.createElement(Y.default,{variant:"contained",color:"primary",onClick:()=>e.selectStrategy(0,o)},t("Default (secure)")),d.default.createElement(Ne.default,{label:t("Prefer S0 over no encryption"),control:d.default.createElement(Me.default,{checked:o,onChange:(f,p)=>n(p)})})),d.default.createElement(O.default,{variant:"caption",style:{alignSelf:"flex-start"}},a,d.default.createElement("br",null),t("Requires user interaction during the inclusion.")),d.default.createElement(Y.default,{variant:"contained",color:"secondary",style:{gridRow:2},disabled:!0,onClick:()=>e.selectStrategy(1)},"SmartStart"),d.default.createElement(O.default,{variant:"caption"},"coming soon..."),d.default.createElement(Y.default,{variant:"contained",color:"secondary",style:{gridRow:3},onClick:()=>e.selectStrategy(3)},t("Security S0")),d.default.createElement(O.default,{variant:"caption"},t("Only use S0, even if S2 is available. Allows including devices that require security but don't behave correctly during S2 inclusion.")),d.default.createElement(Y.default,{variant:"contained",color:"default",style:{gridRow:4},onClick:()=>e.selectStrategy(2)},t("No encryption")))),d.default.createElement(Ie.default,null,d.default.createElement(Y.default,{variant:"contained",onClick:e.onCancel,color:"primary"},t("Cancel"))))},od=e=>{let{translate:t}=(0,oe.useI18n)(),r=Be();return d.default.createElement(d.default.Fragment,null,d.default.createElement(Ae.default,{className:r.strategyRoot},d.default.createElement(O.default,{variant:"body1",className:r.strategyGridHeadline},t("Please choose a replacement strategy"),":"),d.default.createElement("div",{className:r.strategyGrid},d.default.createElement(Y.default,{variant:"contained",color:"primary",style:{gridRow:1},onClick:()=>e.selectStrategy(4)},t("Security S2")),d.default.createElement(O.default,{variant:"caption",style:{alignSelf:"flex-start"}},t("fast and secure"),d.default.createElement("br",null),t("(recommended)")),d.default.createElement(Y.default,{variant:"contained",color:"secondary",style:{gridRow:2},disabled:!0,onClick:()=>e.selectStrategy(3)},t("Security S0")),d.default.createElement(O.default,{variant:"caption"},t("secure, but slow due to a lot of overhead"),d.default.createElement("br",null),t("(use only when necessary)")),d.default.createElement(Y.default,{variant:"contained",color:"default",style:{gridRow:3},onClick:()=>e.selectStrategy(2)},t("No encryption")))),d.default.createElement(Ie.default,null,d.default.createElement(Y.default,{variant:"contained",onClick:e.onCancel,color:"primary"},t("Cancel"))))},to=e=>{let t=Be(),{translate:r}=(0,oe.useI18n)();return d.default.createElement(d.default.Fragment,null,d.default.createElement(Ae.default,{className:t.waitMessageRoot},d.default.createElement(gi.default,{size:48}),d.default.createElement(O.default,{variant:"body1"},e.message)),d.default.createElement(Ie.default,null,e.onCancel&&d.default.createElement(Y.default,{variant:"contained",onClick:e.onCancel,color:"primary"},r("Cancel"))))},nd=e=>{let{translate:t}=(0,oe.useI18n)(),r=Be(),o=e.request,n=o.securityClasses.includes(2),a=o.securityClasses.includes(1),u=o.securityClasses.includes(0),i=o.securityClasses.includes(7),s=o.clientSideAuth,[l,f]=d.default.useState(n),[p,g]=d.default.useState(a),[h,S]=d.default.useState(u),[x,m]=d.default.useState(i),[_,C]=d.default.useState(s),y=()=>{let w=[];l&&w.push(2),p&&w.push(1),h&&w.push(0),x&&w.push(7);let q={securityClasses:w,clientSideAuth:_};e.grantSecurityClasses(q)};return d.default.createElement(d.default.Fragment,null,d.default.createElement(Ae.default,{className:r.grantRoot},d.default.createElement(O.default,{variant:"body1"},t("Please choose which of the following security classes to grant to the new node.")),d.default.createElement(O.default,{variant:"caption",className:r.grantHeadline},t("At least one must be granted or the key exchange will be canceled.")),d.default.createElement(Ne.default,{label:d.default.createElement(d.default.Fragment,null,d.default.createElement("b",null,"S2 Access Control",!n&&d.default.createElement(d.default.Fragment,null," (",t("not requested"),")")),d.default.createElement("br",null),d.default.createElement(O.default,{variant:"caption"},t("Example:")," ",t("Door locks, garage doors"),", ...")),disabled:!n,control:d.default.createElement(Me.default,{checked:l,onChange:(w,q)=>f(q)})}),d.default.createElement(Ne.default,{label:d.default.createElement(d.default.Fragment,null,d.default.createElement("b",null,"S2 Authenticated",!a&&d.default.createElement(d.default.Fragment,null," (",t("not requested"),")")),d.default.createElement("br",null),d.default.createElement(O.default,{variant:"caption"},t("Example:")," ",t("Lighting, sensors, security systems"),", ...")),disabled:!a,control:d.default.createElement(Me.default,{checked:p,onChange:(w,q)=>g(q)})}),d.default.createElement(Ne.default,{label:d.default.createElement(d.default.Fragment,null,d.default.createElement("b",null,"S2 Unauthenticated",!u&&d.default.createElement(d.default.Fragment,null," (",t("not requested"),")")),d.default.createElement("br",null),d.default.createElement(O.default,{variant:"caption"},t("Like S2 Authenticated, but without verification that the correct device is included"))),disabled:!u,control:d.default.createElement(Me.default,{checked:h,onChange:(w,q)=>S(q)})}),d.default.createElement(Ne.default,{label:d.default.createElement(d.default.Fragment,null,d.default.createElement("b",null,"S0 Legacy",!i&&d.default.createElement(d.default.Fragment,null," (",t("not requested"),")")),d.default.createElement("br",null),d.default.createElement(O.default,{variant:"caption"},t("Example:")," ",t("Legacy door locks without S2 support"))),disabled:!i,control:d.default.createElement(Me.default,{checked:x,onChange:(w,q)=>m(q)})}),d.default.createElement(Ne.default,{className:r.grantCSA,label:d.default.createElement(d.default.Fragment,null,d.default.createElement("b",null,"Client Side Authentication",!s&&d.default.createElement(d.default.Fragment,null," (",t("not requested"),")")),d.default.createElement("br",null),d.default.createElement(O.default,{variant:"caption"},t("For devices without a DSK. Authentication of the inclusion happens on the device instead of in ioBroker."))),disabled:!s,control:d.default.createElement(Me.default,{checked:_,onChange:(w,q)=>C(q)})})),d.default.createElement(Ie.default,null,d.default.createElement(Y.default,{variant:"contained",onClick:y,color:"primary"},t("OK")),d.default.createElement(Y.default,{variant:"contained",onClick:e.onCancel,color:"primary"},t("Cancel"))))},ad=e=>{let{translate:t}=(0,oe.useI18n)(),[r,o]=d.default.useState(""),[n,a]=d.default.useState(!1),u=f=>{let p=f.target.value.replace(/[^0-9]/g,"");o(p),a(!1)},i=()=>{r.length!==5&&a(!0)},s=()=>{r.length===5&&e.setPIN(r)},l=Be();return d.default.createElement(d.default.Fragment,null,d.default.createElement(Ae.default,{className:l.validateDSKRoot},d.default.createElement(O.default,{variant:"body1",className:l.strategyGridHeadline},t("Please enter the 5-digit PIN for your device and verify that the rest of the device-specific key (DSK) matches the one on your device or the manual.")),d.default.createElement("div",{className:l.validateDSKGrid},d.default.createElement(yi.default,{autoFocus:!0,variant:"outlined",margin:"dense",inputProps:{maxLength:5,style:{textAlign:"center"}},value:r,error:!!n,onChange:u,onBlur:i,onKeyDown:f=>{f.key==="Enter"&&s(),f.key==="Escape"&&e.onCancel()}}),d.default.createElement(O.default,{variant:"body1"},e.dsk),d.default.createElement(O.default,{variant:"caption"},"PIN"),d.default.createElement(O.default,{variant:"caption"},"DSK"))),d.default.createElement(Ie.default,null,d.default.createElement(Y.default,{disabled:r.length!==5,onClick:s,color:"primary"},t("OK")),d.default.createElement(Y.default,{variant:"contained",onClick:e.onCancel,color:"primary"},t("Cancel"))))},id=e=>{let{translate:t}=(0,oe.useI18n)(),r=Be(),o=e.lowSecurity?vi.default:Jr.default,n=e.lowSecurity?t("Node %s was added insecurely!",e.nodeId.toString()):t("Node %s was added successfully!",e.nodeId.toString()),a=e.lowSecurity?t("There was an error during secure inclusion. To try again, exclude the node first."):t("Security class: %s",e.securityClass??t("None")),u=t("The device is now being interviewed. It might take a while to show up.");return d.default.createElement(d.default.Fragment,null,d.default.createElement(Ae.default,{className:r.resultRoot},d.default.createElement(o,{className:(0,eo.default)(r.resultIcon,e.lowSecurity?r.resultIconLowSecurity:r.resultIconOK)}),d.default.createElement(O.default,{variant:"body1",style:{fontWeight:"bold",fontSize:"125%"}},n),d.default.createElement(O.default,{variant:"body2"},a),d.default.createElement(O.default,{variant:"body2"},u)),d.default.createElement(Ie.default,null,d.default.createElement(Y.default,{variant:"contained",onClick:e.onDone,color:"primary"},t("OK"))))},sd=e=>{let{translate:t}=(0,oe.useI18n)(),r=Be();return d.default.createElement(d.default.Fragment,null,d.default.createElement(Ae.default,{className:r.resultRoot},d.default.createElement(Jr.default,{className:(0,eo.default)(r.resultIcon,r.resultIconOK)}),d.default.createElement(O.default,{variant:"body2"},t("Node %s was removed from the network!",e.nodeId.toString()))),d.default.createElement(Ie.default,null,d.default.createElement(Y.default,{variant:"contained",onClick:e.onDone,color:"primary"},t("OK"))))},bi=e=>{let{translate:t}=(0,oe.useI18n)(),r=d.default.useMemo(()=>{switch(e.step){case 0:return d.default.createElement(rd,{selectStrategy:e.selectStrategy,onCancel:e.onCancel});case 1:return d.default.createElement(od,{selectStrategy:e.selectStrategy,onCancel:e.onCancel});case 2:return d.default.createElement(to,{message:t("Put your device into inclusion mode"),onCancel:e.onCancel});case 3:return d.default.createElement(to,{message:t("Put your device into exclusion mode"),onCancel:e.onCancel});case 4:return d.default.createElement(nd,{grantSecurityClasses:e.grantSecurityClasses,request:e.request,onCancel:e.onCancel});case 5:return d.default.createElement(ad,{dsk:e.dsk,onCancel:e.onCancel,setPIN:e.setPIN});case 7:return d.default.createElement(id,{nodeId:e.nodeId,lowSecurity:e.lowSecurity,securityClass:e.securityClass,onDone:e.onDone});case 8:return d.default.createElement(sd,{nodeId:e.nodeId,onDone:e.onDone});case 6:return d.default.createElement(to,{message:t("Communicating with the device, please be patient...")})}},[e.step]),o=d.default.useMemo(()=>{switch(e.step){case 0:case 2:case 4:case 5:case 7:case 6:return t("Include device");case 1:return t("Replace device");case 3:case 8:return t("Exclude device")}},[e.step]);return d.default.createElement(pi.default,{open:e.isOpen,onClose:e.onCancel,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",maxWidth:!1},d.default.createElement(mi.default,{id:"alert-dialog-title"},o),r)};var xi=c(Nr()),wi=e=>{let{devices:t}=e,{alive:r,connected:o}=(0,le.useAdapter)(),{namespace:n}=(0,le.useGlobals)(),{translate:a}=(0,le.useI18n)(),u=ae(),{showNotification:i}=(0,le.useDialogs)(),[s,l]=se.default.useState(!1),[f]=(0,le.useIoBrokerState)({id:`${n}.info.inclusion`,defaultValue:!1}),[p,,g]=(0,le.useIoBrokerState)({id:`${n}.info.exclusion`,defaultValue:!1}),[h]=(0,le.useIoBrokerState)({id:`${n}.info.healingNetwork`,defaultValue:!1}),[S,x]=se.default.useState({}),[m,_]=se.default.useState();It(v=>{v.type==="inclusion"?_(v.status):v.type==="healing"&&(x(v.status.progress??{}),v.status.type==="done"&&i(a("Healing the network was successful!"),"success"))});async function C(){if(!h)try{x({}),await u.beginHealingNetwork()}catch(v){i(we(v),"error");return}}let[y,w]=se.default.useState(!1),q=[];if(t)for(let v of Object.keys(t)){let I=t[v];I&&q.push(I)}async function B(v){_({type:"chooseReplacementStrategy",nodeId:v}),w(!0)}let F=(()=>{if(p)return{step:T.ExcludeDevice,onCancel:()=>{w(!1),setTimeout(()=>{g(!1)},250)}};if(!m&&!f)return{step:T.SelectInclusionStrategy,onCancel:()=>w(!1),selectStrategy:async(v,I)=>{try{await u.beginInclusion(v,I),_({type:"waitingForDevice"})}catch{i(a("Failed to start inclusion"),"error")}}};if(m?.type==="chooseReplacementStrategy")return{step:T.SelectReplacementStrategy,onCancel:()=>{w(!1),setTimeout(()=>{_(void 0)},250)},selectStrategy:async v=>{try{await u.replaceFailedNode(m.nodeId,v),_({type:"waitingForDevice"})}catch{i(a("Failed to start replacing the node"),"error")}}};if(!m||m.type==="waitingForDevice")return{step:T.IncludeDevice,onCancel:()=>{w(!1),u.stopInclusion()}};if(m.type==="busy")return{step:T.Busy,onCancel:()=>{}};if(m.type==="validateDSK")return{step:T.ValidateDSK,dsk:m.dsk,setPIN:v=>{u.validateDSK(v)},onCancel:()=>{u.validateDSK(!1)}};if(m.type==="grantSecurityClasses")return{step:T.GrantSecurityClasses,request:m.request,grantSecurityClasses:v=>{u.grantSecurityClasses(v)},onCancel:()=>{u.grantSecurityClasses(!1)}};if(m.type==="done")return{step:T.Result,nodeId:m.nodeId,lowSecurity:m.lowSecurity,securityClass:m.securityClass,onDone:()=>{w(!1),setTimeout(()=>{_(void 0)},250)},onCancel:()=>{w(!1),setTimeout(()=>{_(void 0)},250)}};if(m.type==="exclusionDone")return{step:T.ExclusionResult,nodeId:m.nodeId,onDone:()=>{w(!1),setTimeout(()=>{_(void 0)},250)},onCancel:()=>{w(!1),setTimeout(()=>{_(void 0)},250)}}})(),U=f||!!m&&!p&&m.type!=="exclusionDone",G=p||!!m&&!f&&m.type!=="done"&&m.type!=="exclusionDone";return!r||!o?se.default.createElement($e,null):t?se.default.createElement(se.default.Fragment,null,se.default.createElement(En,{state:s?$.Busy:U?$.Including:G?$.Excluding:h?$.Healing:$.Idle,beginInclusion:()=>w(!0),beginExclusion:async()=>{await g(!0),w(!0)},healNetwork:C,cancelHealing:()=>u.stopHealingNetwork()}),se.default.createElement(Ya,{isBusy:s||h,setBusy:l,devices:q,healingNetwork:h,networkHealProgress:S,replaceFailedNode:B}),F&&se.default.createElement(bi,{isOpen:y,...F})):se.default.createElement(xi.default,null)};var Sr=c(j());function ro(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function oo(e,t,r){e=+e,t=+t,r=(n=arguments.length)<2?(t=e,e=0,1):n<3?1:+r;for(var o=-1,n=Math.max(0,Math.ceil((t-e)/r))|0,a=new Array(n);++o<n;)a[o]=e+o*r;return a}var no=Math.abs,Ee=Math.cos,Oe=Math.sin,Si=Math.PI,lt=Si/2,ao=Si*2,io=Math.max,ir=1e-12;function so(e,t){return Array.from({length:t-e},(r,o)=>e+o)}function ld(e){return function(t,r){return e(t.source.value+t.target.value,r.source.value+r.target.value)}}function lo(){return ud(!1,!1)}function ud(e,t){var r=0,o=null,n=null,a=null;function u(i){var s=i.length,l=new Array(s),f=so(0,s),p=new Array(s*s),g=new Array(s),h=0,S;i=Float64Array.from({length:s*s},t?(x,m)=>i[m%s][m/s|0]:(x,m)=>i[m/s|0][m%s]);for(let x=0;x<s;++x){let m=0;for(let _=0;_<s;++_)m+=i[x*s+_]+e*i[_*s+x];h+=l[x]=m}h=io(0,ao-r*s)/h,S=h?r:ao/s;{let x=0;o&&f.sort((m,_)=>o(l[m],l[_]));for(let m of f){let _=x;if(e){let C=so(~s+1,s).filter(y=>y<0?i[~y*s+m]:i[m*s+y]);n&&C.sort((y,w)=>n(y<0?-i[~y*s+m]:i[m*s+y],w<0?-i[~w*s+m]:i[m*s+w]));for(let y of C)if(y<0){let w=p[~y*s+m]||(p[~y*s+m]={source:null,target:null});w.target={index:m,startAngle:x,endAngle:x+=i[~y*s+m]*h,value:i[~y*s+m]}}else{let w=p[m*s+y]||(p[m*s+y]={source:null,target:null});w.source={index:m,startAngle:x,endAngle:x+=i[m*s+y]*h,value:i[m*s+y]}}g[m]={index:m,startAngle:_,endAngle:x,value:l[m]}}else{let C=so(0,s).filter(y=>i[m*s+y]||i[y*s+m]);n&&C.sort((y,w)=>n(i[m*s+y],i[m*s+w]));for(let y of C){let w;if(m<y?(w=p[m*s+y]||(p[m*s+y]={source:null,target:null}),w.source={index:m,startAngle:x,endAngle:x+=i[m*s+y]*h,value:i[m*s+y]}):(w=p[y*s+m]||(p[y*s+m]={source:null,target:null}),w.target={index:m,startAngle:x,endAngle:x+=i[m*s+y]*h,value:i[m*s+y]},m===y&&(w.source=w.target)),w.source&&w.target&&w.source.value<w.target.value){let q=w.source;w.source=w.target,w.target=q}}g[m]={index:m,startAngle:_,endAngle:x,value:l[m]}}x+=S}}return p=Object.values(p),p.groups=g,a?p.sort(a):p}return u.padAngle=function(i){return arguments.length?(r=io(0,i),u):r},u.sortGroups=function(i){return arguments.length?(o=i,u):o},u.sortSubgroups=function(i){return arguments.length?(n=i,u):n},u.sortChords=function(i){return arguments.length?(i==null?a=null:(a=ld(i))._=i,u):a&&a._},u}var uo=Math.PI,co=2*uo,Fe=1e-6,cd=co-Fe;function fo(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function _i(){return new fo}fo.prototype=_i.prototype={constructor:fo,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,r,o){this._+="Q"+ +e+","+ +t+","+(this._x1=+r)+","+(this._y1=+o)},bezierCurveTo:function(e,t,r,o,n,a){this._+="C"+ +e+","+ +t+","+ +r+","+ +o+","+(this._x1=+n)+","+(this._y1=+a)},arcTo:function(e,t,r,o,n){e=+e,t=+t,r=+r,o=+o,n=+n;var a=this._x1,u=this._y1,i=r-e,s=o-t,l=a-e,f=u-t,p=l*l+f*f;if(n<0)throw new Error("negative radius: "+n);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(p>Fe)if(!(Math.abs(f*i-s*l)>Fe)||!n)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var g=r-a,h=o-u,S=i*i+s*s,x=g*g+h*h,m=Math.sqrt(S),_=Math.sqrt(p),C=n*Math.tan((uo-Math.acos((S+p-x)/(2*m*_)))/2),y=C/_,w=C/m;Math.abs(y-1)>Fe&&(this._+="L"+(e+y*l)+","+(t+y*f)),this._+="A"+n+","+n+",0,0,"+ +(f*g>l*h)+","+(this._x1=e+w*i)+","+(this._y1=t+w*s)}},arc:function(e,t,r,o,n,a){e=+e,t=+t,r=+r,a=!!a;var u=r*Math.cos(o),i=r*Math.sin(o),s=e+u,l=t+i,f=1^a,p=a?o-n:n-o;if(r<0)throw new Error("negative radius: "+r);this._x1===null?this._+="M"+s+","+l:(Math.abs(this._x1-s)>Fe||Math.abs(this._y1-l)>Fe)&&(this._+="L"+s+","+l),!!r&&(p<0&&(p=p%co+co),p>cd?this._+="A"+r+","+r+",0,1,"+f+","+(e-u)+","+(t-i)+"A"+r+","+r+",0,1,"+f+","+(this._x1=s)+","+(this._y1=l):p>Fe&&(this._+="A"+r+","+r+",0,"+ +(p>=uo)+","+f+","+(this._x1=e+r*Math.cos(n))+","+(this._y1=t+r*Math.sin(n))))},rect:function(e,t,r,o){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +r+"v"+ +o+"h"+-r+"Z"},toString:function(){return this._}};var ut=_i;var Ci=Array.prototype.slice;function je(e){return function(){return e}}function dd(e){return e.source}function fd(e){return e.target}function Ii(e){return e.radius}function pd(e){return e.startAngle}function md(e){return e.endAngle}function gd(){return 0}function hd(e){var t=dd,r=fd,o=Ii,n=Ii,a=pd,u=md,i=gd,s=null;function l(){var f,p=t.apply(this,arguments),g=r.apply(this,arguments),h=i.apply(this,arguments)/2,S=Ci.call(arguments),x=+o.apply(this,(S[0]=p,S)),m=a.apply(this,S)-lt,_=u.apply(this,S)-lt,C=+n.apply(this,(S[0]=g,S)),y=a.apply(this,S)-lt,w=u.apply(this,S)-lt;if(s||(s=f=ut()),h>ir&&(no(_-m)>h*2+ir?_>m?(m+=h,_-=h):(m-=h,_+=h):m=_=(m+_)/2,no(w-y)>h*2+ir?w>y?(y+=h,w-=h):(y-=h,w+=h):y=w=(y+w)/2),s.moveTo(x*Ee(m),x*Oe(m)),s.arc(0,0,x,m,_),m!==y||_!==w)if(e){var q=+e.apply(this,arguments),B=C-q,F=(y+w)/2;s.quadraticCurveTo(0,0,B*Ee(y),B*Oe(y)),s.lineTo(C*Ee(F),C*Oe(F)),s.lineTo(B*Ee(w),B*Oe(w))}else s.quadraticCurveTo(0,0,C*Ee(y),C*Oe(y)),s.arc(0,0,C,y,w);if(s.quadraticCurveTo(0,0,x*Ee(m),x*Oe(m)),s.closePath(),f)return s=null,f+""||null}return e&&(l.headRadius=function(f){return arguments.length?(e=typeof f=="function"?f:je(+f),l):e}),l.radius=function(f){return arguments.length?(o=n=typeof f=="function"?f:je(+f),l):o},l.sourceRadius=function(f){return arguments.length?(o=typeof f=="function"?f:je(+f),l):o},l.targetRadius=function(f){return arguments.length?(n=typeof f=="function"?f:je(+f),l):n},l.startAngle=function(f){return arguments.length?(a=typeof f=="function"?f:je(+f),l):a},l.endAngle=function(f){return arguments.length?(u=typeof f=="function"?f:je(+f),l):u},l.padAngle=function(f){return arguments.length?(i=typeof f=="function"?f:je(+f),l):i},l.source=function(f){return arguments.length?(t=f,l):t},l.target=function(f){return arguments.length?(r=f,l):r},l.context=function(f){return arguments.length?(s=f??null,l):s},l}function po(){return hd()}function Ai(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}var mo=Symbol("implicit");function ct(){var e=new Map,t=[],r=[],o=mo;function n(a){var u=a+"",i=e.get(u);if(!i){if(o!==mo)return o;e.set(u,i=t.push(a))}return r[(i-1)%r.length]}return n.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new Map;for(let u of a){let i=u+"";e.has(i)||e.set(i,t.push(u))}return n},n.range=function(a){return arguments.length?(r=Array.from(a),n):r.slice()},n.unknown=function(a){return arguments.length?(o=a,n):o},n.copy=function(){return ct(t,r).unknown(o)},Ai.apply(n,arguments),n}function sr(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function go(e,t){var r=Object.create(e.prototype);for(var o in t)r[o]=t[o];return r}function dt(){}var ft=.7,lr=1/ft,Ke="\\s*([+-]?\\d+)\\s*",pt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",pe="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",vd=/^#([0-9a-f]{3,8})$/,yd=new RegExp("^rgb\\("+[Ke,Ke,Ke]+"\\)$"),bd=new RegExp("^rgb\\("+[pe,pe,pe]+"\\)$"),xd=new RegExp("^rgba\\("+[Ke,Ke,Ke,pt]+"\\)$"),wd=new RegExp("^rgba\\("+[pe,pe,pe,pt]+"\\)$"),Sd=new RegExp("^hsl\\("+[pt,pe,pe]+"\\)$"),_d=new RegExp("^hsla\\("+[pt,pe,pe,pt]+"\\)$"),ji={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};sr(dt,mt,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:Di,formatHex:Di,formatHsl:Cd,formatRgb:qi,toString:qi});function Di(){return this.rgb().formatHex()}function Cd(){return Mi(this).formatHsl()}function qi(){return this.rgb().formatRgb()}function mt(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=vd.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?ki(t):r===3?new ne(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?ur(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?ur(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=yd.exec(e))?new ne(t[1],t[2],t[3],1):(t=bd.exec(e))?new ne(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=xd.exec(e))?ur(t[1],t[2],t[3],t[4]):(t=wd.exec(e))?ur(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Sd.exec(e))?Ni(t[1],t[2]/100,t[3]/100,1):(t=_d.exec(e))?Ni(t[1],t[2]/100,t[3]/100,t[4]):ji.hasOwnProperty(e)?ki(ji[e]):e==="transparent"?new ne(NaN,NaN,NaN,0):null}function ki(e){return new ne(e>>16&255,e>>8&255,e&255,1)}function ur(e,t,r,o){return o<=0&&(e=t=r=NaN),new ne(e,t,r,o)}function Id(e){return e instanceof dt||(e=mt(e)),e?(e=e.rgb(),new ne(e.r,e.g,e.b,e.opacity)):new ne}function Ye(e,t,r,o){return arguments.length===1?Id(e):new ne(e,t,r,o??1)}function ne(e,t,r,o){this.r=+e,this.g=+t,this.b=+r,this.opacity=+o}sr(ne,Ye,go(dt,{brighter:function(e){return e=e==null?lr:Math.pow(lr,e),new ne(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?ft:Math.pow(ft,e),new ne(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ti,formatHex:Ti,formatRgb:Pi,toString:Pi}));function Ti(){return"#"+ho(this.r)+ho(this.g)+ho(this.b)}function Pi(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function ho(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function Ni(e,t,r,o){return o<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new me(e,t,r,o)}function Mi(e){if(e instanceof me)return new me(e.h,e.s,e.l,e.opacity);if(e instanceof dt||(e=mt(e)),!e)return new me;if(e instanceof me)return e;e=e.rgb();var t=e.r/255,r=e.g/255,o=e.b/255,n=Math.min(t,r,o),a=Math.max(t,r,o),u=NaN,i=a-n,s=(a+n)/2;return i?(t===a?u=(r-o)/i+(r<o)*6:r===a?u=(o-t)/i+2:u=(t-r)/i+4,i/=s<.5?a+n:2-a-n,u*=60):i=s>0&&s<1?0:u,new me(u,i,s,e.opacity)}function Bi(e,t,r,o){return arguments.length===1?Mi(e):new me(e,t,r,o??1)}function me(e,t,r,o){this.h=+e,this.s=+t,this.l=+r,this.opacity=+o}sr(me,Bi,go(dt,{brighter:function(e){return e=e==null?lr:Math.pow(lr,e),new me(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?ft:Math.pow(ft,e),new me(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,o=r+(r<.5?r:1-r)*t,n=2*r-o;return new ne(vo(e>=240?e-240:e+120,n,o),vo(e,n,o),vo(e<120?e+240:e-120,n,o),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function vo(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}function yo(e,t,r,o,n){var a=e*e,u=a*e;return((1-3*e+3*a-u)*t+(4-6*a+3*u)*r+(1+3*e+3*a-3*u)*o+u*n)/6}function Ei(e){var t=e.length-1;return function(r){var o=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),n=e[o],a=e[o+1],u=o>0?e[o-1]:2*n-a,i=o<t-1?e[o+2]:2*a-n;return yo((r-o/t)*t,u,n,a,i)}}function Oi(e){var t=e.length;return function(r){var o=Math.floor(((r%=1)<0?++r:r)*t),n=e[(o+t-1)%t],a=e[o%t],u=e[(o+1)%t],i=e[(o+2)%t];return yo((r-o/t)*t,n,a,u,i)}}var bo=e=>()=>e;function Ad(e,t){return function(r){return e+r*t}}function jd(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(o){return Math.pow(e+o*t,r)}}function Fi(e){return(e=+e)==1?cr:function(t,r){return r-t?jd(t,r,e):bo(isNaN(t)?r:t)}}function cr(e,t){var r=t-e;return r?Ad(e,r):bo(isNaN(e)?t:e)}var Dd=function e(t){var r=Fi(t);function o(n,a){var u=r((n=Ye(n)).r,(a=Ye(a)).r),i=r(n.g,a.g),s=r(n.b,a.b),l=cr(n.opacity,a.opacity);return function(f){return n.r=u(f),n.g=i(f),n.b=s(f),n.opacity=l(f),n+""}}return o.gamma=e,o}(1);function Ri(e){return function(t){var r=t.length,o=new Array(r),n=new Array(r),a=new Array(r),u,i;for(u=0;u<r;++u)i=Ye(t[u]),o[u]=i.r||0,n[u]=i.g||0,a[u]=i.b||0;return o=e(o),n=e(n),a=e(a),i.opacity=1,function(s){return i.r=o(s),i.g=n(s),i.b=a(s),i+""}}}var xo=Ri(Ei),qd=Ri(Oi);function Li(e){for(var t=e.length/6|0,r=new Array(t),o=0;o<t;)r[o]="#"+e.slice(o*6,++o*6);return r}var zi=e=>xo(e[e.length-1]);var dr=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Li),kd=zi(dr);var fr="http://www.w3.org/1999/xhtml",wo={svg:"http://www.w3.org/2000/svg",xhtml:fr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function pr(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),wo.hasOwnProperty(t)?{space:wo[t],local:e}:e}function Td(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===fr&&t.documentElement.namespaceURI===fr?t.createElement(e):t.createElementNS(r,e)}}function Pd(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function mr(e){var t=pr(e);return(t.local?Pd:Td)(t)}function Nd(){}function gr(e){return e==null?Nd:function(){return this.querySelector(e)}}function Hi(e){typeof e!="function"&&(e=gr(e));for(var t=this._groups,r=t.length,o=new Array(r),n=0;n<r;++n)for(var a=t[n],u=a.length,i=o[n]=new Array(u),s,l,f=0;f<u;++f)(s=a[f])&&(l=e.call(s,s.__data__,f,a))&&("__data__"in s&&(l.__data__=s.__data__),i[f]=l);return new H(o,this._parents)}function hr(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Md(){return[]}function Gi(e){return e==null?Md:function(){return this.querySelectorAll(e)}}function Bd(e){return function(){var t=e.apply(this,arguments);return t==null?[]:hr(t)}}function Wi(e){typeof e=="function"?e=Bd(e):e=Gi(e);for(var t=this._groups,r=t.length,o=[],n=[],a=0;a<r;++a)for(var u=t[a],i=u.length,s,l=0;l<i;++l)(s=u[l])&&(o.push(e.call(s,s.__data__,l,u)),n.push(s));return new H(o,n)}function $i(e){return function(){return this.matches(e)}}function vr(e){return function(t){return t.matches(e)}}var Ed=Array.prototype.find;function Od(e){return function(){return Ed.call(this.children,e)}}function Fd(){return this.firstElementChild}function Vi(e){return this.select(e==null?Fd:Od(typeof e=="function"?e:vr(e)))}var Rd=Array.prototype.filter;function Ld(){return this.children}function zd(e){return function(){return Rd.call(this.children,e)}}function Ui(e){return this.selectAll(e==null?Ld:zd(typeof e=="function"?e:vr(e)))}function Ki(e){typeof e!="function"&&(e=$i(e));for(var t=this._groups,r=t.length,o=new Array(r),n=0;n<r;++n)for(var a=t[n],u=a.length,i=o[n]=[],s,l=0;l<u;++l)(s=a[l])&&e.call(s,s.__data__,l,a)&&i.push(s);return new H(o,this._parents)}function yr(e){return new Array(e.length)}function Yi(){return new H(this._enter||this._groups.map(yr),this._parents)}function gt(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}gt.prototype={constructor:gt,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Zi(e){return function(){return e}}function Hd(e,t,r,o,n,a){for(var u=0,i,s=t.length,l=a.length;u<l;++u)(i=t[u])?(i.__data__=a[u],o[u]=i):r[u]=new gt(e,a[u]);for(;u<s;++u)(i=t[u])&&(n[u]=i)}function Gd(e,t,r,o,n,a,u){var i,s,l=new Map,f=t.length,p=a.length,g=new Array(f),h;for(i=0;i<f;++i)(s=t[i])&&(g[i]=h=u.call(s,s.__data__,i,t)+"",l.has(h)?n[i]=s:l.set(h,s));for(i=0;i<p;++i)h=u.call(e,a[i],i,a)+"",(s=l.get(h))?(o[i]=s,s.__data__=a[i],l.delete(h)):r[i]=new gt(e,a[i]);for(i=0;i<f;++i)(s=t[i])&&l.get(g[i])===s&&(n[i]=s)}function Wd(e){return e.__data__}function Qi(e,t){if(!arguments.length)return Array.from(this,Wd);var r=t?Gd:Hd,o=this._parents,n=this._groups;typeof e!="function"&&(e=Zi(e));for(var a=n.length,u=new Array(a),i=new Array(a),s=new Array(a),l=0;l<a;++l){var f=o[l],p=n[l],g=p.length,h=hr(e.call(f,f&&f.__data__,l,o)),S=h.length,x=i[l]=new Array(S),m=u[l]=new Array(S),_=s[l]=new Array(g);r(f,p,x,m,_,h,t);for(var C=0,y=0,w,q;C<S;++C)if(w=x[C]){for(C>=y&&(y=C+1);!(q=m[y])&&++y<S;);w._next=q||null}}return u=new H(u,o),u._enter=i,u._exit=s,u}function Xi(){return new H(this._exit||this._groups.map(yr),this._parents)}function Ji(e,t,r){var o=this.enter(),n=this,a=this.exit();return o=typeof e=="function"?e(o):o.append(e+""),t!=null&&(n=t(n)),r==null?a.remove():r(a),o&&n?o.merge(n).order():n}function es(e){if(!(e instanceof H))throw new Error("invalid merge");for(var t=this._groups,r=e._groups,o=t.length,n=r.length,a=Math.min(o,n),u=new Array(o),i=0;i<a;++i)for(var s=t[i],l=r[i],f=s.length,p=u[i]=new Array(f),g,h=0;h<f;++h)(g=s[h]||l[h])&&(p[h]=g);for(;i<o;++i)u[i]=t[i];return new H(u,this._parents)}function ts(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var o=e[t],n=o.length-1,a=o[n],u;--n>=0;)(u=o[n])&&(a&&u.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(u,a),a=u);return this}function rs(e){e||(e=$d);function t(p,g){return p&&g?e(p.__data__,g.__data__):!p-!g}for(var r=this._groups,o=r.length,n=new Array(o),a=0;a<o;++a){for(var u=r[a],i=u.length,s=n[a]=new Array(i),l,f=0;f<i;++f)(l=u[f])&&(s[f]=l);s.sort(t)}return new H(n,this._parents).order()}function $d(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function os(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function ns(){return Array.from(this)}function as(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var o=e[t],n=0,a=o.length;n<a;++n){var u=o[n];if(u)return u}return null}function is(){let e=0;for(let t of this)++e;return e}function ss(){return!this.node()}function ls(e){for(var t=this._groups,r=0,o=t.length;r<o;++r)for(var n=t[r],a=0,u=n.length,i;a<u;++a)(i=n[a])&&e.call(i,i.__data__,a,n);return this}function Vd(e){return function(){this.removeAttribute(e)}}function Ud(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Kd(e,t){return function(){this.setAttribute(e,t)}}function Yd(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Zd(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function Qd(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function us(e,t){var r=pr(e);if(arguments.length<2){var o=this.node();return r.local?o.getAttributeNS(r.space,r.local):o.getAttribute(r)}return this.each((t==null?r.local?Ud:Vd:typeof t=="function"?r.local?Qd:Zd:r.local?Yd:Kd)(r,t))}function br(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Xd(e){return function(){this.style.removeProperty(e)}}function Jd(e,t,r){return function(){this.style.setProperty(e,t,r)}}function ef(e,t,r){return function(){var o=t.apply(this,arguments);o==null?this.style.removeProperty(e):this.style.setProperty(e,o,r)}}function cs(e,t,r){return arguments.length>1?this.each((t==null?Xd:typeof t=="function"?ef:Jd)(e,t,r??"")):tf(this.node(),e)}function tf(e,t){return e.style.getPropertyValue(t)||br(e).getComputedStyle(e,null).getPropertyValue(t)}function rf(e){return function(){delete this[e]}}function of(e,t){return function(){this[e]=t}}function nf(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function ds(e,t){return arguments.length>1?this.each((t==null?rf:typeof t=="function"?nf:of)(e,t)):this.node()[e]}function fs(e){return e.trim().split(/^|\s+/)}function So(e){return e.classList||new ps(e)}function ps(e){this._node=e,this._names=fs(e.getAttribute("class")||"")}ps.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function ms(e,t){for(var r=So(e),o=-1,n=t.length;++o<n;)r.add(t[o])}function gs(e,t){for(var r=So(e),o=-1,n=t.length;++o<n;)r.remove(t[o])}function af(e){return function(){ms(this,e)}}function sf(e){return function(){gs(this,e)}}function lf(e,t){return function(){(t.apply(this,arguments)?ms:gs)(this,e)}}function hs(e,t){var r=fs(e+"");if(arguments.length<2){for(var o=So(this.node()),n=-1,a=r.length;++n<a;)if(!o.contains(r[n]))return!1;return!0}return this.each((typeof t=="function"?lf:t?af:sf)(r,t))}function uf(){this.textContent=""}function cf(e){return function(){this.textContent=e}}function df(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function vs(e){return arguments.length?this.each(e==null?uf:(typeof e=="function"?df:cf)(e)):this.node().textContent}function ff(){this.innerHTML=""}function pf(e){return function(){this.innerHTML=e}}function mf(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function ys(e){return arguments.length?this.each(e==null?ff:(typeof e=="function"?mf:pf)(e)):this.node().innerHTML}function gf(){this.nextSibling&&this.parentNode.appendChild(this)}function bs(){return this.each(gf)}function hf(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function xs(){return this.each(hf)}function ws(e){var t=typeof e=="function"?e:mr(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function vf(){return null}function Ss(e,t){var r=typeof e=="function"?e:mr(e),o=t==null?vf:typeof t=="function"?t:gr(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),o.apply(this,arguments)||null)})}function yf(){var e=this.parentNode;e&&e.removeChild(this)}function _s(){return this.each(yf)}function bf(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function xf(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Cs(e){return this.select(e?xf:bf)}function Is(e){return arguments.length?this.property("__data__",e):this.node().__data__}function wf(e){return function(t){e.call(this,t,this.__data__)}}function Sf(e){return e.trim().split(/^|\s+/).map(function(t){var r="",o=t.indexOf(".");return o>=0&&(r=t.slice(o+1),t=t.slice(0,o)),{type:t,name:r}})}function _f(e){return function(){var t=this.__on;if(!!t){for(var r=0,o=-1,n=t.length,a;r<n;++r)a=t[r],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.options):t[++o]=a;++o?t.length=o:delete this.__on}}}function Cf(e,t,r){return function(){var o=this.__on,n,a=wf(t);if(o){for(var u=0,i=o.length;u<i;++u)if((n=o[u]).type===e.type&&n.name===e.name){this.removeEventListener(n.type,n.listener,n.options),this.addEventListener(n.type,n.listener=a,n.options=r),n.value=t;return}}this.addEventListener(e.type,a,r),n={type:e.type,name:e.name,value:t,listener:a,options:r},o?o.push(n):this.__on=[n]}}function As(e,t,r){var o=Sf(e+""),n,a=o.length,u;if(arguments.length<2){var i=this.node().__on;if(i){for(var s=0,l=i.length,f;s<l;++s)for(n=0,f=i[s];n<a;++n)if((u=o[n]).type===f.type&&u.name===f.name)return f.value}return}for(i=t?Cf:_f,n=0;n<a;++n)this.each(i(o[n],t,r));return this}function js(e,t,r){var o=br(e),n=o.CustomEvent;typeof n=="function"?n=new n(t,r):(n=o.document.createEvent("Event"),r?(n.initEvent(t,r.bubbles,r.cancelable),n.detail=r.detail):n.initEvent(t,!1,!1)),e.dispatchEvent(n)}function If(e,t){return function(){return js(this,e,t)}}function Af(e,t){return function(){return js(this,e,t.apply(this,arguments))}}function Ds(e,t){return this.each((typeof t=="function"?Af:If)(e,t))}function*qs(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var o=e[t],n=0,a=o.length,u;n<a;++n)(u=o[n])&&(yield u)}var _o=[null];function H(e,t){this._groups=e,this._parents=t}function jf(){return new H([[document.documentElement]],_o)}function Df(){return this}H.prototype=jf.prototype={constructor:H,select:Hi,selectAll:Wi,selectChild:Vi,selectChildren:Ui,filter:Ki,data:Qi,enter:Yi,exit:Xi,join:Ji,merge:es,selection:Df,order:ts,sort:rs,call:os,nodes:ns,node:as,size:is,empty:ss,each:ls,attr:us,style:cs,property:ds,classed:hs,text:vs,html:ys,raise:bs,lower:xs,append:ws,insert:Ss,remove:_s,clone:Cs,datum:Is,on:As,dispatch:Ds,[Symbol.iterator]:qs};function Co(e){return typeof e=="string"?new H([[document.querySelector(e)]],[document.documentElement]):new H([[e]],_o)}function be(e){return function(){return e}}var Io=Math.abs,Z=Math.atan2,De=Math.cos,ks=Math.max,xr=Math.min,ue=Math.sin,Re=Math.sqrt,ee=1e-12,Ze=Math.PI,ht=Ze/2,Ts=2*Ze;function Ps(e){return e>1?0:e<-1?Ze:Math.acos(e)}function Ao(e){return e>=1?ht:e<=-1?-ht:Math.asin(e)}function qf(e){return e.innerRadius}function kf(e){return e.outerRadius}function Tf(e){return e.startAngle}function Pf(e){return e.endAngle}function Nf(e){return e&&e.padAngle}function Mf(e,t,r,o,n,a,u,i){var s=r-e,l=o-t,f=u-n,p=i-a,g=p*s-f*l;if(!(g*g<ee))return g=(f*(t-a)-p*(e-n))/g,[e+g*s,t+g*l]}function wr(e,t,r,o,n,a,u){var i=e-r,s=t-o,l=(u?a:-a)/Re(i*i+s*s),f=l*s,p=-l*i,g=e+f,h=t+p,S=r+f,x=o+p,m=(g+S)/2,_=(h+x)/2,C=S-g,y=x-h,w=C*C+y*y,q=n-a,B=g*x-S*h,F=(y<0?-1:1)*Re(ks(0,q*q*w-B*B)),U=(B*y-C*F)/w,G=(-B*C-y*F)/w,v=(B*y+C*F)/w,I=(-B*C+y*F)/w,b=U-m,A=G-_,W=v-m,V=I-_;return b*b+A*A>W*W+V*V&&(U=v,G=I),{cx:U,cy:G,x01:-f,y01:-p,x11:U*(n/q-1),y11:G*(n/q-1)}}function jo(){var e=qf,t=kf,r=be(0),o=null,n=Tf,a=Pf,u=Nf,i=null;function s(){var l,f,p=+e.apply(this,arguments),g=+t.apply(this,arguments),h=n.apply(this,arguments)-ht,S=a.apply(this,arguments)-ht,x=Io(S-h),m=S>h;if(i||(i=l=ut()),g<p&&(f=g,g=p,p=f),!(g>ee))i.moveTo(0,0);else if(x>Ts-ee)i.moveTo(g*De(h),g*ue(h)),i.arc(0,0,g,h,S,!m),p>ee&&(i.moveTo(p*De(S),p*ue(S)),i.arc(0,0,p,S,h,m));else{var _=h,C=S,y=h,w=S,q=x,B=x,F=u.apply(this,arguments)/2,U=F>ee&&(o?+o.apply(this,arguments):Re(p*p+g*g)),G=xr(Io(g-p)/2,+r.apply(this,arguments)),v=G,I=G,b,A;if(U>ee){var W=Ao(U/p*ue(F)),V=Ao(U/g*ue(F));(q-=W*2)>ee?(W*=m?1:-1,y+=W,w-=W):(q=0,y=w=(h+S)/2),(B-=V*2)>ee?(V*=m?1:-1,_+=V,C-=V):(B=0,_=C=(h+S)/2)}var Le=g*De(_),ze=g*ue(_),yt=p*De(w),bt=p*ue(w);if(G>ee){var xt=g*De(C),wt=g*ue(C),Ar=p*De(y),jr=p*ue(y),ge;if(x<Ze&&(ge=Mf(Le,ze,Ar,jr,xt,wt,yt,bt))){var Dr=Le-ge[0],qr=ze-ge[1],kr=xt-ge[0],Tr=wt-ge[1],Do=1/ue(Ps((Dr*kr+qr*Tr)/(Re(Dr*Dr+qr*qr)*Re(kr*kr+Tr*Tr)))/2),qo=Re(ge[0]*ge[0]+ge[1]*ge[1]);v=xr(G,(p-qo)/(Do-1)),I=xr(G,(g-qo)/(Do+1))}}B>ee?I>ee?(b=wr(Ar,jr,Le,ze,g,I,m),A=wr(xt,wt,yt,bt,g,I,m),i.moveTo(b.cx+b.x01,b.cy+b.y01),I<G?i.arc(b.cx,b.cy,I,Z(b.y01,b.x01),Z(A.y01,A.x01),!m):(i.arc(b.cx,b.cy,I,Z(b.y01,b.x01),Z(b.y11,b.x11),!m),i.arc(0,0,g,Z(b.cy+b.y11,b.cx+b.x11),Z(A.cy+A.y11,A.cx+A.x11),!m),i.arc(A.cx,A.cy,I,Z(A.y11,A.x11),Z(A.y01,A.x01),!m))):(i.moveTo(Le,ze),i.arc(0,0,g,_,C,!m)):i.moveTo(Le,ze),!(p>ee)||!(q>ee)?i.lineTo(yt,bt):v>ee?(b=wr(yt,bt,xt,wt,p,-v,m),A=wr(Le,ze,Ar,jr,p,-v,m),i.lineTo(b.cx+b.x01,b.cy+b.y01),v<G?i.arc(b.cx,b.cy,v,Z(b.y01,b.x01),Z(A.y01,A.x01),!m):(i.arc(b.cx,b.cy,v,Z(b.y01,b.x01),Z(b.y11,b.x11),!m),i.arc(0,0,p,Z(b.cy+b.y11,b.cx+b.x11),Z(A.cy+A.y11,A.cx+A.x11),m),i.arc(A.cx,A.cy,v,Z(A.y11,A.x11),Z(A.y01,A.x01),!m))):i.arc(0,0,p,w,y,m)}if(i.closePath(),l)return i=null,l+""||null}return s.centroid=function(){var l=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,f=(+n.apply(this,arguments)+ +a.apply(this,arguments))/2-Ze/2;return[De(f)*l,ue(f)*l]},s.innerRadius=function(l){return arguments.length?(e=typeof l=="function"?l:be(+l),s):e},s.outerRadius=function(l){return arguments.length?(t=typeof l=="function"?l:be(+l),s):t},s.cornerRadius=function(l){return arguments.length?(r=typeof l=="function"?l:be(+l),s):r},s.padRadius=function(l){return arguments.length?(o=l==null?null:typeof l=="function"?l:be(+l),s):o},s.startAngle=function(l){return arguments.length?(n=typeof l=="function"?l:be(+l),s):n},s.endAngle=function(l){return arguments.length?(a=typeof l=="function"?l:be(+l),s):a},s.padAngle=function(l){return arguments.length?(u=typeof l=="function"?l:be(+l),s):u},s.context=function(l){return arguments.length?(i=l??null,s):i},s}function Ns(e,t){let r=new Array(t.length).fill(0).map(()=>new Array(t.length).fill(0));function o(v,I){v==null||I==null||(r[v][I]=r[I][v]=1)}let n=new Map;for(let v=0;v<t.length;v++)n.set(t[v].id,v);for(let v of t)for(let I of v.neighbors)o(n.get(v.id),n.get(I));let a=v=>v.reduce((I,b)=>I+b,0),u=Math.max(...r.map(a));u===0&&(u=1);let i=new Set;for(let v=0;v<r.length;v++){let I=r[v];a(I)===0?(I[v]=1/u,i.add(t[v].id)):r[v]=I.map(A=>A/u)}let s=1.5,l=a(r[0]);r[0]=r[0].map(v=>v*s/l);let f=a(r.map(a)),p=600,g=600,h=Math.min(p,g)*.5-150,S=h-20,x=Math.min(.15,Math.PI/2/t.length),m=2*Math.PI-t.length*x,_=.5*m*(s/f),C=Co(e).append("svg").attr("preserveAspectRatio","xMidYMid meet").attr("viewBox",`${-p/2} ${-g/2} ${p} ${g}`).append("g").attr("transform",`rotate(-${(_*(180/Math.PI)).toFixed(2)})`),y=lo().padAngle(x).sortChords(ro).sortSubgroups(()=>1)(r),w=jo().innerRadius(S).outerRadius(h),q=po().radius(S),B=ct().domain(oo(t.length-1)).range(dr[Math.max(3,Math.min(11,t.length))]);function F(v){return"linkGrad-"+v.source.index+"-"+v.target.index}let U=C.append("defs").selectAll("linearGradient").data(y).enter().append("linearGradient").attr("id",F).attr("gradientUnits","userSpaceOnUse").attr("x1",function(v,I){return S*Math.cos((v.source.endAngle-v.source.startAngle)/2+v.source.startAngle-Math.PI/2)}).attr("y1",function(v,I){return S*Math.sin((v.source.endAngle-v.source.startAngle)/2+v.source.startAngle-Math.PI/2)}).attr("x2",function(v,I){return S*Math.cos((v.target.endAngle-v.target.startAngle)/2+v.target.startAngle-Math.PI/2)}).attr("y2",function(v,I){return S*Math.sin((v.target.endAngle-v.target.startAngle)/2+v.target.startAngle-Math.PI/2)});U.append("stop").attr("offset","0%").attr("stop-color",v=>B(v.source.index)),U.append("stop").attr("offset","100%").attr("stop-color",v=>B(v.target.index));let G=C.selectAll("g").data(y.groups).enter().append("g").attr("class","node");G.append("path").style("fill",v=>B(v.index)).attr("d",w),G.append("text").each(v=>v.angle=(v.startAngle+v.endAngle)/2).attr("class",(v,I)=>`node-id${i.has(t[I].id)?" disconnected":""}`).attr("text-anchor",v=>v.angle-_>Math.PI?"end":null).attr("dominant-baseline","middle").attr("transform",v=>"rotate("+(v.angle*180/Math.PI-90)+")translate("+(h+10)+")"+(v.angle-_>Math.PI?"rotate(180)":"")).text((v,I)=>`Node ${t[I].id}`),C.datum(y).append("g").selectAll("path").data(v=>v.filter(I=>I.source.index!==I.target.index&&I.source.value>0&&I.target.value>0)).enter().append("path").attr("class",v=>`chord chord-${v.source.index} chord-${v.target.index}`).style("fill",v=>`url(#${F(v)})`).attr("d",q)}var Ms=c(K());var Bs=c(X()),Bf=(0,Bs.makeStyles)(e=>({map:{"& text":{fill:e.palette.text.primary}}})),Es=()=>{let{alive:e,connected:t}=(0,Ms.useAdapter)(),r=ae(),o=Bf();return Sr.default.useEffect(()=>{e&&t&&r.getNetworkMap().then(n=>{Ns("#map",n)}).catch(n=>{console.error(n)})},[e,t,r]),e&&t?Sr.default.createElement("div",{id:"map",className:o.map}):Sr.default.createElement($e,null)};var Gs=c(K()),vt=c(bl());var _r=c(K()),Cr=c(j());var $v=Cr.default.createContext({devices:{},async updateDevices(){}}),Os=/Node_(\d+)$/,Fs=/Node_(\d+)\.ready$/,Rs=/Node_(\d+)\.status$/;function Ls(){let e=(0,_r.useConnection)(),[t,r]=Cr.default.useState(),{namespace:o}=(0,_r.useGlobals)(),n=ae(),a=async(l,f)=>{if(!(!l.startsWith(o)||!Os.test(l)))if(f){if(f.type==="device"&&typeof f.native.id=="number"){let p=f.native.id,g={id:l,value:f,status:await n.getNodeStatus(p),ready:await n.getNodeReady(p)};g.ready&&await n.updateEndpointsAndAssociations(p,g),r(h=>({...h,[p]:g}))}}else{let p=parseInt(Os.exec(l)[1],10);r(g=>{let h={...g};return delete h[p],h})}},u=async l=>{let f={};await n.updateEndpointsAndAssociations(l,f),r(p=>{let g=p?.[l];return g?(g.endpoints=f.endpoints,{...p,[l]:g}):p})},i=async(l,f)=>{if(!!l.startsWith(o)&&!(!f||!f.ack)){if(l.match(Rs)){let p=parseInt(Rs.exec(l)[1],10);r(g=>{let h=g?.[p];return h?(h.status=f.val,{...g,[p]:h}):g})}else if(l.match(Fs)){let p=parseInt(Fs.exec(l)[1],10);r(g=>{let h=g?.[p];return h?(h.ready=f.val,h.ready&&setTimeout(()=>void u(p),0),{...g,[p]:h}):g})}}};async function s(){r(await n.loadDevices({status:!0,associations:!0,ready:!0}))}return Cr.default.useEffect(()=>((async()=>{await s(),e.subscribeObject(`${o}.Node_*`,a),e.subscribeState(`${o}.Node_*`,i)})(),()=>{e.unsubscribeObject(`${o}.Node_*`,a),e.unsubscribeState(`${o}.Node_*`,i)}),[]),[t,s]}function Ir({error:e,resetErrorBoundary:t}){return P.default.createElement("div",{role:"alert"},P.default.createElement("p",null,"Something went wrong:"),P.default.createElement("pre",null,e.stack),P.default.createElement("button",{onClick:t},"Try again"))}var Ef={en:ul(),de:cl(),ru:dl(),pt:fl(),nl:pl(),fr:ml(),it:gl(),es:hl(),pl:vl(),"zh-cn":yl()},Of=P.default.memo(()=>{let[e,t]=P.default.useState(0),{translate:r}=(0,Gs.useI18n)(),o=(u,i)=>{t(i)},[n,a]=Ls();return P.default.createElement(P.default.Fragment,null,P.default.createElement(xe.AppBar,{position:"static"},P.default.createElement(xe.Tabs,{value:e,onChange:o},P.default.createElement(xe.Tab,{label:r("Devices")}),P.default.createElement(xe.Tab,{label:r("Associations")}),P.default.createElement(xe.Tab,{label:r("Z-Wave Logs")}),P.default.createElement(xe.Tab,{label:r("Network map")}))),P.default.createElement(et,{value:e,index:0},P.default.createElement(vt.ErrorBoundary,{FallbackComponent:Ir},P.default.createElement(wi,{devices:n}))),P.default.createElement(et,{value:e,index:1},P.default.createElement(vt.ErrorBoundary,{FallbackComponent:Ir},P.default.createElement(jn,{devices:n,updateDevices:a}))),P.default.createElement(et,{value:e,index:2},P.default.createElement(vt.ErrorBoundary,{FallbackComponent:Ir},P.default.createElement(Go,null))),P.default.createElement(et,{value:e,index:3},P.default.createElement(vt.ErrorBoundary,{FallbackComponent:Ir},P.default.createElement(Es,null))))});zs.default.render(P.default.createElement(Hs.IoBrokerApp,{name:"zwave2",translations:Ef},P.default.createElement(Of,null)),document.getElementById("root"));
//# sourceMappingURL=tab.js.map
